<?xml version="1.0" encoding="UTF-8"?>
<robot generator="Robot 7.2.2 (Python 3.13.2 on darwin)" generated="2025-05-08T19:15:41.129408" rpa="true" schemaversion="5">
<suite id="s1" name="Wechat Applescript Workflow" source="/Users/zzy/hope/rpa/wechat_applescript_workflow.robot">
<test id="s1-t1" name="完整微信AppleScript自动化工作流" line="18">
<kw name="创建日志文件">
<kw name="Get Current Date" owner="DateTime">
<msg time="2025-05-08T19:15:41.198253" level="INFO">${timestamp} = 2025-05-08 19:15:41</msg>
<var>${timestamp}</var>
<arg>result_format=%Y-%m-%d %H:%M:%S</arg>
<doc>Returns current local or UTC time with an optional increment.</doc>
<status status="PASS" start="2025-05-08T19:15:41.197867" elapsed="0.000437"/>
</kw>
<kw name="Create File" owner="OperatingSystem">
<msg time="2025-05-08T19:15:41.198951" level="INFO" html="true">Created file '&lt;a href="file:///Users/zzy/hope/rpa/wechat_applescript_log.txt"&gt;/Users/zzy/hope/rpa/wechat_applescript_log.txt&lt;/a&gt;'.</msg>
<arg>${LOG_FILE}</arg>
<doc>Creates a file with the given content and encoding.</doc>
<status status="PASS" start="2025-05-08T19:15:41.198480" elapsed="0.000554"/>
</kw>
<status status="PASS" start="2025-05-08T19:15:41.197047" elapsed="0.002080"/>
</kw>
<kw name="检查并安装依赖">
<kw name="记录日志">
<kw name="Get Current Date" owner="DateTime">
<msg time="2025-05-08T19:15:41.200676" level="INFO">${timestamp} = 2025-05-08 19:15:41</msg>
<var>${timestamp}</var>
<arg>result_format=%Y-%m-%d %H:%M:%S</arg>
<doc>Returns current local or UTC time with an optional increment.</doc>
<status status="PASS" start="2025-05-08T19:15:41.200407" elapsed="0.000318"/>
</kw>
<kw name="Catenate" owner="BuiltIn">
<msg time="2025-05-08T19:15:41.201143" level="INFO">${log_entry} = [2025-05-08 19:15:41] 检查自动化依赖工具</msg>
<var>${log_entry}</var>
<arg>SEPARATOR=\n</arg>
<arg>[${timestamp}] ${message}</arg>
<doc>Catenates the given items together and returns the resulted string.</doc>
<status status="PASS" start="2025-05-08T19:15:41.200863" elapsed="0.000322"/>
</kw>
<kw name="Append To File" owner="OperatingSystem">
<msg time="2025-05-08T19:15:41.201824" level="INFO" html="true">Appended to file '&lt;a href="file:///Users/zzy/hope/rpa/wechat_applescript_log.txt"&gt;/Users/zzy/hope/rpa/wechat_applescript_log.txt&lt;/a&gt;'.</msg>
<arg>${LOG_FILE}</arg>
<arg>${log_entry}\n</arg>
<doc>Appends the given content to the specified file.</doc>
<status status="PASS" start="2025-05-08T19:15:41.201310" elapsed="0.000590"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>${log_entry}</arg>
<doc>Logs the given message to the console.</doc>
<status status="PASS" start="2025-05-08T19:15:41.202030" elapsed="0.000205"/>
</kw>
<arg>检查自动化依赖工具</arg>
<status status="PASS" start="2025-05-08T19:15:41.199991" elapsed="0.002327"/>
</kw>
<kw name="Run Process" owner="Process">
<msg time="2025-05-08T19:15:41.202657" level="INFO">Starting process:
which cliclick</msg>
<msg time="2025-05-08T19:15:41.208540" level="INFO">Waiting for process to complete.</msg>
<msg time="2025-05-08T19:15:41.218376" level="INFO">Process completed.</msg>
<msg time="2025-05-08T19:15:41.218775" level="INFO">${cliclick_installed} = &lt;result object with rc 0&gt;</msg>
<var>${cliclick_installed}</var>
<arg>which cliclick</arg>
<arg>shell=True</arg>
<arg>stderr=STDOUT</arg>
<doc>Runs a process and waits for it to complete.</doc>
<status status="PASS" start="2025-05-08T19:15:41.202446" elapsed="0.016382"/>
</kw>
<kw name="Run Keyword And Return Status" owner="BuiltIn">
<kw name="Should Not Be Empty" owner="BuiltIn">
<msg time="2025-05-08T19:15:41.220460" level="INFO">Length is 23.</msg>
<arg>${cliclick_installed.stdout}</arg>
<doc>Verifies that the given item is not empty.</doc>
<status status="PASS" start="2025-05-08T19:15:41.219717" elapsed="0.000811"/>
</kw>
<msg time="2025-05-08T19:15:41.220640" level="INFO">${has_cliclick} = True</msg>
<var>${has_cliclick}</var>
<arg>Should Not Be Empty</arg>
<arg>${cliclick_installed.stdout}</arg>
<doc>Runs the given keyword with given arguments and returns the status as a Boolean value.</doc>
<status status="PASS" start="2025-05-08T19:15:41.219326" elapsed="0.001346"/>
</kw>
<if>
<branch type="IF" condition="not ${has_cliclick}">
<kw name="记录日志">
<arg>cliclick未安装，推荐使用Homebrew安装此工具以提高鼠标操作的可靠性</arg>
<status status="NOT RUN" start="2025-05-08T19:15:41.221331" elapsed="0.000035"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>\n推荐安装cliclick工具以提高脚本可靠性: brew install cliclick\n</arg>
<doc>Logs the given message to the console.</doc>
<status status="NOT RUN" start="2025-05-08T19:15:41.221508" elapsed="0.000028"/>
</kw>
<status status="NOT RUN" start="2025-05-08T19:15:41.220894" elapsed="0.000684"/>
</branch>
<branch type="ELSE">
<kw name="记录日志">
<kw name="Get Current Date" owner="DateTime">
<msg time="2025-05-08T19:15:41.222514" level="INFO">${timestamp} = 2025-05-08 19:15:41</msg>
<var>${timestamp}</var>
<arg>result_format=%Y-%m-%d %H:%M:%S</arg>
<doc>Returns current local or UTC time with an optional increment.</doc>
<status status="PASS" start="2025-05-08T19:15:41.222202" elapsed="0.000349"/>
</kw>
<kw name="Catenate" owner="BuiltIn">
<msg time="2025-05-08T19:15:41.222958" level="INFO">${log_entry} = [2025-05-08 19:15:41] 已安装cliclick工具，可用于备选鼠标操作方案</msg>
<var>${log_entry}</var>
<arg>SEPARATOR=\n</arg>
<arg>[${timestamp}] ${message}</arg>
<doc>Catenates the given items together and returns the resulted string.</doc>
<status status="PASS" start="2025-05-08T19:15:41.222685" elapsed="0.000309"/>
</kw>
<kw name="Append To File" owner="OperatingSystem">
<msg time="2025-05-08T19:15:41.223655" level="INFO" html="true">Appended to file '&lt;a href="file:///Users/zzy/hope/rpa/wechat_applescript_log.txt"&gt;/Users/zzy/hope/rpa/wechat_applescript_log.txt&lt;/a&gt;'.</msg>
<arg>${LOG_FILE}</arg>
<arg>${log_entry}\n</arg>
<doc>Appends the given content to the specified file.</doc>
<status status="PASS" start="2025-05-08T19:15:41.223124" elapsed="0.000607"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>${log_entry}</arg>
<doc>Logs the given message to the console.</doc>
<status status="PASS" start="2025-05-08T19:15:41.223862" elapsed="0.000254"/>
</kw>
<arg>已安装cliclick工具，可用于备选鼠标操作方案</arg>
<status status="PASS" start="2025-05-08T19:15:41.221791" elapsed="0.002440"/>
</kw>
<status status="PASS" start="2025-05-08T19:15:41.221629" elapsed="0.002647"/>
</branch>
<status status="PASS" start="2025-05-08T19:15:41.220811" elapsed="0.003505"/>
</if>
<kw name="Run Keyword And Return Status" owner="BuiltIn">
<kw name="File Should Exist" owner="OperatingSystem">
<msg time="2025-05-08T19:15:41.224885" level="INFO" html="true">File '&lt;a href="file:///Users/zzy/hope/rpa/scripts/wechat/activate_wechat.applescript"&gt;/Users/zzy/hope/rpa/scripts/wechat/activate_wechat.applescript&lt;/a&gt;' exists.</msg>
<arg>${SCRIPTS_DIR}/activate_wechat.applescript</arg>
<doc>Fails unless the given ``path`` points to an existing file.</doc>
<status status="PASS" start="2025-05-08T19:15:41.224661" elapsed="0.000296"/>
</kw>
<msg time="2025-05-08T19:15:41.225062" level="INFO">${activate_script_exists} = True</msg>
<var>${activate_script_exists}</var>
<arg>File Should Exist</arg>
<arg>${SCRIPTS_DIR}/activate_wechat.applescript</arg>
<doc>Runs the given keyword with given arguments and returns the status as a Boolean value.</doc>
<status status="PASS" start="2025-05-08T19:15:41.224456" elapsed="0.000638"/>
</kw>
<kw name="Run Keyword And Return Status" owner="BuiltIn">
<kw name="File Should Exist" owner="OperatingSystem">
<msg time="2025-05-08T19:15:41.225573" level="INFO" html="true">File '&lt;a href="file:///Users/zzy/hope/rpa/scripts/wechat/search_contact.applescript"&gt;/Users/zzy/hope/rpa/scripts/wechat/search_contact.applescript&lt;/a&gt;' exists.</msg>
<arg>${SCRIPTS_DIR}/search_contact.applescript</arg>
<doc>Fails unless the given ``path`` points to an existing file.</doc>
<status status="PASS" start="2025-05-08T19:15:41.225386" elapsed="0.000251"/>
</kw>
<msg time="2025-05-08T19:15:41.226052" level="INFO">${search_script_exists} = True</msg>
<var>${search_script_exists}</var>
<arg>File Should Exist</arg>
<arg>${SCRIPTS_DIR}/search_contact.applescript</arg>
<doc>Runs the given keyword with given arguments and returns the status as a Boolean value.</doc>
<status status="PASS" start="2025-05-08T19:15:41.225226" elapsed="0.000891"/>
</kw>
<kw name="Run Keyword And Return Status" owner="BuiltIn">
<kw name="File Should Exist" owner="OperatingSystem">
<msg time="2025-05-08T19:15:41.227042" level="INFO" html="true">File '&lt;a href="file:///Users/zzy/hope/rpa/scripts/wechat/send_message.applescript"&gt;/Users/zzy/hope/rpa/scripts/wechat/send_message.applescript&lt;/a&gt;' exists.</msg>
<arg>${SCRIPTS_DIR}/send_message.applescript</arg>
<doc>Fails unless the given ``path`` points to an existing file.</doc>
<status status="PASS" start="2025-05-08T19:15:41.226666" elapsed="0.001580"/>
</kw>
<msg time="2025-05-08T19:15:41.228482" level="INFO">${send_script_exists} = True</msg>
<var>${send_script_exists}</var>
<arg>File Should Exist</arg>
<arg>${SCRIPTS_DIR}/send_message.applescript</arg>
<doc>Runs the given keyword with given arguments and returns the status as a Boolean value.</doc>
<status status="PASS" start="2025-05-08T19:15:41.226353" elapsed="0.002221"/>
</kw>
<kw name="Run Keyword And Return Status" owner="BuiltIn">
<kw name="File Should Exist" owner="OperatingSystem">
<msg time="2025-05-08T19:15:41.229390" level="INFO" html="true">File '&lt;a href="file:///Users/zzy/hope/rpa/scripts/wechat/cliclick_focus_send.applescript"&gt;/Users/zzy/hope/rpa/scripts/wechat/cliclick_focus_send.applescript&lt;/a&gt;' exists.</msg>
<arg>${SCRIPTS_DIR}/cliclick_focus_send.applescript</arg>
<doc>Fails unless the given ``path`` points to an existing file.</doc>
<status status="PASS" start="2025-05-08T19:15:41.229091" elapsed="0.000389"/>
</kw>
<msg time="2025-05-08T19:15:41.229599" level="INFO">${cliclick_script_exists} = True</msg>
<var>${cliclick_script_exists}</var>
<arg>File Should Exist</arg>
<arg>${SCRIPTS_DIR}/cliclick_focus_send.applescript</arg>
<doc>Runs the given keyword with given arguments and returns the status as a Boolean value.</doc>
<status status="PASS" start="2025-05-08T19:15:41.228874" elapsed="0.000758"/>
</kw>
<kw name="Evaluate" owner="BuiltIn">
<msg time="2025-05-08T19:15:41.230180" level="INFO">${all_scripts_exist} = True</msg>
<var>${all_scripts_exist}</var>
<arg>${activate_script_exists} and ${search_script_exists} and ${send_script_exists} and ${cliclick_script_exists}</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<status status="PASS" start="2025-05-08T19:15:41.229783" elapsed="0.000432"/>
</kw>
<kw name="Set Variable" owner="BuiltIn">
<msg time="2025-05-08T19:15:41.230851" level="INFO">${scripts_executable} = True</msg>
<var>${scripts_executable}</var>
<arg>${True}</arg>
<doc>Returns the given values which can then be assigned to a variables.</doc>
<status status="PASS" start="2025-05-08T19:15:41.230354" elapsed="0.000559"/>
</kw>
<if>
<branch type="IF" condition="${all_scripts_exist}">
<kw name="Run Process" owner="Process">
<msg time="2025-05-08T19:15:41.231797" level="INFO">Starting process:
test -x /Users/zzy/hope/rpa/scripts/wechat/activate_wechat.applescript &amp;&amp; echo "OK" || echo "NotExecutable"</msg>
<msg time="2025-05-08T19:15:41.237737" level="INFO">Waiting for process to complete.</msg>
<msg time="2025-05-08T19:15:41.244171" level="INFO">Process completed.</msg>
<msg time="2025-05-08T19:15:41.244550" level="INFO">${activate_perm} = &lt;result object with rc 0&gt;</msg>
<var>${activate_perm}</var>
<arg>test -x ${SCRIPTS_DIR}/activate_wechat.applescript &amp;&amp; echo "OK" || echo "NotExecutable"</arg>
<arg>shell=True</arg>
<doc>Runs a process and waits for it to complete.</doc>
<status status="PASS" start="2025-05-08T19:15:41.231432" elapsed="0.013167"/>
</kw>
<kw name="Run Process" owner="Process">
<msg time="2025-05-08T19:15:41.245529" level="INFO">Starting process:
test -x /Users/zzy/hope/rpa/scripts/wechat/search_contact.applescript &amp;&amp; echo "OK" || echo "NotExecutable"</msg>
<msg time="2025-05-08T19:15:41.251400" level="INFO">Waiting for process to complete.</msg>
<msg time="2025-05-08T19:15:41.258844" level="INFO">Process completed.</msg>
<msg time="2025-05-08T19:15:41.259283" level="INFO">${search_perm} = &lt;result object with rc 0&gt;</msg>
<var>${search_perm}</var>
<arg>test -x ${SCRIPTS_DIR}/search_contact.applescript &amp;&amp; echo "OK" || echo "NotExecutable"</arg>
<arg>shell=True</arg>
<doc>Runs a process and waits for it to complete.</doc>
<status status="PASS" start="2025-05-08T19:15:41.245081" elapsed="0.014274"/>
</kw>
<kw name="Run Process" owner="Process">
<msg time="2025-05-08T19:15:41.260377" level="INFO">Starting process:
test -x /Users/zzy/hope/rpa/scripts/wechat/send_message.applescript &amp;&amp; echo "OK" || echo "NotExecutable"</msg>
<msg time="2025-05-08T19:15:41.265754" level="INFO">Waiting for process to complete.</msg>
<msg time="2025-05-08T19:15:41.273325" level="INFO">Process completed.</msg>
<msg time="2025-05-08T19:15:41.273706" level="INFO">${send_perm} = &lt;result object with rc 0&gt;</msg>
<var>${send_perm}</var>
<arg>test -x ${SCRIPTS_DIR}/send_message.applescript &amp;&amp; echo "OK" || echo "NotExecutable"</arg>
<arg>shell=True</arg>
<doc>Runs a process and waits for it to complete.</doc>
<status status="PASS" start="2025-05-08T19:15:41.259875" elapsed="0.013883"/>
</kw>
<kw name="Run Process" owner="Process">
<msg time="2025-05-08T19:15:41.275509" level="INFO">Starting process:
test -x /Users/zzy/hope/rpa/scripts/wechat/cliclick_focus_send.applescript &amp;&amp; echo "OK" || echo "NotExecutable"</msg>
<msg time="2025-05-08T19:15:41.281336" level="INFO">Waiting for process to complete.</msg>
<msg time="2025-05-08T19:15:41.288377" level="INFO">Process completed.</msg>
<msg time="2025-05-08T19:15:41.288769" level="INFO">${cliclick_perm} = &lt;result object with rc 0&gt;</msg>
<var>${cliclick_perm}</var>
<arg>test -x ${SCRIPTS_DIR}/cliclick_focus_send.applescript &amp;&amp; echo "OK" || echo "NotExecutable"</arg>
<arg>shell=True</arg>
<doc>Runs a process and waits for it to complete.</doc>
<status status="PASS" start="2025-05-08T19:15:41.274260" elapsed="0.014560"/>
</kw>
<kw name="Evaluate" owner="BuiltIn">
<msg time="2025-05-08T19:15:41.292895" level="INFO">${scripts_executable} = True</msg>
<var>${scripts_executable}</var>
<arg>"${activate_perm.stdout}" == "OK" and "${search_perm.stdout}" == "OK" and "${send_perm.stdout}" == "OK" and "${cliclick_perm.stdout}" == "OK"</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<status status="PASS" start="2025-05-08T19:15:41.289329" elapsed="0.003617"/>
</kw>
<if>
<branch type="IF" condition="not ${scripts_executable}">
<kw name="记录日志">
<arg>警告: 某些AppleScript文件没有执行权限，尝试添加执行权限</arg>
<status status="NOT RUN" start="2025-05-08T19:15:41.293923" elapsed="0.000063"/>
</kw>
<kw name="Run Process" owner="Process">
<arg>chmod +x ${SCRIPTS_DIR}/*.applescript</arg>
<arg>shell=True</arg>
<doc>Runs a process and waits for it to complete.</doc>
<status status="NOT RUN" start="2025-05-08T19:15:41.294169" elapsed="0.000038"/>
</kw>
<kw name="Set Variable" owner="BuiltIn">
<var>${scripts_executable}</var>
<arg>${True}</arg>
<doc>Returns the given values which can then be assigned to a variables.</doc>
<status status="NOT RUN" start="2025-05-08T19:15:41.294354" elapsed="0.000082"/>
</kw>
<kw name="记录日志">
<arg>已添加执行权限至所有脚本文件</arg>
<status status="NOT RUN" start="2025-05-08T19:15:41.294723" elapsed="0.000053"/>
</kw>
<status status="NOT RUN" start="2025-05-08T19:15:41.293224" elapsed="0.001609"/>
</branch>
<status status="PASS" start="2025-05-08T19:15:41.293145" elapsed="0.001735"/>
</if>
<status status="PASS" start="2025-05-08T19:15:41.231095" elapsed="0.063834"/>
</branch>
<status status="PASS" start="2025-05-08T19:15:41.231053" elapsed="0.063912"/>
</if>
<kw name="Evaluate" owner="BuiltIn">
<msg time="2025-05-08T19:15:41.295528" level="INFO">${scripts_ok} = True</msg>
<var>${scripts_ok}</var>
<arg>${all_scripts_exist} and ${scripts_executable}</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<status status="PASS" start="2025-05-08T19:15:41.295105" elapsed="0.000580"/>
</kw>
<if>
<branch type="IF" condition="not ${scripts_ok}">
<kw name="记录日志">
<arg>错误: 预创建的AppleScript文件不完整或没有执行权限</arg>
<status status="NOT RUN" start="2025-05-08T19:15:41.296099" elapsed="0.000035"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>\n错误: 预创建的AppleScript文件不完整或没有执行权限，请确保所有脚本文件已正确创建在 ${SCRIPTS_DIR} 目录下\n</arg>
<doc>Logs the given message to the console.</doc>
<status status="NOT RUN" start="2025-05-08T19:15:41.296341" elapsed="0.000035"/>
</kw>
<status status="NOT RUN" start="2025-05-08T19:15:41.295800" elapsed="0.000628"/>
</branch>
<branch type="ELSE">
<kw name="记录日志">
<kw name="Get Current Date" owner="DateTime">
<msg time="2025-05-08T19:15:41.297427" level="INFO">${timestamp} = 2025-05-08 19:15:41</msg>
<var>${timestamp}</var>
<arg>result_format=%Y-%m-%d %H:%M:%S</arg>
<doc>Returns current local or UTC time with an optional increment.</doc>
<status status="PASS" start="2025-05-08T19:15:41.297075" elapsed="0.000394"/>
</kw>
<kw name="Catenate" owner="BuiltIn">
<msg time="2025-05-08T19:15:41.297897" level="INFO">${log_entry} = [2025-05-08 19:15:41] 验证完成: 所有预创建的AppleScript文件都已存在且有执行权限</msg>
<var>${log_entry}</var>
<arg>SEPARATOR=\n</arg>
<arg>[${timestamp}] ${message}</arg>
<doc>Catenates the given items together and returns the resulted string.</doc>
<status status="PASS" start="2025-05-08T19:15:41.297618" elapsed="0.000317"/>
</kw>
<kw name="Append To File" owner="OperatingSystem">
<msg time="2025-05-08T19:15:41.298654" level="INFO" html="true">Appended to file '&lt;a href="file:///Users/zzy/hope/rpa/wechat_applescript_log.txt"&gt;/Users/zzy/hope/rpa/wechat_applescript_log.txt&lt;/a&gt;'.</msg>
<arg>${LOG_FILE}</arg>
<arg>${log_entry}\n</arg>
<doc>Appends the given content to the specified file.</doc>
<status status="PASS" start="2025-05-08T19:15:41.298072" elapsed="0.000669"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>${log_entry}</arg>
<doc>Logs the given message to the console.</doc>
<status status="PASS" start="2025-05-08T19:15:41.298885" elapsed="0.000251"/>
</kw>
<arg>验证完成: 所有预创建的AppleScript文件都已存在且有执行权限</arg>
<status status="PASS" start="2025-05-08T19:15:41.296637" elapsed="0.002589"/>
</kw>
<status status="PASS" start="2025-05-08T19:15:41.296468" elapsed="0.002803"/>
</branch>
<status status="PASS" start="2025-05-08T19:15:41.295770" elapsed="0.003539"/>
</if>
<return>
<value>${scripts_ok}</value>
<status status="PASS" start="2025-05-08T19:15:41.299394" elapsed="0.000110"/>
</return>
<msg time="2025-05-08T19:15:41.299699" level="INFO">${scripts_ok} = True</msg>
<var>${scripts_ok}</var>
<status status="PASS" start="2025-05-08T19:15:41.199653" elapsed="0.100081"/>
</kw>
<kw name="Run Keyword If" owner="BuiltIn">
<kw name="执行基于AppleScript的微信自动化">
<kw name="记录日志">
<kw name="Get Current Date" owner="DateTime">
<msg time="2025-05-08T19:15:41.301800" level="INFO">${timestamp} = 2025-05-08 19:15:41</msg>
<var>${timestamp}</var>
<arg>result_format=%Y-%m-%d %H:%M:%S</arg>
<doc>Returns current local or UTC time with an optional increment.</doc>
<status status="PASS" start="2025-05-08T19:15:41.301538" elapsed="0.000300"/>
</kw>
<kw name="Catenate" owner="BuiltIn">
<msg time="2025-05-08T19:15:41.302221" level="INFO">${log_entry} = [2025-05-08 19:15:41] 步骤1: 使用AppleScript激活微信窗口</msg>
<var>${log_entry}</var>
<arg>SEPARATOR=\n</arg>
<arg>[${timestamp}] ${message}</arg>
<doc>Catenates the given items together and returns the resulted string.</doc>
<status status="PASS" start="2025-05-08T19:15:41.301971" elapsed="0.000287"/>
</kw>
<kw name="Append To File" owner="OperatingSystem">
<msg time="2025-05-08T19:15:41.302823" level="INFO" html="true">Appended to file '&lt;a href="file:///Users/zzy/hope/rpa/wechat_applescript_log.txt"&gt;/Users/zzy/hope/rpa/wechat_applescript_log.txt&lt;/a&gt;'.</msg>
<arg>${LOG_FILE}</arg>
<arg>${log_entry}\n</arg>
<doc>Appends the given content to the specified file.</doc>
<status status="PASS" start="2025-05-08T19:15:41.302386" elapsed="0.000514"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>${log_entry}</arg>
<doc>Logs the given message to the console.</doc>
<status status="PASS" start="2025-05-08T19:15:41.303036" elapsed="0.000207"/>
</kw>
<arg>步骤1: 使用AppleScript激活微信窗口</arg>
<status status="PASS" start="2025-05-08T19:15:41.301243" elapsed="0.002081"/>
</kw>
<kw name="记录日志">
<kw name="Get Current Date" owner="DateTime">
<msg time="2025-05-08T19:15:41.304065" level="INFO">${timestamp} = 2025-05-08 19:15:41</msg>
<var>${timestamp}</var>
<arg>result_format=%Y-%m-%d %H:%M:%S</arg>
<doc>Returns current local or UTC time with an optional increment.</doc>
<status status="PASS" start="2025-05-08T19:15:41.303835" elapsed="0.000267"/>
</kw>
<kw name="Catenate" owner="BuiltIn">
<msg time="2025-05-08T19:15:41.304481" level="INFO">${log_entry} = [2025-05-08 19:15:41] 联系人: "文件传输助手"</msg>
<var>${log_entry}</var>
<arg>SEPARATOR=\n</arg>
<arg>[${timestamp}] ${message}</arg>
<doc>Catenates the given items together and returns the resulted string.</doc>
<status status="PASS" start="2025-05-08T19:15:41.304230" elapsed="0.000288"/>
</kw>
<kw name="Append To File" owner="OperatingSystem">
<msg time="2025-05-08T19:15:41.305068" level="INFO" html="true">Appended to file '&lt;a href="file:///Users/zzy/hope/rpa/wechat_applescript_log.txt"&gt;/Users/zzy/hope/rpa/wechat_applescript_log.txt&lt;/a&gt;'.</msg>
<arg>${LOG_FILE}</arg>
<arg>${log_entry}\n</arg>
<doc>Appends the given content to the specified file.</doc>
<status status="PASS" start="2025-05-08T19:15:41.304659" elapsed="0.000488"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>${log_entry}</arg>
<doc>Logs the given message to the console.</doc>
<status status="PASS" start="2025-05-08T19:15:41.305298" elapsed="0.000209"/>
</kw>
<arg>联系人: "${target_contact}"</arg>
<status status="PASS" start="2025-05-08T19:15:41.303492" elapsed="0.002169"/>
</kw>
<kw name="记录日志">
<kw name="Get Current Date" owner="DateTime">
<msg time="2025-05-08T19:15:41.306461" level="INFO">${timestamp} = 2025-05-08 19:15:41</msg>
<var>${timestamp}</var>
<arg>result_format=%Y-%m-%d %H:%M:%S</arg>
<doc>Returns current local or UTC time with an optional increment.</doc>
<status status="PASS" start="2025-05-08T19:15:41.306226" elapsed="0.000281"/>
</kw>
<kw name="Catenate" owner="BuiltIn">
<msg time="2025-05-08T19:15:41.306895" level="INFO">${log_entry} = [2025-05-08 19:15:41] 将发送的消息内容: "你好，这是测试消息272"</msg>
<var>${log_entry}</var>
<arg>SEPARATOR=\n</arg>
<arg>[${timestamp}] ${message}</arg>
<doc>Catenates the given items together and returns the resulted string.</doc>
<status status="PASS" start="2025-05-08T19:15:41.306640" elapsed="0.000294"/>
</kw>
<kw name="Append To File" owner="OperatingSystem">
<msg time="2025-05-08T19:15:41.307485" level="INFO" html="true">Appended to file '&lt;a href="file:///Users/zzy/hope/rpa/wechat_applescript_log.txt"&gt;/Users/zzy/hope/rpa/wechat_applescript_log.txt&lt;/a&gt;'.</msg>
<arg>${LOG_FILE}</arg>
<arg>${log_entry}\n</arg>
<doc>Appends the given content to the specified file.</doc>
<status status="PASS" start="2025-05-08T19:15:41.307066" elapsed="0.000500"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>${log_entry}</arg>
<doc>Logs the given message to the console.</doc>
<status status="PASS" start="2025-05-08T19:15:41.307707" elapsed="0.000211"/>
</kw>
<arg>将发送的消息内容: "${custom_message}"</arg>
<status status="PASS" start="2025-05-08T19:15:41.305842" elapsed="0.002175"/>
</kw>
<kw name="Run Process" owner="Process">
<msg time="2025-05-08T19:15:41.308482" level="INFO">Starting process:
osascript /Users/zzy/hope/rpa/scripts/wechat/activate_wechat.applescript</msg>
<msg time="2025-05-08T19:15:41.316777" level="INFO">Waiting for process to complete.</msg>
<msg time="2025-05-08T19:15:41.545225" level="INFO">Process completed.</msg>
<msg time="2025-05-08T19:15:41.545741" level="INFO">${result1} = &lt;result object with rc 0&gt;</msg>
<var>${result1}</var>
<arg>osascript</arg>
<arg>${SCRIPTS_DIR}/activate_wechat.applescript</arg>
<arg>stderr=STDOUT</arg>
<doc>Runs a process and waits for it to complete.</doc>
<status status="PASS" start="2025-05-08T19:15:41.308157" elapsed="0.237661"/>
</kw>
<kw name="Run Keyword And Return Status" owner="BuiltIn">
<kw name="Should Be Empty" owner="BuiltIn">
<msg time="2025-05-08T19:15:41.549148" level="INFO">Length is 0.</msg>
<arg>${result1.stderr}</arg>
<doc>Verifies that the given item is empty.</doc>
<status status="PASS" start="2025-05-08T19:15:41.547312" elapsed="0.001951"/>
</kw>
<msg time="2025-05-08T19:15:41.549447" level="INFO">${wechat_activated} = True</msg>
<var>${wechat_activated}</var>
<arg>Should Be Empty</arg>
<arg>${result1.stderr}</arg>
<doc>Runs the given keyword with given arguments and returns the status as a Boolean value.</doc>
<status status="PASS" start="2025-05-08T19:15:41.546557" elapsed="0.002939"/>
</kw>
<if>
<branch type="IF" condition="not ${wechat_activated}">
<kw name="记录日志">
<arg>错误: 无法激活微信窗口: ${result1.stderr}</arg>
<status status="NOT RUN" start="2025-05-08T19:15:41.550388" elapsed="0.000062"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>\n错误: 无法激活微信窗口，请确认微信已安装并且可以手动启动\n</arg>
<doc>Logs the given message to the console.</doc>
<status status="NOT RUN" start="2025-05-08T19:15:41.550671" elapsed="0.000043"/>
</kw>
<return>
<value>${False}</value>
<status status="NOT RUN" start="2025-05-08T19:15:41.550830" elapsed="0.000050"/>
</return>
<status status="NOT RUN" start="2025-05-08T19:15:41.549755" elapsed="0.001198"/>
</branch>
<status status="PASS" start="2025-05-08T19:15:41.549669" elapsed="0.001334"/>
</if>
<kw name="记录日志">
<kw name="Get Current Date" owner="DateTime">
<msg time="2025-05-08T19:15:41.552976" level="INFO">${timestamp} = 2025-05-08 19:15:41</msg>
<var>${timestamp}</var>
<arg>result_format=%Y-%m-%d %H:%M:%S</arg>
<doc>Returns current local or UTC time with an optional increment.</doc>
<status status="PASS" start="2025-05-08T19:15:41.552560" elapsed="0.000486"/>
</kw>
<kw name="Catenate" owner="BuiltIn">
<msg time="2025-05-08T19:15:41.553703" level="INFO">${log_entry} = [2025-05-08 19:15:41] AppleScript激活微信窗口结果: </msg>
<var>${log_entry}</var>
<arg>SEPARATOR=\n</arg>
<arg>[${timestamp}] ${message}</arg>
<doc>Catenates the given items together and returns the resulted string.</doc>
<status status="PASS" start="2025-05-08T19:15:41.553310" elapsed="0.000445"/>
</kw>
<kw name="Append To File" owner="OperatingSystem">
<msg time="2025-05-08T19:15:41.554566" level="INFO" html="true">Appended to file '&lt;a href="file:///Users/zzy/hope/rpa/wechat_applescript_log.txt"&gt;/Users/zzy/hope/rpa/wechat_applescript_log.txt&lt;/a&gt;'.</msg>
<arg>${LOG_FILE}</arg>
<arg>${log_entry}\n</arg>
<doc>Appends the given content to the specified file.</doc>
<status status="PASS" start="2025-05-08T19:15:41.553910" elapsed="0.000782"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>${log_entry}</arg>
<doc>Logs the given message to the console.</doc>
<status status="PASS" start="2025-05-08T19:15:41.554935" elapsed="0.000362"/>
</kw>
<arg>AppleScript激活微信窗口结果: ${result1.stdout}</arg>
<status status="PASS" start="2025-05-08T19:15:41.551240" elapsed="0.004316"/>
</kw>
<kw name="Sleep" owner="BuiltIn">
<msg time="2025-05-08T19:15:42.556524" level="INFO">Slept 1 second.</msg>
<arg>1s</arg>
<doc>Pauses the test executed for the given time.</doc>
<status status="PASS" start="2025-05-08T19:15:41.555759" elapsed="1.000887"/>
</kw>
<kw name="记录日志">
<kw name="Get Current Date" owner="DateTime">
<msg time="2025-05-08T19:15:42.557620" level="INFO">${timestamp} = 2025-05-08 19:15:42</msg>
<var>${timestamp}</var>
<arg>result_format=%Y-%m-%d %H:%M:%S</arg>
<doc>Returns current local or UTC time with an optional increment.</doc>
<status status="PASS" start="2025-05-08T19:15:42.557339" elapsed="0.000319"/>
</kw>
<kw name="Catenate" owner="BuiltIn">
<msg time="2025-05-08T19:15:42.558039" level="INFO">${log_entry} = [2025-05-08 19:15:42] 步骤2: 等待窗口激活完成</msg>
<var>${log_entry}</var>
<arg>SEPARATOR=\n</arg>
<arg>[${timestamp}] ${message}</arg>
<doc>Catenates the given items together and returns the resulted string.</doc>
<status status="PASS" start="2025-05-08T19:15:42.557789" elapsed="0.000286"/>
</kw>
<kw name="Append To File" owner="OperatingSystem">
<msg time="2025-05-08T19:15:42.558544" level="INFO" html="true">Appended to file '&lt;a href="file:///Users/zzy/hope/rpa/wechat_applescript_log.txt"&gt;/Users/zzy/hope/rpa/wechat_applescript_log.txt&lt;/a&gt;'.</msg>
<arg>${LOG_FILE}</arg>
<arg>${log_entry}\n</arg>
<doc>Appends the given content to the specified file.</doc>
<status status="PASS" start="2025-05-08T19:15:42.558194" elapsed="0.000419"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>${log_entry}</arg>
<doc>Logs the given message to the console.</doc>
<status status="PASS" start="2025-05-08T19:15:42.558736" elapsed="0.000184"/>
</kw>
<arg>步骤2: 等待窗口激活完成</arg>
<status status="PASS" start="2025-05-08T19:15:42.556862" elapsed="0.002140"/>
</kw>
<kw name="记录日志">
<kw name="Get Current Date" owner="DateTime">
<msg time="2025-05-08T19:15:42.559891" level="INFO">${timestamp} = 2025-05-08 19:15:42</msg>
<var>${timestamp}</var>
<arg>result_format=%Y-%m-%d %H:%M:%S</arg>
<doc>Returns current local or UTC time with an optional increment.</doc>
<status status="PASS" start="2025-05-08T19:15:42.559642" elapsed="0.000288"/>
</kw>
<kw name="Catenate" owner="BuiltIn">
<msg time="2025-05-08T19:15:42.560340" level="INFO">${log_entry} = [2025-05-08 19:15:42] 步骤3: 使用预创建脚本搜索联系人 "文件传输助手"</msg>
<var>${log_entry}</var>
<arg>SEPARATOR=\n</arg>
<arg>[${timestamp}] ${message}</arg>
<doc>Catenates the given items together and returns the resulted string.</doc>
<status status="PASS" start="2025-05-08T19:15:42.560057" elapsed="0.000325"/>
</kw>
<kw name="Append To File" owner="OperatingSystem">
<msg time="2025-05-08T19:15:42.560850" level="INFO" html="true">Appended to file '&lt;a href="file:///Users/zzy/hope/rpa/wechat_applescript_log.txt"&gt;/Users/zzy/hope/rpa/wechat_applescript_log.txt&lt;/a&gt;'.</msg>
<arg>${LOG_FILE}</arg>
<arg>${log_entry}\n</arg>
<doc>Appends the given content to the specified file.</doc>
<status status="PASS" start="2025-05-08T19:15:42.560508" elapsed="0.000419"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>${log_entry}</arg>
<doc>Logs the given message to the console.</doc>
<status status="PASS" start="2025-05-08T19:15:42.561050" elapsed="0.000186"/>
</kw>
<arg>步骤3: 使用预创建脚本搜索联系人 "${target_contact}"</arg>
<status status="PASS" start="2025-05-08T19:15:42.559158" elapsed="0.002158"/>
</kw>
<kw name="Run Process" owner="Process">
<msg time="2025-05-08T19:15:42.561730" level="INFO">Starting process:
osascript /Users/zzy/hope/rpa/scripts/wechat/search_contact.applescript 文件传输助手</msg>
<msg time="2025-05-08T19:15:42.567987" level="INFO">Waiting for process to complete.</msg>
<msg time="2025-05-08T19:15:48.150452" level="INFO">Process completed.</msg>
<msg time="2025-05-08T19:15:48.150833" level="INFO">${result2} = &lt;result object with rc 0&gt;</msg>
<var>${result2}</var>
<arg>osascript</arg>
<arg>${SCRIPTS_DIR}/search_contact.applescript</arg>
<arg>${target_contact}</arg>
<arg>stderr=STDOUT</arg>
<doc>Runs a process and waits for it to complete.</doc>
<status status="PASS" start="2025-05-08T19:15:42.561437" elapsed="5.589446"/>
</kw>
<kw name="Run Keyword And Return Status" owner="BuiltIn">
<kw name="Should Be Empty" owner="BuiltIn">
<msg time="2025-05-08T19:15:48.152610" level="INFO">Length is 0.</msg>
<arg>${result2.stderr}</arg>
<doc>Verifies that the given item is empty.</doc>
<status status="PASS" start="2025-05-08T19:15:48.151869" elapsed="0.000807"/>
</kw>
<msg time="2025-05-08T19:15:48.152907" level="INFO">${contact_found} = True</msg>
<var>${contact_found}</var>
<arg>Should Be Empty</arg>
<arg>${result2.stderr}</arg>
<doc>Runs the given keyword with given arguments and returns the status as a Boolean value.</doc>
<status status="PASS" start="2025-05-08T19:15:48.151421" elapsed="0.001519"/>
</kw>
<if>
<branch type="IF" condition="not ${contact_found}">
<kw name="记录日志">
<arg>错误: 搜索联系人失败: ${result2.stderr}</arg>
<status status="NOT RUN" start="2025-05-08T19:15:48.153514" elapsed="0.000037"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>\n错误: 无法搜索或找到联系人 "${target_contact}"\n</arg>
<doc>Logs the given message to the console.</doc>
<status status="NOT RUN" start="2025-05-08T19:15:48.153688" elapsed="0.000029"/>
</kw>
<return>
<value>${False}</value>
<status status="NOT RUN" start="2025-05-08T19:15:48.153788" elapsed="0.000029"/>
</return>
<status status="NOT RUN" start="2025-05-08T19:15:48.153115" elapsed="0.000746"/>
</branch>
<status status="PASS" start="2025-05-08T19:15:48.153056" elapsed="0.000837"/>
</if>
<kw name="记录日志">
<kw name="Get Current Date" owner="DateTime">
<msg time="2025-05-08T19:15:48.155156" level="INFO">${timestamp} = 2025-05-08 19:15:48</msg>
<var>${timestamp}</var>
<arg>result_format=%Y-%m-%d %H:%M:%S</arg>
<doc>Returns current local or UTC time with an optional increment.</doc>
<status status="PASS" start="2025-05-08T19:15:48.154841" elapsed="0.000351"/>
</kw>
<kw name="Catenate" owner="BuiltIn">
<msg time="2025-05-08T19:15:48.155577" level="INFO">${log_entry} = [2025-05-08 19:15:48] 搜索联系人脚本执行结果: </msg>
<var>${log_entry}</var>
<arg>SEPARATOR=\n</arg>
<arg>[${timestamp}] ${message}</arg>
<doc>Catenates the given items together and returns the resulted string.</doc>
<status status="PASS" start="2025-05-08T19:15:48.155325" elapsed="0.000287"/>
</kw>
<kw name="Append To File" owner="OperatingSystem">
<msg time="2025-05-08T19:15:48.156256" level="INFO" html="true">Appended to file '&lt;a href="file:///Users/zzy/hope/rpa/wechat_applescript_log.txt"&gt;/Users/zzy/hope/rpa/wechat_applescript_log.txt&lt;/a&gt;'.</msg>
<arg>${LOG_FILE}</arg>
<arg>${log_entry}\n</arg>
<doc>Appends the given content to the specified file.</doc>
<status status="PASS" start="2025-05-08T19:15:48.155747" elapsed="0.000590"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>${log_entry}</arg>
<doc>Logs the given message to the console.</doc>
<status status="PASS" start="2025-05-08T19:15:48.156467" elapsed="0.000234"/>
</kw>
<arg>搜索联系人脚本执行结果: ${result2.stdout}</arg>
<status status="PASS" start="2025-05-08T19:15:48.154038" elapsed="0.002747"/>
</kw>
<kw name="Sleep" owner="BuiltIn">
<msg time="2025-05-08T19:15:48.257383" level="INFO">Slept 100 milliseconds.</msg>
<arg>0.1s</arg>
<doc>Pauses the test executed for the given time.</doc>
<status status="PASS" start="2025-05-08T19:15:48.156914" elapsed="0.100589"/>
</kw>
<kw name="记录日志">
<kw name="Get Current Date" owner="DateTime">
<msg time="2025-05-08T19:15:48.258444" level="INFO">${timestamp} = 2025-05-08 19:15:48</msg>
<var>${timestamp}</var>
<arg>result_format=%Y-%m-%d %H:%M:%S</arg>
<doc>Returns current local or UTC time with an optional increment.</doc>
<status status="PASS" start="2025-05-08T19:15:48.258181" elapsed="0.000300"/>
</kw>
<kw name="Catenate" owner="BuiltIn">
<msg time="2025-05-08T19:15:48.258850" level="INFO">${log_entry} = [2025-05-08 19:15:48] 步骤4: 聊天窗口已加载，准备输入消息</msg>
<var>${log_entry}</var>
<arg>SEPARATOR=\n</arg>
<arg>[${timestamp}] ${message}</arg>
<doc>Catenates the given items together and returns the resulted string.</doc>
<status status="PASS" start="2025-05-08T19:15:48.258606" elapsed="0.000279"/>
</kw>
<kw name="Append To File" owner="OperatingSystem">
<msg time="2025-05-08T19:15:48.259435" level="INFO" html="true">Appended to file '&lt;a href="file:///Users/zzy/hope/rpa/wechat_applescript_log.txt"&gt;/Users/zzy/hope/rpa/wechat_applescript_log.txt&lt;/a&gt;'.</msg>
<arg>${LOG_FILE}</arg>
<arg>${log_entry}\n</arg>
<doc>Appends the given content to the specified file.</doc>
<status status="PASS" start="2025-05-08T19:15:48.259004" elapsed="0.000502"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>${log_entry}</arg>
<doc>Logs the given message to the console.</doc>
<status status="PASS" start="2025-05-08T19:15:48.259632" elapsed="0.000198"/>
</kw>
<arg>步骤4: 聊天窗口已加载，准备输入消息</arg>
<status status="PASS" start="2025-05-08T19:15:48.257801" elapsed="0.002107"/>
</kw>
<kw name="记录日志">
<kw name="Get Current Date" owner="DateTime">
<msg time="2025-05-08T19:15:48.260598" level="INFO">${timestamp} = 2025-05-08 19:15:48</msg>
<var>${timestamp}</var>
<arg>result_format=%Y-%m-%d %H:%M:%S</arg>
<doc>Returns current local or UTC time with an optional increment.</doc>
<status status="PASS" start="2025-05-08T19:15:48.260370" elapsed="0.000262"/>
</kw>
<kw name="Catenate" owner="BuiltIn">
<msg time="2025-05-08T19:15:48.260981" level="INFO">${log_entry} = [2025-05-08 19:15:48] 检查是否可以使用cliclick工具</msg>
<var>${log_entry}</var>
<arg>SEPARATOR=\n</arg>
<arg>[${timestamp}] ${message}</arg>
<doc>Catenates the given items together and returns the resulted string.</doc>
<status status="PASS" start="2025-05-08T19:15:48.260750" elapsed="0.000266"/>
</kw>
<kw name="Append To File" owner="OperatingSystem">
<msg time="2025-05-08T19:15:48.261515" level="INFO" html="true">Appended to file '&lt;a href="file:///Users/zzy/hope/rpa/wechat_applescript_log.txt"&gt;/Users/zzy/hope/rpa/wechat_applescript_log.txt&lt;/a&gt;'.</msg>
<arg>${LOG_FILE}</arg>
<arg>${log_entry}\n</arg>
<doc>Appends the given content to the specified file.</doc>
<status status="PASS" start="2025-05-08T19:15:48.261134" elapsed="0.000451"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>${log_entry}</arg>
<doc>Logs the given message to the console.</doc>
<status status="PASS" start="2025-05-08T19:15:48.261717" elapsed="0.000187"/>
</kw>
<arg>检查是否可以使用cliclick工具</arg>
<status status="PASS" start="2025-05-08T19:15:48.260073" elapsed="0.001912"/>
</kw>
<kw name="Run Process" owner="Process">
<msg time="2025-05-08T19:15:48.262328" level="INFO">Starting process:
which cliclick</msg>
<msg time="2025-05-08T19:15:48.267874" level="INFO">Waiting for process to complete.</msg>
<msg time="2025-05-08T19:15:48.277163" level="INFO">Process completed.</msg>
<msg time="2025-05-08T19:15:48.277533" level="INFO">${cliclick_check} = &lt;result object with rc 0&gt;</msg>
<var>${cliclick_check}</var>
<arg>which cliclick</arg>
<arg>shell=true</arg>
<doc>Runs a process and waits for it to complete.</doc>
<status status="PASS" start="2025-05-08T19:15:48.262112" elapsed="0.015471"/>
</kw>
<kw name="Run Keyword And Return Status" owner="BuiltIn">
<kw name="Should Not Be Empty" owner="BuiltIn">
<msg time="2025-05-08T19:15:48.279117" level="INFO">Length is 23.</msg>
<arg>${cliclick_check.stdout}</arg>
<doc>Verifies that the given item is not empty.</doc>
<status status="PASS" start="2025-05-08T19:15:48.278400" elapsed="0.000786"/>
</kw>
<msg time="2025-05-08T19:15:48.279287" level="INFO">${has_cliclick} = True</msg>
<var>${has_cliclick}</var>
<arg>Should Not Be Empty</arg>
<arg>${cliclick_check.stdout}</arg>
<doc>Runs the given keyword with given arguments and returns the status as a Boolean value.</doc>
<status status="PASS" start="2025-05-08T19:15:48.278053" elapsed="0.001264"/>
</kw>
<kw name="Set Variable" owner="BuiltIn">
<msg time="2025-05-08T19:15:48.279638" level="INFO">${send_success} = False</msg>
<var>${send_success}</var>
<arg>${False}</arg>
<doc>Returns the given values which can then be assigned to a variables.</doc>
<status status="PASS" start="2025-05-08T19:15:48.279460" elapsed="0.000208"/>
</kw>
<if>
<branch type="IF" condition="${has_cliclick}">
<kw name="记录日志">
<kw name="Get Current Date" owner="DateTime">
<msg time="2025-05-08T19:15:48.280832" level="INFO">${timestamp} = 2025-05-08 19:15:48</msg>
<var>${timestamp}</var>
<arg>result_format=%Y-%m-%d %H:%M:%S</arg>
<doc>Returns current local or UTC time with an optional increment.</doc>
<status status="PASS" start="2025-05-08T19:15:48.280534" elapsed="0.000443"/>
</kw>
<kw name="Catenate" owner="BuiltIn">
<msg time="2025-05-08T19:15:48.281458" level="INFO">${log_entry} = [2025-05-08 19:15:48] 找到cliclick工具，使用增强型cliclick专用脚本发送消息 (使用多种获取焦点方法)</msg>
<var>${log_entry}</var>
<arg>SEPARATOR=\n</arg>
<arg>[${timestamp}] ${message}</arg>
<doc>Catenates the given items together and returns the resulted string.</doc>
<status status="PASS" start="2025-05-08T19:15:48.281111" elapsed="0.000411"/>
</kw>
<kw name="Append To File" owner="OperatingSystem">
<msg time="2025-05-08T19:15:48.282170" level="INFO" html="true">Appended to file '&lt;a href="file:///Users/zzy/hope/rpa/wechat_applescript_log.txt"&gt;/Users/zzy/hope/rpa/wechat_applescript_log.txt&lt;/a&gt;'.</msg>
<arg>${LOG_FILE}</arg>
<arg>${log_entry}\n</arg>
<doc>Appends the given content to the specified file.</doc>
<status status="PASS" start="2025-05-08T19:15:48.281671" elapsed="0.000572"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>${log_entry}</arg>
<doc>Logs the given message to the console.</doc>
<status status="PASS" start="2025-05-08T19:15:48.282387" elapsed="0.000226"/>
</kw>
<arg>找到cliclick工具，使用增强型cliclick专用脚本发送消息 (使用多种获取焦点方法)</arg>
<status status="PASS" start="2025-05-08T19:15:48.280149" elapsed="0.002546"/>
</kw>
<kw name="记录日志">
<kw name="Get Current Date" owner="DateTime">
<msg time="2025-05-08T19:15:48.283380" level="INFO">${timestamp} = 2025-05-08 19:15:48</msg>
<var>${timestamp}</var>
<arg>result_format=%Y-%m-%d %H:%M:%S</arg>
<doc>Returns current local or UTC time with an optional increment.</doc>
<status status="PASS" start="2025-05-08T19:15:48.283155" elapsed="0.000259"/>
</kw>
<kw name="Catenate" owner="BuiltIn">
<msg time="2025-05-08T19:15:48.283773" level="INFO">${log_entry} = [2025-05-08 19:15:48] 执行增强型焦点获取脚本 (使用多种点击方法和位置，模拟更真实的用户行为)</msg>
<var>${log_entry}</var>
<arg>SEPARATOR=\n</arg>
<arg>[${timestamp}] ${message}</arg>
<doc>Catenates the given items together and returns the resulted string.</doc>
<status status="PASS" start="2025-05-08T19:15:48.283540" elapsed="0.000268"/>
</kw>
<kw name="Append To File" owner="OperatingSystem">
<msg time="2025-05-08T19:15:48.284329" level="INFO" html="true">Appended to file '&lt;a href="file:///Users/zzy/hope/rpa/wechat_applescript_log.txt"&gt;/Users/zzy/hope/rpa/wechat_applescript_log.txt&lt;/a&gt;'.</msg>
<arg>${LOG_FILE}</arg>
<arg>${log_entry}\n</arg>
<doc>Appends the given content to the specified file.</doc>
<status status="PASS" start="2025-05-08T19:15:48.283928" elapsed="0.000472"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>${log_entry}</arg>
<doc>Logs the given message to the console.</doc>
<status status="PASS" start="2025-05-08T19:15:48.284528" elapsed="0.000191"/>
</kw>
<arg>执行增强型焦点获取脚本 (使用多种点击方法和位置，模拟更真实的用户行为)</arg>
<status status="PASS" start="2025-05-08T19:15:48.282857" elapsed="0.001938"/>
</kw>
<kw name="Run Process" owner="Process">
<msg time="2025-05-08T19:15:48.285259" level="INFO">Starting process:
osascript /Users/zzy/hope/rpa/scripts/wechat/cliclick_focus_send.applescript 你好，这是测试消息272</msg>
<msg time="2025-05-08T19:15:48.292915" level="INFO">Waiting for process to complete.</msg>
<msg time="2025-05-08T19:15:52.325842" level="INFO">Process completed.</msg>
<msg time="2025-05-08T19:15:52.326304" level="INFO">${result3} = &lt;result object with rc 0&gt;</msg>
<var>${result3}</var>
<arg>osascript</arg>
<arg>${SCRIPTS_DIR}/cliclick_focus_send.applescript</arg>
<arg>${custom_message}</arg>
<arg>stderr=STDOUT</arg>
<doc>Runs a process and waits for it to complete.</doc>
<status status="PASS" start="2025-05-08T19:15:48.284940" elapsed="4.041427"/>
</kw>
<kw name="Run Keyword And Return Status" owner="BuiltIn">
<kw name="Should Be Empty" owner="BuiltIn">
<msg time="2025-05-08T19:15:52.328312" level="INFO">Length is 0.</msg>
<arg>${result3.stderr}</arg>
<doc>Verifies that the given item is empty.</doc>
<status status="PASS" start="2025-05-08T19:15:52.327497" elapsed="0.000887"/>
</kw>
<msg time="2025-05-08T19:15:52.328487" level="INFO">${send_success} = True</msg>
<var>${send_success}</var>
<arg>Should Be Empty</arg>
<arg>${result3.stderr}</arg>
<doc>Runs the given keyword with given arguments and returns the status as a Boolean value.</doc>
<status status="PASS" start="2025-05-08T19:15:52.327006" elapsed="0.001511"/>
</kw>
<kw name="记录日志">
<kw name="Get Current Date" owner="DateTime">
<msg time="2025-05-08T19:15:52.334550" level="INFO">${timestamp} = 2025-05-08 19:15:52</msg>
<var>${timestamp}</var>
<arg>result_format=%Y-%m-%d %H:%M:%S</arg>
<doc>Returns current local or UTC time with an optional increment.</doc>
<status status="PASS" start="2025-05-08T19:15:52.334247" elapsed="0.000340"/>
</kw>
<kw name="Catenate" owner="BuiltIn">
<msg time="2025-05-08T19:15:52.334963" level="INFO">${log_entry} = [2025-05-08 19:15:52] cliclick专用脚本执行结果: === 脚本开始执行时间: 19:15:48 ===
目标应用: 企业微信 (进程名: 企业微信)
=== 脚本执行统计 ===
目标应用: 企业微信
开始时间: 19:15:48
结束时间: 19:15:52
总执行时间: 0分 4秒 (共4秒)
==================</msg>
<var>${log_entry}</var>
<arg>SEPARATOR=\n</arg>
<arg>[${timestamp}] ${message}</arg>
<doc>Catenates the given items together and returns the resulted string.</doc>
<status status="PASS" start="2025-05-08T19:15:52.334708" elapsed="0.000292"/>
</kw>
<kw name="Append To File" owner="OperatingSystem">
<msg time="2025-05-08T19:15:52.335593" level="INFO" html="true">Appended to file '&lt;a href="file:///Users/zzy/hope/rpa/wechat_applescript_log.txt"&gt;/Users/zzy/hope/rpa/wechat_applescript_log.txt&lt;/a&gt;'.</msg>
<arg>${LOG_FILE}</arg>
<arg>${log_entry}\n</arg>
<doc>Appends the given content to the specified file.</doc>
<status status="PASS" start="2025-05-08T19:15:52.335116" elapsed="0.000550"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>${log_entry}</arg>
<doc>Logs the given message to the console.</doc>
<status status="PASS" start="2025-05-08T19:15:52.335792" elapsed="0.000218"/>
</kw>
<arg>cliclick专用脚本执行结果: ${result3.stdout}</arg>
<status status="PASS" start="2025-05-08T19:15:52.328788" elapsed="0.007351"/>
</kw>
<if>
<branch type="IF" condition="${send_success}">
<kw name="记录日志">
<kw name="Get Current Date" owner="DateTime">
<msg time="2025-05-08T19:15:52.337081" level="INFO">${timestamp} = 2025-05-08 19:15:52</msg>
<var>${timestamp}</var>
<arg>result_format=%Y-%m-%d %H:%M:%S</arg>
<doc>Returns current local or UTC time with an optional increment.</doc>
<status status="PASS" start="2025-05-08T19:15:52.336863" elapsed="0.000251"/>
</kw>
<kw name="Catenate" owner="BuiltIn">
<msg time="2025-05-08T19:15:52.337456" level="INFO">${log_entry} = [2025-05-08 19:15:52] 使用增强型cliclick获取焦点机制后通过AppleScript完成消息发送</msg>
<var>${log_entry}</var>
<arg>SEPARATOR=\n</arg>
<arg>[${timestamp}] ${message}</arg>
<doc>Catenates the given items together and returns the resulted string.</doc>
<status status="PASS" start="2025-05-08T19:15:52.337234" elapsed="0.000254"/>
</kw>
<kw name="Append To File" owner="OperatingSystem">
<msg time="2025-05-08T19:15:52.337971" level="INFO" html="true">Appended to file '&lt;a href="file:///Users/zzy/hope/rpa/wechat_applescript_log.txt"&gt;/Users/zzy/hope/rpa/wechat_applescript_log.txt&lt;/a&gt;'.</msg>
<arg>${LOG_FILE}</arg>
<arg>${log_entry}\n</arg>
<doc>Appends the given content to the specified file.</doc>
<status status="PASS" start="2025-05-08T19:15:52.337602" elapsed="0.000437"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>${log_entry}</arg>
<doc>Logs the given message to the console.</doc>
<status status="PASS" start="2025-05-08T19:15:52.338213" elapsed="0.000197"/>
</kw>
<arg>使用增强型cliclick获取焦点机制后通过AppleScript完成消息发送</arg>
<status status="PASS" start="2025-05-08T19:15:52.336583" elapsed="0.001987"/>
</kw>
<return>
<value>${True}</value>
<status status="PASS" start="2025-05-08T19:15:52.338639" elapsed="0.000085"/>
</return>
<status status="PASS" start="2025-05-08T19:15:52.336359" elapsed="0.002422"/>
</branch>
<branch type="ELSE">
<kw name="记录日志">
<arg>警告: 增强型cliclick脚本执行出现错误: ${result3.stderr}</arg>
<status status="NOT RUN" start="2025-05-08T19:15:52.338976" elapsed="0.000029"/>
</kw>
<kw name="记录日志">
<arg>尝试使用纯AppleScript方案作为备选</arg>
<status status="NOT RUN" start="2025-05-08T19:15:52.339154" elapsed="0.000028"/>
</kw>
<status status="NOT RUN" start="2025-05-08T19:15:52.338817" elapsed="0.000402"/>
</branch>
<status status="PASS" start="2025-05-08T19:15:52.336310" elapsed="0.002938"/>
</if>
<status status="PASS" start="2025-05-08T19:15:48.279830" elapsed="4.059492"/>
</branch>
<branch type="ELSE">
<kw name="记录日志">
<arg>未找到cliclick工具，使用纯AppleScript方案</arg>
<status status="NOT RUN" start="2025-05-08T19:15:52.339571" elapsed="0.000031"/>
</kw>
<status status="NOT RUN" start="2025-05-08T19:15:52.339378" elapsed="0.000277"/>
</branch>
<status status="PASS" start="2025-05-08T19:15:48.279773" elapsed="4.059915"/>
</if>
<kw name="记录日志">
<arg>尝试使用纯AppleScript方案发送消息</arg>
<status status="NOT RUN" start="2025-05-08T19:15:52.339826" elapsed="0.000029"/>
</kw>
<kw name="Run Process" owner="Process">
<var>${result4}</var>
<arg>osascript</arg>
<arg>${SCRIPTS_DIR}/send_message.applescript</arg>
<arg>${custom_message}</arg>
<arg>stderr=STDOUT</arg>
<doc>Runs a process and waits for it to complete.</doc>
<status status="NOT RUN" start="2025-05-08T19:15:52.339980" elapsed="0.000026"/>
</kw>
<kw name="Run Keyword And Return Status" owner="BuiltIn">
<var>${send_success}</var>
<arg>Should Be Empty</arg>
<arg>${result4.stderr}</arg>
<doc>Runs the given keyword with given arguments and returns the status as a Boolean value.</doc>
<status status="NOT RUN" start="2025-05-08T19:15:52.340144" elapsed="0.000026"/>
</kw>
<if>
<branch type="IF" condition="${send_success}">
<kw name="记录日志">
<arg>纯AppleScript消息发送脚本执行结果: ${result4.stdout}</arg>
<status status="NOT RUN" start="2025-05-08T19:15:52.340395" elapsed="0.000027"/>
</kw>
<kw name="记录日志">
<arg>消息发送完成</arg>
<status status="NOT RUN" start="2025-05-08T19:15:52.340550" elapsed="0.000026"/>
</kw>
<return>
<value>${True}</value>
<status status="NOT RUN" start="2025-05-08T19:15:52.340624" elapsed="0.000022"/>
</return>
<status status="NOT RUN" start="2025-05-08T19:15:52.340260" elapsed="0.000422"/>
</branch>
<branch type="ELSE">
<kw name="记录日志">
<arg>错误: 所有消息发送方法都失败: ${result4.stderr}</arg>
<status status="NOT RUN" start="2025-05-08T19:15:52.340840" elapsed="0.000062"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>\n错误: 无法发送消息，请检查微信窗口状态\n</arg>
<doc>Logs the given message to the console.</doc>
<status status="NOT RUN" start="2025-05-08T19:15:52.341032" elapsed="0.000028"/>
</kw>
<kw name="记录日志">
<arg>提示: 如果消息能发送但内容不显示，可能是焦点问题，尝试以下解决方法:</arg>
<status status="NOT RUN" start="2025-05-08T19:15:52.341199" elapsed="0.000028"/>
</kw>
<kw name="记录日志">
<arg>1. 确保微信窗口处于前台活动状态</arg>
<status status="NOT RUN" start="2025-05-08T19:15:52.341357" elapsed="0.000026"/>
</kw>
<kw name="记录日志">
<arg>2. 检查屏幕分辨率与脚本中的点击坐标匹配</arg>
<status status="NOT RUN" start="2025-05-08T19:15:52.341584" elapsed="0.000038"/>
</kw>
<kw name="记录日志">
<arg>3. 尝试使用较慢的执行速度 (使用 --variable SLOW:True 参数运行)</arg>
<status status="NOT RUN" start="2025-05-08T19:15:52.341772" elapsed="0.000029"/>
</kw>
<kw name="记录日志">
<arg>4. 手动编辑cliclick_focus_send.applescript，调整点击坐标</arg>
<status status="NOT RUN" start="2025-05-08T19:15:52.341933" elapsed="0.000027"/>
</kw>
<return>
<value>${False}</value>
<status status="NOT RUN" start="2025-05-08T19:15:52.342066" elapsed="0.000032"/>
</return>
<status status="NOT RUN" start="2025-05-08T19:15:52.340712" elapsed="0.001433"/>
</branch>
<status status="NOT RUN" start="2025-05-08T19:15:52.340235" elapsed="0.001941"/>
</if>
<arg>${CONTACT}</arg>
<arg>${MESSAGE}</arg>
<status status="PASS" start="2025-05-08T19:15:41.300820" elapsed="11.041523"/>
</kw>
<arg>${scripts_ok}</arg>
<arg>执行基于AppleScript的微信自动化</arg>
<arg>${CONTACT}</arg>
<arg>${MESSAGE}</arg>
<arg>ELSE</arg>
<arg>Log To Console</arg>
<arg>\n无法执行自动化：预创建的脚本文件缺失或无执行权限\n</arg>
<doc>Runs the given keyword with the given arguments, if ``condition`` is true.</doc>
<status status="PASS" start="2025-05-08T19:15:41.299995" elapsed="11.042421"/>
</kw>
<kw name="记录完成信息">
<kw name="Get Current Date" owner="DateTime">
<msg time="2025-05-08T19:15:52.343305" level="INFO">${timestamp} = 2025-05-08 19:15:52</msg>
<var>${timestamp}</var>
<arg>result_format=%Y-%m-%d %H:%M:%S</arg>
<doc>Returns current local or UTC time with an optional increment.</doc>
<status status="PASS" start="2025-05-08T19:15:52.343068" elapsed="0.000273"/>
</kw>
<kw name="记录日志">
<kw name="Get Current Date" owner="DateTime">
<msg time="2025-05-08T19:15:52.344018" level="INFO">${timestamp} = 2025-05-08 19:15:52</msg>
<var>${timestamp}</var>
<arg>result_format=%Y-%m-%d %H:%M:%S</arg>
<doc>Returns current local or UTC time with an optional increment.</doc>
<status status="PASS" start="2025-05-08T19:15:52.343812" elapsed="0.000242"/>
</kw>
<kw name="Catenate" owner="BuiltIn">
<msg time="2025-05-08T19:15:52.344395" level="INFO">${log_entry} = [2025-05-08 19:15:52] 自动化流程完成。结束时间: 2025-05-08 19:15:52</msg>
<var>${log_entry}</var>
<arg>SEPARATOR=\n</arg>
<arg>[${timestamp}] ${message}</arg>
<doc>Catenates the given items together and returns the resulted string.</doc>
<status status="PASS" start="2025-05-08T19:15:52.344171" elapsed="0.000258"/>
</kw>
<kw name="Append To File" owner="OperatingSystem">
<msg time="2025-05-08T19:15:52.344947" level="INFO" html="true">Appended to file '&lt;a href="file:///Users/zzy/hope/rpa/wechat_applescript_log.txt"&gt;/Users/zzy/hope/rpa/wechat_applescript_log.txt&lt;/a&gt;'.</msg>
<arg>${LOG_FILE}</arg>
<arg>${log_entry}\n</arg>
<doc>Appends the given content to the specified file.</doc>
<status status="PASS" start="2025-05-08T19:15:52.344545" elapsed="0.000472"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>${log_entry}</arg>
<doc>Logs the given message to the console.</doc>
<status status="PASS" start="2025-05-08T19:15:52.345140" elapsed="0.000288"/>
</kw>
<arg>自动化流程完成。结束时间: ${timestamp}</arg>
<status status="PASS" start="2025-05-08T19:15:52.343490" elapsed="0.002129"/>
</kw>
<kw name="记录日志">
<kw name="Get Current Date" owner="DateTime">
<msg time="2025-05-08T19:15:52.346562" level="INFO">${timestamp} = 2025-05-08 19:15:52</msg>
<var>${timestamp}</var>
<arg>result_format=%Y-%m-%d %H:%M:%S</arg>
<doc>Returns current local or UTC time with an optional increment.</doc>
<status status="PASS" start="2025-05-08T19:15:52.346257" elapsed="0.000344"/>
</kw>
<kw name="Catenate" owner="BuiltIn">
<msg time="2025-05-08T19:15:52.347150" level="INFO">${log_entry} = [2025-05-08 19:15:52] --------------------------------------------------</msg>
<var>${log_entry}</var>
<arg>SEPARATOR=\n</arg>
<arg>[${timestamp}] ${message}</arg>
<doc>Catenates the given items together and returns the resulted string.</doc>
<status status="PASS" start="2025-05-08T19:15:52.346732" elapsed="0.000457"/>
</kw>
<kw name="Append To File" owner="OperatingSystem">
<msg time="2025-05-08T19:15:52.347859" level="INFO" html="true">Appended to file '&lt;a href="file:///Users/zzy/hope/rpa/wechat_applescript_log.txt"&gt;/Users/zzy/hope/rpa/wechat_applescript_log.txt&lt;/a&gt;'.</msg>
<arg>${LOG_FILE}</arg>
<arg>${log_entry}\n</arg>
<doc>Appends the given content to the specified file.</doc>
<status status="PASS" start="2025-05-08T19:15:52.347404" elapsed="0.000743"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>${log_entry}</arg>
<doc>Logs the given message to the console.</doc>
<status status="PASS" start="2025-05-08T19:15:52.348292" elapsed="0.000209"/>
</kw>
<arg>--------------------------------------------------</arg>
<status status="PASS" start="2025-05-08T19:15:52.345883" elapsed="0.002701"/>
</kw>
<kw name="Normalize Path" owner="OperatingSystem">
<msg time="2025-05-08T19:15:52.348888" level="INFO">${log_path} = /Users/zzy/hope/rpa/wechat_applescript_log.txt</msg>
<var>${log_path}</var>
<arg>${LOG_FILE}</arg>
<doc>Normalizes the given path.</doc>
<status status="PASS" start="2025-05-08T19:15:52.348702" elapsed="0.000222"/>
</kw>
<kw name="Log" owner="BuiltIn">
<msg time="2025-05-08T19:15:52.349194" level="INFO">日志文件已保存至: /Users/zzy/hope/rpa/wechat_applescript_log.txt</msg>
<arg>日志文件已保存至: ${log_path}</arg>
<doc>Logs the given message with the given level.</doc>
<status status="PASS" start="2025-05-08T19:15:52.349046" elapsed="0.000217"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>\n日志文件已保存至: ${log_path}</arg>
<doc>Logs the given message to the console.</doc>
<status status="PASS" start="2025-05-08T19:15:52.349469" elapsed="0.000236"/>
</kw>
<status status="PASS" start="2025-05-08T19:15:52.342765" elapsed="0.007021"/>
</kw>
<status status="PASS" start="2025-05-08T19:15:41.195746" elapsed="11.154213"/>
</test>
<doc>微信完整自动化流程 (AppleScript版本)
自动搜索联系人并发送消息</doc>
<status status="PASS" start="2025-05-08T19:15:41.130803" elapsed="11.219790"/>
</suite>
<statistics>
<total>
<stat pass="1" fail="0" skip="0">All Tasks</stat>
</total>
<tag>
</tag>
<suite>
<stat name="Wechat Applescript Workflow" id="s1" pass="1" fail="0" skip="0">Wechat Applescript Workflow</stat>
</suite>
</statistics>
<errors>
</errors>
</robot>
