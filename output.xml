<?xml version="1.0" encoding="UTF-8"?>
<robot generator="Robot 7.2.2 (Python 3.13.2 on darwin)" generated="2025-05-08T19:11:08.658338" rpa="true" schemaversion="5">
<suite id="s1" name="Wechat Applescript Workflow" source="/Users/zzy/hope/rpa/wechat_applescript_workflow.robot">
<test id="s1-t1" name="完整微信AppleScript自动化工作流" line="18">
<kw name="创建日志文件">
<kw name="Get Current Date" owner="DateTime">
<msg time="2025-05-08T19:11:08.722799" level="INFO">${timestamp} = 2025-05-08 19:11:08</msg>
<var>${timestamp}</var>
<arg>result_format=%Y-%m-%d %H:%M:%S</arg>
<doc>Returns current local or UTC time with an optional increment.</doc>
<status status="PASS" start="2025-05-08T19:11:08.722475" elapsed="0.000373"/>
</kw>
<kw name="Create File" owner="OperatingSystem">
<msg time="2025-05-08T19:11:08.723458" level="INFO" html="true">Created file '&lt;a href="file:///Users/zzy/hope/rpa/wechat_applescript_log.txt"&gt;/Users/zzy/hope/rpa/wechat_applescript_log.txt&lt;/a&gt;'.</msg>
<arg>${LOG_FILE}</arg>
<doc>Creates a file with the given content and encoding.</doc>
<status status="PASS" start="2025-05-08T19:11:08.723011" elapsed="0.000529"/>
</kw>
<status status="PASS" start="2025-05-08T19:11:08.721658" elapsed="0.001985"/>
</kw>
<kw name="检查并安装依赖">
<kw name="记录日志">
<kw name="Get Current Date" owner="DateTime">
<msg time="2025-05-08T19:11:08.725024" level="INFO">${timestamp} = 2025-05-08 19:11:08</msg>
<var>${timestamp}</var>
<arg>result_format=%Y-%m-%d %H:%M:%S</arg>
<doc>Returns current local or UTC time with an optional increment.</doc>
<status status="PASS" start="2025-05-08T19:11:08.724777" elapsed="0.000291"/>
</kw>
<kw name="Catenate" owner="BuiltIn">
<msg time="2025-05-08T19:11:08.725475" level="INFO">${log_entry} = [2025-05-08 19:11:08] 检查自动化依赖工具</msg>
<var>${log_entry}</var>
<arg>SEPARATOR=\n</arg>
<arg>[${timestamp}] ${message}</arg>
<doc>Catenates the given items together and returns the resulted string.</doc>
<status status="PASS" start="2025-05-08T19:11:08.725197" elapsed="0.000321"/>
</kw>
<kw name="Append To File" owner="OperatingSystem">
<msg time="2025-05-08T19:11:08.726121" level="INFO" html="true">Appended to file '&lt;a href="file:///Users/zzy/hope/rpa/wechat_applescript_log.txt"&gt;/Users/zzy/hope/rpa/wechat_applescript_log.txt&lt;/a&gt;'.</msg>
<arg>${LOG_FILE}</arg>
<arg>${log_entry}\n</arg>
<doc>Appends the given content to the specified file.</doc>
<status status="PASS" start="2025-05-08T19:11:08.725646" elapsed="0.000555"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>${log_entry}</arg>
<doc>Logs the given message to the console.</doc>
<status status="PASS" start="2025-05-08T19:11:08.726337" elapsed="0.000210"/>
</kw>
<arg>检查自动化依赖工具</arg>
<status status="PASS" start="2025-05-08T19:11:08.724487" elapsed="0.002145"/>
</kw>
<kw name="Run Process" owner="Process">
<msg time="2025-05-08T19:11:08.726984" level="INFO">Starting process:
which cliclick</msg>
<msg time="2025-05-08T19:11:08.732771" level="INFO">Waiting for process to complete.</msg>
<msg time="2025-05-08T19:11:08.742870" level="INFO">Process completed.</msg>
<msg time="2025-05-08T19:11:08.743276" level="INFO">${cliclick_installed} = &lt;result object with rc 0&gt;</msg>
<var>${cliclick_installed}</var>
<arg>which cliclick</arg>
<arg>shell=True</arg>
<arg>stderr=STDOUT</arg>
<doc>Runs a process and waits for it to complete.</doc>
<status status="PASS" start="2025-05-08T19:11:08.726761" elapsed="0.016563"/>
</kw>
<kw name="Run Keyword And Return Status" owner="BuiltIn">
<kw name="Should Not Be Empty" owner="BuiltIn">
<msg time="2025-05-08T19:11:08.745181" level="INFO">Length is 23.</msg>
<arg>${cliclick_installed.stdout}</arg>
<doc>Verifies that the given item is not empty.</doc>
<status status="PASS" start="2025-05-08T19:11:08.744272" elapsed="0.000978"/>
</kw>
<msg time="2025-05-08T19:11:08.745365" level="INFO">${has_cliclick} = True</msg>
<var>${has_cliclick}</var>
<arg>Should Not Be Empty</arg>
<arg>${cliclick_installed.stdout}</arg>
<doc>Runs the given keyword with given arguments and returns the status as a Boolean value.</doc>
<status status="PASS" start="2025-05-08T19:11:08.743847" elapsed="0.001550"/>
</kw>
<if>
<branch type="IF" condition="not ${has_cliclick}">
<kw name="记录日志">
<arg>cliclick未安装，推荐使用Homebrew安装此工具以提高鼠标操作的可靠性</arg>
<status status="NOT RUN" start="2025-05-08T19:11:08.746012" elapsed="0.000034"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>\n推荐安装cliclick工具以提高脚本可靠性: brew install cliclick\n</arg>
<doc>Logs the given message to the console.</doc>
<status status="NOT RUN" start="2025-05-08T19:11:08.746177" elapsed="0.000027"/>
</kw>
<status status="NOT RUN" start="2025-05-08T19:11:08.745607" elapsed="0.000637"/>
</branch>
<branch type="ELSE">
<kw name="记录日志">
<kw name="Get Current Date" owner="DateTime">
<msg time="2025-05-08T19:11:08.747137" level="INFO">${timestamp} = 2025-05-08 19:11:08</msg>
<var>${timestamp}</var>
<arg>result_format=%Y-%m-%d %H:%M:%S</arg>
<doc>Returns current local or UTC time with an optional increment.</doc>
<status status="PASS" start="2025-05-08T19:11:08.746842" elapsed="0.000330"/>
</kw>
<kw name="Catenate" owner="BuiltIn">
<msg time="2025-05-08T19:11:08.747558" level="INFO">${log_entry} = [2025-05-08 19:11:08] 已安装cliclick工具，可用于备选鼠标操作方案</msg>
<var>${log_entry}</var>
<arg>SEPARATOR=\n</arg>
<arg>[${timestamp}] ${message}</arg>
<doc>Catenates the given items together and returns the resulted string.</doc>
<status status="PASS" start="2025-05-08T19:11:08.747299" elapsed="0.000295"/>
</kw>
<kw name="Append To File" owner="OperatingSystem">
<msg time="2025-05-08T19:11:08.748186" level="INFO" html="true">Appended to file '&lt;a href="file:///Users/zzy/hope/rpa/wechat_applescript_log.txt"&gt;/Users/zzy/hope/rpa/wechat_applescript_log.txt&lt;/a&gt;'.</msg>
<arg>${LOG_FILE}</arg>
<arg>${log_entry}\n</arg>
<doc>Appends the given content to the specified file.</doc>
<status status="PASS" start="2025-05-08T19:11:08.747721" elapsed="0.000538"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>${log_entry}</arg>
<doc>Logs the given message to the console.</doc>
<status status="PASS" start="2025-05-08T19:11:08.748382" elapsed="0.000270"/>
</kw>
<arg>已安装cliclick工具，可用于备选鼠标操作方案</arg>
<status status="PASS" start="2025-05-08T19:11:08.746446" elapsed="0.002311"/>
</kw>
<status status="PASS" start="2025-05-08T19:11:08.746291" elapsed="0.002511"/>
</branch>
<status status="PASS" start="2025-05-08T19:11:08.745526" elapsed="0.003321"/>
</if>
<kw name="Run Keyword And Return Status" owner="BuiltIn">
<kw name="File Should Exist" owner="OperatingSystem">
<msg time="2025-05-08T19:11:08.749408" level="INFO" html="true">File '&lt;a href="file:///Users/zzy/hope/rpa/scripts/wechat/activate_wechat.applescript"&gt;/Users/zzy/hope/rpa/scripts/wechat/activate_wechat.applescript&lt;/a&gt;' exists.</msg>
<arg>${SCRIPTS_DIR}/activate_wechat.applescript</arg>
<doc>Fails unless the given ``path`` points to an existing file.</doc>
<status status="PASS" start="2025-05-08T19:11:08.749192" elapsed="0.000289"/>
</kw>
<msg time="2025-05-08T19:11:08.749583" level="INFO">${activate_script_exists} = True</msg>
<var>${activate_script_exists}</var>
<arg>File Should Exist</arg>
<arg>${SCRIPTS_DIR}/activate_wechat.applescript</arg>
<doc>Runs the given keyword with given arguments and returns the status as a Boolean value.</doc>
<status status="PASS" start="2025-05-08T19:11:08.748994" elapsed="0.000621"/>
</kw>
<kw name="Run Keyword And Return Status" owner="BuiltIn">
<kw name="File Should Exist" owner="OperatingSystem">
<msg time="2025-05-08T19:11:08.750097" level="INFO" html="true">File '&lt;a href="file:///Users/zzy/hope/rpa/scripts/wechat/search_contact.applescript"&gt;/Users/zzy/hope/rpa/scripts/wechat/search_contact.applescript&lt;/a&gt;' exists.</msg>
<arg>${SCRIPTS_DIR}/search_contact.applescript</arg>
<doc>Fails unless the given ``path`` points to an existing file.</doc>
<status status="PASS" start="2025-05-08T19:11:08.749911" elapsed="0.000251"/>
</kw>
<msg time="2025-05-08T19:11:08.750363" level="INFO">${search_script_exists} = True</msg>
<var>${search_script_exists}</var>
<arg>File Should Exist</arg>
<arg>${SCRIPTS_DIR}/search_contact.applescript</arg>
<doc>Runs the given keyword with given arguments and returns the status as a Boolean value.</doc>
<status status="PASS" start="2025-05-08T19:11:08.749750" elapsed="0.000646"/>
</kw>
<kw name="Run Keyword And Return Status" owner="BuiltIn">
<kw name="File Should Exist" owner="OperatingSystem">
<msg time="2025-05-08T19:11:08.750871" level="INFO" html="true">File '&lt;a href="file:///Users/zzy/hope/rpa/scripts/wechat/send_message.applescript"&gt;/Users/zzy/hope/rpa/scripts/wechat/send_message.applescript&lt;/a&gt;' exists.</msg>
<arg>${SCRIPTS_DIR}/send_message.applescript</arg>
<doc>Fails unless the given ``path`` points to an existing file.</doc>
<status status="PASS" start="2025-05-08T19:11:08.750689" elapsed="0.000247"/>
</kw>
<msg time="2025-05-08T19:11:08.751033" level="INFO">${send_script_exists} = True</msg>
<var>${send_script_exists}</var>
<arg>File Should Exist</arg>
<arg>${SCRIPTS_DIR}/send_message.applescript</arg>
<doc>Runs the given keyword with given arguments and returns the status as a Boolean value.</doc>
<status status="PASS" start="2025-05-08T19:11:08.750528" elapsed="0.000535"/>
</kw>
<kw name="Run Keyword And Return Status" owner="BuiltIn">
<kw name="File Should Exist" owner="OperatingSystem">
<msg time="2025-05-08T19:11:08.751539" level="INFO" html="true">File '&lt;a href="file:///Users/zzy/hope/rpa/scripts/wechat/cliclick_focus_send.applescript"&gt;/Users/zzy/hope/rpa/scripts/wechat/cliclick_focus_send.applescript&lt;/a&gt;' exists.</msg>
<arg>${SCRIPTS_DIR}/cliclick_focus_send.applescript</arg>
<doc>Fails unless the given ``path`` points to an existing file.</doc>
<status status="PASS" start="2025-05-08T19:11:08.751359" elapsed="0.000250"/>
</kw>
<msg time="2025-05-08T19:11:08.751706" level="INFO">${cliclick_script_exists} = True</msg>
<var>${cliclick_script_exists}</var>
<arg>File Should Exist</arg>
<arg>${SCRIPTS_DIR}/cliclick_focus_send.applescript</arg>
<doc>Runs the given keyword with given arguments and returns the status as a Boolean value.</doc>
<status status="PASS" start="2025-05-08T19:11:08.751201" elapsed="0.000535"/>
</kw>
<kw name="Evaluate" owner="BuiltIn">
<msg time="2025-05-08T19:11:08.752244" level="INFO">${all_scripts_exist} = True</msg>
<var>${all_scripts_exist}</var>
<arg>${activate_script_exists} and ${search_script_exists} and ${send_script_exists} and ${cliclick_script_exists}</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<status status="PASS" start="2025-05-08T19:11:08.751870" elapsed="0.000408"/>
</kw>
<kw name="Set Variable" owner="BuiltIn">
<msg time="2025-05-08T19:11:08.752591" level="INFO">${scripts_executable} = True</msg>
<var>${scripts_executable}</var>
<arg>${True}</arg>
<doc>Returns the given values which can then be assigned to a variables.</doc>
<status status="PASS" start="2025-05-08T19:11:08.752411" elapsed="0.000211"/>
</kw>
<if>
<branch type="IF" condition="${all_scripts_exist}">
<kw name="Run Process" owner="Process">
<msg time="2025-05-08T19:11:08.753161" level="INFO">Starting process:
test -x /Users/zzy/hope/rpa/scripts/wechat/activate_wechat.applescript &amp;&amp; echo "OK" || echo "NotExecutable"</msg>
<msg time="2025-05-08T19:11:08.760372" level="INFO">Waiting for process to complete.</msg>
<msg time="2025-05-08T19:11:08.767021" level="INFO">Process completed.</msg>
<msg time="2025-05-08T19:11:08.767390" level="INFO">${activate_perm} = &lt;result object with rc 0&gt;</msg>
<var>${activate_perm}</var>
<arg>test -x ${SCRIPTS_DIR}/activate_wechat.applescript &amp;&amp; echo "OK" || echo "NotExecutable"</arg>
<arg>shell=True</arg>
<doc>Runs a process and waits for it to complete.</doc>
<status status="PASS" start="2025-05-08T19:11:08.752906" elapsed="0.014529"/>
</kw>
<kw name="Run Process" owner="Process">
<msg time="2025-05-08T19:11:08.768328" level="INFO">Starting process:
test -x /Users/zzy/hope/rpa/scripts/wechat/search_contact.applescript &amp;&amp; echo "OK" || echo "NotExecutable"</msg>
<msg time="2025-05-08T19:11:08.774400" level="INFO">Waiting for process to complete.</msg>
<msg time="2025-05-08T19:11:08.781188" level="INFO">Process completed.</msg>
<msg time="2025-05-08T19:11:08.781561" level="INFO">${search_perm} = &lt;result object with rc 0&gt;</msg>
<var>${search_perm}</var>
<arg>test -x ${SCRIPTS_DIR}/search_contact.applescript &amp;&amp; echo "OK" || echo "NotExecutable"</arg>
<arg>shell=True</arg>
<doc>Runs a process and waits for it to complete.</doc>
<status status="PASS" start="2025-05-08T19:11:08.767896" elapsed="0.013712"/>
</kw>
<kw name="Run Process" owner="Process">
<msg time="2025-05-08T19:11:08.782861" level="INFO">Starting process:
test -x /Users/zzy/hope/rpa/scripts/wechat/send_message.applescript &amp;&amp; echo "OK" || echo "NotExecutable"</msg>
<msg time="2025-05-08T19:11:08.788185" level="INFO">Waiting for process to complete.</msg>
<msg time="2025-05-08T19:11:08.795486" level="INFO">Process completed.</msg>
<msg time="2025-05-08T19:11:08.795866" level="INFO">${send_perm} = &lt;result object with rc 0&gt;</msg>
<var>${send_perm}</var>
<arg>test -x ${SCRIPTS_DIR}/send_message.applescript &amp;&amp; echo "OK" || echo "NotExecutable"</arg>
<arg>shell=True</arg>
<doc>Runs a process and waits for it to complete.</doc>
<status status="PASS" start="2025-05-08T19:11:08.782215" elapsed="0.013696"/>
</kw>
<kw name="Run Process" owner="Process">
<msg time="2025-05-08T19:11:08.797450" level="INFO">Starting process:
test -x /Users/zzy/hope/rpa/scripts/wechat/cliclick_focus_send.applescript &amp;&amp; echo "OK" || echo "NotExecutable"</msg>
<msg time="2025-05-08T19:11:08.802461" level="INFO">Waiting for process to complete.</msg>
<msg time="2025-05-08T19:11:08.809057" level="INFO">Process completed.</msg>
<msg time="2025-05-08T19:11:08.809452" level="INFO">${cliclick_perm} = &lt;result object with rc 0&gt;</msg>
<var>${cliclick_perm}</var>
<arg>test -x ${SCRIPTS_DIR}/cliclick_focus_send.applescript &amp;&amp; echo "OK" || echo "NotExecutable"</arg>
<arg>shell=True</arg>
<doc>Runs a process and waits for it to complete.</doc>
<status status="PASS" start="2025-05-08T19:11:08.796377" elapsed="0.013124"/>
</kw>
<kw name="Evaluate" owner="BuiltIn">
<msg time="2025-05-08T19:11:08.812609" level="INFO">${scripts_executable} = True</msg>
<var>${scripts_executable}</var>
<arg>"${activate_perm.stdout}" == "OK" and "${search_perm.stdout}" == "OK" and "${send_perm.stdout}" == "OK" and "${cliclick_perm.stdout}" == "OK"</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<status status="PASS" start="2025-05-08T19:11:08.809984" elapsed="0.002667"/>
</kw>
<if>
<branch type="IF" condition="not ${scripts_executable}">
<kw name="记录日志">
<arg>警告: 某些AppleScript文件没有执行权限，尝试添加执行权限</arg>
<status status="NOT RUN" start="2025-05-08T19:11:08.813235" elapsed="0.000041"/>
</kw>
<kw name="Run Process" owner="Process">
<arg>chmod +x ${SCRIPTS_DIR}/*.applescript</arg>
<arg>shell=True</arg>
<doc>Runs a process and waits for it to complete.</doc>
<status status="NOT RUN" start="2025-05-08T19:11:08.813422" elapsed="0.000032"/>
</kw>
<kw name="Set Variable" owner="BuiltIn">
<var>${scripts_executable}</var>
<arg>${True}</arg>
<doc>Returns the given values which can then be assigned to a variables.</doc>
<status status="NOT RUN" start="2025-05-08T19:11:08.813578" elapsed="0.000026"/>
</kw>
<kw name="记录日志">
<arg>已添加执行权限至所有脚本文件</arg>
<status status="NOT RUN" start="2025-05-08T19:11:08.813757" elapsed="0.000032"/>
</kw>
<status status="NOT RUN" start="2025-05-08T19:11:08.812842" elapsed="0.000989"/>
</branch>
<status status="PASS" start="2025-05-08T19:11:08.812775" elapsed="0.001096"/>
</if>
<status status="PASS" start="2025-05-08T19:11:08.752726" elapsed="0.061186"/>
</branch>
<status status="PASS" start="2025-05-08T19:11:08.752696" elapsed="0.061247"/>
</if>
<kw name="Evaluate" owner="BuiltIn">
<msg time="2025-05-08T19:11:08.814363" level="INFO">${scripts_ok} = True</msg>
<var>${scripts_ok}</var>
<arg>${all_scripts_exist} and ${scripts_executable}</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<status status="PASS" start="2025-05-08T19:11:08.814059" elapsed="0.000431"/>
</kw>
<if>
<branch type="IF" condition="not ${scripts_ok}">
<kw name="记录日志">
<arg>错误: 预创建的AppleScript文件不完整或没有执行权限</arg>
<status status="NOT RUN" start="2025-05-08T19:11:08.814824" elapsed="0.000029"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>\n错误: 预创建的AppleScript文件不完整或没有执行权限，请确保所有脚本文件已正确创建在 ${SCRIPTS_DIR} 目录下\n</arg>
<doc>Logs the given message to the console.</doc>
<status status="NOT RUN" start="2025-05-08T19:11:08.814979" elapsed="0.000027"/>
</kw>
<status status="NOT RUN" start="2025-05-08T19:11:08.814588" elapsed="0.000463"/>
</branch>
<branch type="ELSE">
<kw name="记录日志">
<kw name="Get Current Date" owner="DateTime">
<msg time="2025-05-08T19:11:08.815906" level="INFO">${timestamp} = 2025-05-08 19:11:08</msg>
<var>${timestamp}</var>
<arg>result_format=%Y-%m-%d %H:%M:%S</arg>
<doc>Returns current local or UTC time with an optional increment.</doc>
<status status="PASS" start="2025-05-08T19:11:08.815604" elapsed="0.000338"/>
</kw>
<kw name="Catenate" owner="BuiltIn">
<msg time="2025-05-08T19:11:08.816326" level="INFO">${log_entry} = [2025-05-08 19:11:08] 验证完成: 所有预创建的AppleScript文件都已存在且有执行权限</msg>
<var>${log_entry}</var>
<arg>SEPARATOR=\n</arg>
<arg>[${timestamp}] ${message}</arg>
<doc>Catenates the given items together and returns the resulted string.</doc>
<status status="PASS" start="2025-05-08T19:11:08.816074" elapsed="0.000286"/>
</kw>
<kw name="Append To File" owner="OperatingSystem">
<msg time="2025-05-08T19:11:08.816970" level="INFO" html="true">Appended to file '&lt;a href="file:///Users/zzy/hope/rpa/wechat_applescript_log.txt"&gt;/Users/zzy/hope/rpa/wechat_applescript_log.txt&lt;/a&gt;'.</msg>
<arg>${LOG_FILE}</arg>
<arg>${log_entry}\n</arg>
<doc>Appends the given content to the specified file.</doc>
<status status="PASS" start="2025-05-08T19:11:08.816486" elapsed="0.000564"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>${log_entry}</arg>
<doc>Logs the given message to the console.</doc>
<status status="PASS" start="2025-05-08T19:11:08.817175" elapsed="0.000224"/>
</kw>
<arg>验证完成: 所有预创建的AppleScript文件都已存在且有执行权限</arg>
<status status="PASS" start="2025-05-08T19:11:08.815230" elapsed="0.002250"/>
</kw>
<status status="PASS" start="2025-05-08T19:11:08.815086" elapsed="0.002433"/>
</branch>
<status status="PASS" start="2025-05-08T19:11:08.814563" elapsed="0.002988"/>
</if>
<return>
<value>${scripts_ok}</value>
<status status="PASS" start="2025-05-08T19:11:08.817626" elapsed="0.000103"/>
</return>
<msg time="2025-05-08T19:11:08.817905" level="INFO">${scripts_ok} = True</msg>
<var>${scripts_ok}</var>
<status status="PASS" start="2025-05-08T19:11:08.724151" elapsed="0.093786"/>
</kw>
<kw name="Run Keyword If" owner="BuiltIn">
<kw name="执行基于AppleScript的微信自动化">
<kw name="记录日志">
<kw name="Get Current Date" owner="DateTime">
<msg time="2025-05-08T19:11:08.819905" level="INFO">${timestamp} = 2025-05-08 19:11:08</msg>
<var>${timestamp}</var>
<arg>result_format=%Y-%m-%d %H:%M:%S</arg>
<doc>Returns current local or UTC time with an optional increment.</doc>
<status status="PASS" start="2025-05-08T19:11:08.819672" elapsed="0.000269"/>
</kw>
<kw name="Catenate" owner="BuiltIn">
<msg time="2025-05-08T19:11:08.820292" level="INFO">${log_entry} = [2025-05-08 19:11:08] 步骤1: 使用AppleScript激活微信窗口</msg>
<var>${log_entry}</var>
<arg>SEPARATOR=\n</arg>
<arg>[${timestamp}] ${message}</arg>
<doc>Catenates the given items together and returns the resulted string.</doc>
<status status="PASS" start="2025-05-08T19:11:08.820062" elapsed="0.000264"/>
</kw>
<kw name="Append To File" owner="OperatingSystem">
<msg time="2025-05-08T19:11:08.820840" level="INFO" html="true">Appended to file '&lt;a href="file:///Users/zzy/hope/rpa/wechat_applescript_log.txt"&gt;/Users/zzy/hope/rpa/wechat_applescript_log.txt&lt;/a&gt;'.</msg>
<arg>${LOG_FILE}</arg>
<arg>${log_entry}\n</arg>
<doc>Appends the given content to the specified file.</doc>
<status status="PASS" start="2025-05-08T19:11:08.820442" elapsed="0.000469"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>${log_entry}</arg>
<doc>Logs the given message to the console.</doc>
<status status="PASS" start="2025-05-08T19:11:08.821035" elapsed="0.000193"/>
</kw>
<arg>步骤1: 使用AppleScript激活微信窗口</arg>
<status status="PASS" start="2025-05-08T19:11:08.819351" elapsed="0.001950"/>
</kw>
<kw name="记录日志">
<kw name="Get Current Date" owner="DateTime">
<msg time="2025-05-08T19:11:08.821976" level="INFO">${timestamp} = 2025-05-08 19:11:08</msg>
<var>${timestamp}</var>
<arg>result_format=%Y-%m-%d %H:%M:%S</arg>
<doc>Returns current local or UTC time with an optional increment.</doc>
<status status="PASS" start="2025-05-08T19:11:08.821760" elapsed="0.000253"/>
</kw>
<kw name="Catenate" owner="BuiltIn">
<msg time="2025-05-08T19:11:08.822442" level="INFO">${log_entry} = [2025-05-08 19:11:08] 联系人: "文件传输助手"</msg>
<var>${log_entry}</var>
<arg>SEPARATOR=\n</arg>
<arg>[${timestamp}] ${message}</arg>
<doc>Catenates the given items together and returns the resulted string.</doc>
<status status="PASS" start="2025-05-08T19:11:08.822129" elapsed="0.000353"/>
</kw>
<kw name="Append To File" owner="OperatingSystem">
<msg time="2025-05-08T19:11:08.823030" level="INFO" html="true">Appended to file '&lt;a href="file:///Users/zzy/hope/rpa/wechat_applescript_log.txt"&gt;/Users/zzy/hope/rpa/wechat_applescript_log.txt&lt;/a&gt;'.</msg>
<arg>${LOG_FILE}</arg>
<arg>${log_entry}\n</arg>
<doc>Appends the given content to the specified file.</doc>
<status status="PASS" start="2025-05-08T19:11:08.822611" elapsed="0.000551"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>${log_entry}</arg>
<doc>Logs the given message to the console.</doc>
<status status="PASS" start="2025-05-08T19:11:08.823296" elapsed="0.000202"/>
</kw>
<arg>联系人: "${target_contact}"</arg>
<status status="PASS" start="2025-05-08T19:11:08.821453" elapsed="0.002124"/>
</kw>
<kw name="记录日志">
<kw name="Get Current Date" owner="DateTime">
<msg time="2025-05-08T19:11:08.824293" level="INFO">${timestamp} = 2025-05-08 19:11:08</msg>
<var>${timestamp}</var>
<arg>result_format=%Y-%m-%d %H:%M:%S</arg>
<doc>Returns current local or UTC time with an optional increment.</doc>
<status status="PASS" start="2025-05-08T19:11:08.824071" elapsed="0.000262"/>
</kw>
<kw name="Catenate" owner="BuiltIn">
<msg time="2025-05-08T19:11:08.824686" level="INFO">${log_entry} = [2025-05-08 19:11:08] 将发送的消息内容: "你好，这是测试消息270"</msg>
<var>${log_entry}</var>
<arg>SEPARATOR=\n</arg>
<arg>[${timestamp}] ${message}</arg>
<doc>Catenates the given items together and returns the resulted string.</doc>
<status status="PASS" start="2025-05-08T19:11:08.824453" elapsed="0.000267"/>
</kw>
<kw name="Append To File" owner="OperatingSystem">
<msg time="2025-05-08T19:11:08.825203" level="INFO" html="true">Appended to file '&lt;a href="file:///Users/zzy/hope/rpa/wechat_applescript_log.txt"&gt;/Users/zzy/hope/rpa/wechat_applescript_log.txt&lt;/a&gt;'.</msg>
<arg>${LOG_FILE}</arg>
<arg>${log_entry}\n</arg>
<doc>Appends the given content to the specified file.</doc>
<status status="PASS" start="2025-05-08T19:11:08.824836" elapsed="0.000442"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>${log_entry}</arg>
<doc>Logs the given message to the console.</doc>
<status status="PASS" start="2025-05-08T19:11:08.825401" elapsed="0.000192"/>
</kw>
<arg>将发送的消息内容: "${custom_message}"</arg>
<status status="PASS" start="2025-05-08T19:11:08.823738" elapsed="0.001937"/>
</kw>
<kw name="Run Process" owner="Process">
<msg time="2025-05-08T19:11:08.826075" level="INFO">Starting process:
osascript /Users/zzy/hope/rpa/scripts/wechat/activate_wechat.applescript</msg>
<msg time="2025-05-08T19:11:08.832592" level="INFO">Waiting for process to complete.</msg>
<msg time="2025-05-08T19:11:09.046032" level="INFO">Process completed.</msg>
<msg time="2025-05-08T19:11:09.047399" level="INFO">${result1} = &lt;result object with rc 0&gt;</msg>
<var>${result1}</var>
<arg>osascript</arg>
<arg>${SCRIPTS_DIR}/activate_wechat.applescript</arg>
<arg>stderr=STDOUT</arg>
<doc>Runs a process and waits for it to complete.</doc>
<status status="PASS" start="2025-05-08T19:11:08.825792" elapsed="0.221764"/>
</kw>
<kw name="Run Keyword And Return Status" owner="BuiltIn">
<kw name="Should Be Empty" owner="BuiltIn">
<msg time="2025-05-08T19:11:09.049922" level="INFO">Length is 0.</msg>
<arg>${result1.stderr}</arg>
<doc>Verifies that the given item is empty.</doc>
<status status="PASS" start="2025-05-08T19:11:09.048801" elapsed="0.001225"/>
</kw>
<msg time="2025-05-08T19:11:09.050211" level="INFO">${wechat_activated} = True</msg>
<var>${wechat_activated}</var>
<arg>Should Be Empty</arg>
<arg>${result1.stderr}</arg>
<doc>Runs the given keyword with given arguments and returns the status as a Boolean value.</doc>
<status status="PASS" start="2025-05-08T19:11:09.048282" elapsed="0.001979"/>
</kw>
<if>
<branch type="IF" condition="not ${wechat_activated}">
<kw name="记录日志">
<arg>错误: 无法激活微信窗口: ${result1.stderr}</arg>
<status status="NOT RUN" start="2025-05-08T19:11:09.050996" elapsed="0.000038"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>\n错误: 无法激活微信窗口，请确认微信已安装并且可以手动启动\n</arg>
<doc>Logs the given message to the console.</doc>
<status status="NOT RUN" start="2025-05-08T19:11:09.051192" elapsed="0.000032"/>
</kw>
<return>
<value>${False}</value>
<status status="NOT RUN" start="2025-05-08T19:11:09.051303" elapsed="0.000038"/>
</return>
<status status="NOT RUN" start="2025-05-08T19:11:09.050524" elapsed="0.000861"/>
</branch>
<status status="PASS" start="2025-05-08T19:11:09.050455" elapsed="0.000962"/>
</if>
<kw name="记录日志">
<kw name="Get Current Date" owner="DateTime">
<msg time="2025-05-08T19:11:09.053573" level="INFO">${timestamp} = 2025-05-08 19:11:09</msg>
<var>${timestamp}</var>
<arg>result_format=%Y-%m-%d %H:%M:%S</arg>
<doc>Returns current local or UTC time with an optional increment.</doc>
<status status="PASS" start="2025-05-08T19:11:09.052829" elapsed="0.000800"/>
</kw>
<kw name="Catenate" owner="BuiltIn">
<msg time="2025-05-08T19:11:09.054336" level="INFO">${log_entry} = [2025-05-08 19:11:09] AppleScript激活微信窗口结果: </msg>
<var>${log_entry}</var>
<arg>SEPARATOR=\n</arg>
<arg>[${timestamp}] ${message}</arg>
<doc>Catenates the given items together and returns the resulted string.</doc>
<status status="PASS" start="2025-05-08T19:11:09.053904" elapsed="0.000530"/>
</kw>
<kw name="Append To File" owner="OperatingSystem">
<msg time="2025-05-08T19:11:09.055378" level="INFO" html="true">Appended to file '&lt;a href="file:///Users/zzy/hope/rpa/wechat_applescript_log.txt"&gt;/Users/zzy/hope/rpa/wechat_applescript_log.txt&lt;/a&gt;'.</msg>
<arg>${LOG_FILE}</arg>
<arg>${log_entry}\n</arg>
<doc>Appends the given content to the specified file.</doc>
<status status="PASS" start="2025-05-08T19:11:09.054709" elapsed="0.000757"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>${log_entry}</arg>
<doc>Logs the given message to the console.</doc>
<status status="PASS" start="2025-05-08T19:11:09.055618" elapsed="0.000403"/>
</kw>
<arg>AppleScript激活微信窗口结果: ${result1.stdout}</arg>
<status status="PASS" start="2025-05-08T19:11:09.051580" elapsed="0.004596"/>
</kw>
<kw name="Sleep" owner="BuiltIn">
<msg time="2025-05-08T19:11:10.056822" level="INFO">Slept 1 second.</msg>
<arg>1s</arg>
<doc>Pauses the test executed for the given time.</doc>
<status status="PASS" start="2025-05-08T19:11:09.056365" elapsed="1.000564"/>
</kw>
<kw name="记录日志">
<kw name="Get Current Date" owner="DateTime">
<msg time="2025-05-08T19:11:10.057692" level="INFO">${timestamp} = 2025-05-08 19:11:10</msg>
<var>${timestamp}</var>
<arg>result_format=%Y-%m-%d %H:%M:%S</arg>
<doc>Returns current local or UTC time with an optional increment.</doc>
<status status="PASS" start="2025-05-08T19:11:10.057465" elapsed="0.000263"/>
</kw>
<kw name="Catenate" owner="BuiltIn">
<msg time="2025-05-08T19:11:10.058071" level="INFO">${log_entry} = [2025-05-08 19:11:10] 步骤2: 等待窗口激活完成</msg>
<var>${log_entry}</var>
<arg>SEPARATOR=\n</arg>
<arg>[${timestamp}] ${message}</arg>
<doc>Catenates the given items together and returns the resulted string.</doc>
<status status="PASS" start="2025-05-08T19:11:10.057843" elapsed="0.000261"/>
</kw>
<kw name="Append To File" owner="OperatingSystem">
<msg time="2025-05-08T19:11:10.058553" level="INFO" html="true">Appended to file '&lt;a href="file:///Users/zzy/hope/rpa/wechat_applescript_log.txt"&gt;/Users/zzy/hope/rpa/wechat_applescript_log.txt&lt;/a&gt;'.</msg>
<arg>${LOG_FILE}</arg>
<arg>${log_entry}\n</arg>
<doc>Appends the given content to the specified file.</doc>
<status status="PASS" start="2025-05-08T19:11:10.058216" elapsed="0.000403"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>${log_entry}</arg>
<doc>Logs the given message to the console.</doc>
<status status="PASS" start="2025-05-08T19:11:10.058738" elapsed="0.000183"/>
</kw>
<arg>步骤2: 等待窗口激活完成</arg>
<status status="PASS" start="2025-05-08T19:11:10.057132" elapsed="0.001863"/>
</kw>
<kw name="记录日志">
<kw name="Get Current Date" owner="DateTime">
<msg time="2025-05-08T19:11:10.059784" level="INFO">${timestamp} = 2025-05-08 19:11:10</msg>
<var>${timestamp}</var>
<arg>result_format=%Y-%m-%d %H:%M:%S</arg>
<doc>Returns current local or UTC time with an optional increment.</doc>
<status status="PASS" start="2025-05-08T19:11:10.059549" elapsed="0.000268"/>
</kw>
<kw name="Catenate" owner="BuiltIn">
<msg time="2025-05-08T19:11:10.060171" level="INFO">${log_entry} = [2025-05-08 19:11:10] 步骤3: 使用预创建脚本搜索联系人 "文件传输助手"</msg>
<var>${log_entry}</var>
<arg>SEPARATOR=\n</arg>
<arg>[${timestamp}] ${message}</arg>
<doc>Catenates the given items together and returns the resulted string.</doc>
<status status="PASS" start="2025-05-08T19:11:10.059934" elapsed="0.000275"/>
</kw>
<kw name="Append To File" owner="OperatingSystem">
<msg time="2025-05-08T19:11:10.060693" level="INFO" html="true">Appended to file '&lt;a href="file:///Users/zzy/hope/rpa/wechat_applescript_log.txt"&gt;/Users/zzy/hope/rpa/wechat_applescript_log.txt&lt;/a&gt;'.</msg>
<arg>${LOG_FILE}</arg>
<arg>${log_entry}\n</arg>
<doc>Appends the given content to the specified file.</doc>
<status status="PASS" start="2025-05-08T19:11:10.060322" elapsed="0.000456"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>${log_entry}</arg>
<doc>Logs the given message to the console.</doc>
<status status="PASS" start="2025-05-08T19:11:10.060907" elapsed="0.000218"/>
</kw>
<arg>步骤3: 使用预创建脚本搜索联系人 "${target_contact}"</arg>
<status status="PASS" start="2025-05-08T19:11:10.059209" elapsed="0.002106"/>
</kw>
<kw name="Run Process" owner="Process">
<msg time="2025-05-08T19:11:10.061986" level="INFO">Starting process:
osascript /Users/zzy/hope/rpa/scripts/wechat/search_contact.applescript 文件传输助手</msg>
<msg time="2025-05-08T19:11:10.067844" level="INFO">Waiting for process to complete.</msg>
<msg time="2025-05-08T19:11:15.627572" level="INFO">Process completed.</msg>
<msg time="2025-05-08T19:11:15.627994" level="INFO">${result2} = &lt;result object with rc 0&gt;</msg>
<var>${result2}</var>
<arg>osascript</arg>
<arg>${SCRIPTS_DIR}/search_contact.applescript</arg>
<arg>${target_contact}</arg>
<arg>stderr=STDOUT</arg>
<doc>Runs a process and waits for it to complete.</doc>
<status status="PASS" start="2025-05-08T19:11:10.061488" elapsed="5.566560"/>
</kw>
<kw name="Run Keyword And Return Status" owner="BuiltIn">
<kw name="Should Be Empty" owner="BuiltIn">
<msg time="2025-05-08T19:11:15.629851" level="INFO">Length is 0.</msg>
<arg>${result2.stderr}</arg>
<doc>Verifies that the given item is empty.</doc>
<status status="PASS" start="2025-05-08T19:11:15.629085" elapsed="0.000831"/>
</kw>
<msg time="2025-05-08T19:11:15.630133" level="INFO">${contact_found} = True</msg>
<var>${contact_found}</var>
<arg>Should Be Empty</arg>
<arg>${result2.stderr}</arg>
<doc>Runs the given keyword with given arguments and returns the status as a Boolean value.</doc>
<status status="PASS" start="2025-05-08T19:11:15.628634" elapsed="0.001530"/>
</kw>
<if>
<branch type="IF" condition="not ${contact_found}">
<kw name="记录日志">
<arg>错误: 搜索联系人失败: ${result2.stderr}</arg>
<status status="NOT RUN" start="2025-05-08T19:11:15.630689" elapsed="0.000032"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>\n错误: 无法搜索或找到联系人 "${target_contact}"\n</arg>
<doc>Logs the given message to the console.</doc>
<status status="NOT RUN" start="2025-05-08T19:11:15.630847" elapsed="0.000025"/>
</kw>
<return>
<value>${False}</value>
<status status="NOT RUN" start="2025-05-08T19:11:15.630942" elapsed="0.000030"/>
</return>
<status status="NOT RUN" start="2025-05-08T19:11:15.630324" elapsed="0.000693"/>
</branch>
<status status="PASS" start="2025-05-08T19:11:15.630268" elapsed="0.000779"/>
</if>
<kw name="记录日志">
<kw name="Get Current Date" owner="DateTime">
<msg time="2025-05-08T19:11:15.632190" level="INFO">${timestamp} = 2025-05-08 19:11:15</msg>
<var>${timestamp}</var>
<arg>result_format=%Y-%m-%d %H:%M:%S</arg>
<doc>Returns current local or UTC time with an optional increment.</doc>
<status status="PASS" start="2025-05-08T19:11:15.631903" elapsed="0.000324"/>
</kw>
<kw name="Catenate" owner="BuiltIn">
<msg time="2025-05-08T19:11:15.632587" level="INFO">${log_entry} = [2025-05-08 19:11:15] 搜索联系人脚本执行结果: </msg>
<var>${log_entry}</var>
<arg>SEPARATOR=\n</arg>
<arg>[${timestamp}] ${message}</arg>
<doc>Catenates the given items together and returns the resulted string.</doc>
<status status="PASS" start="2025-05-08T19:11:15.632348" elapsed="0.000272"/>
</kw>
<kw name="Append To File" owner="OperatingSystem">
<msg time="2025-05-08T19:11:15.633230" level="INFO" html="true">Appended to file '&lt;a href="file:///Users/zzy/hope/rpa/wechat_applescript_log.txt"&gt;/Users/zzy/hope/rpa/wechat_applescript_log.txt&lt;/a&gt;'.</msg>
<arg>${LOG_FILE}</arg>
<arg>${log_entry}\n</arg>
<doc>Appends the given content to the specified file.</doc>
<status status="PASS" start="2025-05-08T19:11:15.632740" elapsed="0.000565"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>${log_entry}</arg>
<doc>Logs the given message to the console.</doc>
<status status="PASS" start="2025-05-08T19:11:15.633429" elapsed="0.000211"/>
</kw>
<arg>搜索联系人脚本执行结果: ${result2.stdout}</arg>
<status status="PASS" start="2025-05-08T19:11:15.631186" elapsed="0.002530"/>
</kw>
<kw name="Sleep" owner="BuiltIn">
<msg time="2025-05-08T19:11:15.734331" level="INFO">Slept 100 milliseconds.</msg>
<arg>0.1s</arg>
<doc>Pauses the test executed for the given time.</doc>
<status status="PASS" start="2025-05-08T19:11:15.633830" elapsed="0.100631"/>
</kw>
<kw name="记录日志">
<kw name="Get Current Date" owner="DateTime">
<msg time="2025-05-08T19:11:15.735300" level="INFO">${timestamp} = 2025-05-08 19:11:15</msg>
<var>${timestamp}</var>
<arg>result_format=%Y-%m-%d %H:%M:%S</arg>
<doc>Returns current local or UTC time with an optional increment.</doc>
<status status="PASS" start="2025-05-08T19:11:15.735049" elapsed="0.000288"/>
</kw>
<kw name="Catenate" owner="BuiltIn">
<msg time="2025-05-08T19:11:15.735713" level="INFO">${log_entry} = [2025-05-08 19:11:15] 步骤4: 聊天窗口已加载，准备输入消息</msg>
<var>${log_entry}</var>
<arg>SEPARATOR=\n</arg>
<arg>[${timestamp}] ${message}</arg>
<doc>Catenates the given items together and returns the resulted string.</doc>
<status status="PASS" start="2025-05-08T19:11:15.735475" elapsed="0.000273"/>
</kw>
<kw name="Append To File" owner="OperatingSystem">
<msg time="2025-05-08T19:11:15.736390" level="INFO" html="true">Appended to file '&lt;a href="file:///Users/zzy/hope/rpa/wechat_applescript_log.txt"&gt;/Users/zzy/hope/rpa/wechat_applescript_log.txt&lt;/a&gt;'.</msg>
<arg>${LOG_FILE}</arg>
<arg>${log_entry}\n</arg>
<doc>Appends the given content to the specified file.</doc>
<status status="PASS" start="2025-05-08T19:11:15.735868" elapsed="0.000606"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>${log_entry}</arg>
<doc>Logs the given message to the console.</doc>
<status status="PASS" start="2025-05-08T19:11:15.736617" elapsed="0.000213"/>
</kw>
<arg>步骤4: 聊天窗口已加载，准备输入消息</arg>
<status status="PASS" start="2025-05-08T19:11:15.734684" elapsed="0.002279"/>
</kw>
<kw name="记录日志">
<kw name="Get Current Date" owner="DateTime">
<msg time="2025-05-08T19:11:15.737820" level="INFO">${timestamp} = 2025-05-08 19:11:15</msg>
<var>${timestamp}</var>
<arg>result_format=%Y-%m-%d %H:%M:%S</arg>
<doc>Returns current local or UTC time with an optional increment.</doc>
<status status="PASS" start="2025-05-08T19:11:15.737490" elapsed="0.000378"/>
</kw>
<kw name="Catenate" owner="BuiltIn">
<msg time="2025-05-08T19:11:15.738266" level="INFO">${log_entry} = [2025-05-08 19:11:15] 检查是否可以使用cliclick工具</msg>
<var>${log_entry}</var>
<arg>SEPARATOR=\n</arg>
<arg>[${timestamp}] ${message}</arg>
<doc>Catenates the given items together and returns the resulted string.</doc>
<status status="PASS" start="2025-05-08T19:11:15.738007" elapsed="0.000298"/>
</kw>
<kw name="Append To File" owner="OperatingSystem">
<msg time="2025-05-08T19:11:15.738854" level="INFO" html="true">Appended to file '&lt;a href="file:///Users/zzy/hope/rpa/wechat_applescript_log.txt"&gt;/Users/zzy/hope/rpa/wechat_applescript_log.txt&lt;/a&gt;'.</msg>
<arg>${LOG_FILE}</arg>
<arg>${log_entry}\n</arg>
<doc>Appends the given content to the specified file.</doc>
<status status="PASS" start="2025-05-08T19:11:15.738430" elapsed="0.000499"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>${log_entry}</arg>
<doc>Logs the given message to the console.</doc>
<status status="PASS" start="2025-05-08T19:11:15.739073" elapsed="0.000202"/>
</kw>
<arg>检查是否可以使用cliclick工具</arg>
<status status="PASS" start="2025-05-08T19:11:15.737157" elapsed="0.002219"/>
</kw>
<kw name="Run Process" owner="Process">
<msg time="2025-05-08T19:11:15.739880" level="INFO">Starting process:
which cliclick</msg>
<msg time="2025-05-08T19:11:15.745475" level="INFO">Waiting for process to complete.</msg>
<msg time="2025-05-08T19:11:15.756302" level="INFO">Process completed.</msg>
<msg time="2025-05-08T19:11:15.756721" level="INFO">${cliclick_check} = &lt;result object with rc 0&gt;</msg>
<var>${cliclick_check}</var>
<arg>which cliclick</arg>
<arg>shell=true</arg>
<doc>Runs a process and waits for it to complete.</doc>
<status status="PASS" start="2025-05-08T19:11:15.739619" elapsed="0.017156"/>
</kw>
<kw name="Run Keyword And Return Status" owner="BuiltIn">
<kw name="Should Not Be Empty" owner="BuiltIn">
<msg time="2025-05-08T19:11:15.758795" level="INFO">Length is 23.</msg>
<arg>${cliclick_check.stdout}</arg>
<doc>Verifies that the given item is not empty.</doc>
<status status="PASS" start="2025-05-08T19:11:15.757799" elapsed="0.001083"/>
</kw>
<msg time="2025-05-08T19:11:15.759010" level="INFO">${has_cliclick} = True</msg>
<var>${has_cliclick}</var>
<arg>Should Not Be Empty</arg>
<arg>${cliclick_check.stdout}</arg>
<doc>Runs the given keyword with given arguments and returns the status as a Boolean value.</doc>
<status status="PASS" start="2025-05-08T19:11:15.757290" elapsed="0.001756"/>
</kw>
<kw name="Set Variable" owner="BuiltIn">
<msg time="2025-05-08T19:11:15.759451" level="INFO">${send_success} = False</msg>
<var>${send_success}</var>
<arg>${False}</arg>
<doc>Returns the given values which can then be assigned to a variables.</doc>
<status status="PASS" start="2025-05-08T19:11:15.759215" elapsed="0.000272"/>
</kw>
<if>
<branch type="IF" condition="${has_cliclick}">
<kw name="记录日志">
<kw name="Get Current Date" owner="DateTime">
<msg time="2025-05-08T19:11:15.760780" level="INFO">${timestamp} = 2025-05-08 19:11:15</msg>
<var>${timestamp}</var>
<arg>result_format=%Y-%m-%d %H:%M:%S</arg>
<doc>Returns current local or UTC time with an optional increment.</doc>
<status status="PASS" start="2025-05-08T19:11:15.760454" elapsed="0.000479"/>
</kw>
<kw name="Catenate" owner="BuiltIn">
<msg time="2025-05-08T19:11:15.761379" level="INFO">${log_entry} = [2025-05-08 19:11:15] 找到cliclick工具，使用增强型cliclick专用脚本发送消息 (使用多种获取焦点方法)</msg>
<var>${log_entry}</var>
<arg>SEPARATOR=\n</arg>
<arg>[${timestamp}] ${message}</arg>
<doc>Catenates the given items together and returns the resulted string.</doc>
<status status="PASS" start="2025-05-08T19:11:15.761085" elapsed="0.000333"/>
</kw>
<kw name="Append To File" owner="OperatingSystem">
<msg time="2025-05-08T19:11:15.762097" level="INFO" html="true">Appended to file '&lt;a href="file:///Users/zzy/hope/rpa/wechat_applescript_log.txt"&gt;/Users/zzy/hope/rpa/wechat_applescript_log.txt&lt;/a&gt;'.</msg>
<arg>${LOG_FILE}</arg>
<arg>${log_entry}\n</arg>
<doc>Appends the given content to the specified file.</doc>
<status status="PASS" start="2025-05-08T19:11:15.761560" elapsed="0.000622"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>${log_entry}</arg>
<doc>Logs the given message to the console.</doc>
<status status="PASS" start="2025-05-08T19:11:15.762339" elapsed="0.000251"/>
</kw>
<arg>找到cliclick工具，使用增强型cliclick专用脚本发送消息 (使用多种获取焦点方法)</arg>
<status status="PASS" start="2025-05-08T19:11:15.760031" elapsed="0.002654"/>
</kw>
<kw name="记录日志">
<kw name="Get Current Date" owner="DateTime">
<msg time="2025-05-08T19:11:15.763437" level="INFO">${timestamp} = 2025-05-08 19:11:15</msg>
<var>${timestamp}</var>
<arg>result_format=%Y-%m-%d %H:%M:%S</arg>
<doc>Returns current local or UTC time with an optional increment.</doc>
<status status="PASS" start="2025-05-08T19:11:15.763190" elapsed="0.000287"/>
</kw>
<kw name="Catenate" owner="BuiltIn">
<msg time="2025-05-08T19:11:15.763878" level="INFO">${log_entry} = [2025-05-08 19:11:15] 执行增强型焦点获取脚本 (使用多种点击方法和位置，模拟更真实的用户行为)</msg>
<var>${log_entry}</var>
<arg>SEPARATOR=\n</arg>
<arg>[${timestamp}] ${message}</arg>
<doc>Catenates the given items together and returns the resulted string.</doc>
<status status="PASS" start="2025-05-08T19:11:15.763619" elapsed="0.000297"/>
</kw>
<kw name="Append To File" owner="OperatingSystem">
<msg time="2025-05-08T19:11:15.764488" level="INFO" html="true">Appended to file '&lt;a href="file:///Users/zzy/hope/rpa/wechat_applescript_log.txt"&gt;/Users/zzy/hope/rpa/wechat_applescript_log.txt&lt;/a&gt;'.</msg>
<arg>${LOG_FILE}</arg>
<arg>${log_entry}\n</arg>
<doc>Appends the given content to the specified file.</doc>
<status status="PASS" start="2025-05-08T19:11:15.764053" elapsed="0.000513"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>${log_entry}</arg>
<doc>Logs the given message to the console.</doc>
<status status="PASS" start="2025-05-08T19:11:15.764704" elapsed="0.000209"/>
</kw>
<arg>执行增强型焦点获取脚本 (使用多种点击方法和位置，模拟更真实的用户行为)</arg>
<status status="PASS" start="2025-05-08T19:11:15.762873" elapsed="0.002125"/>
</kw>
<kw name="Run Process" owner="Process">
<msg time="2025-05-08T19:11:15.765496" level="INFO">Starting process:
osascript /Users/zzy/hope/rpa/scripts/wechat/cliclick_focus_send.applescript 你好，这是测试消息270</msg>
<msg time="2025-05-08T19:11:15.772895" level="INFO">Waiting for process to complete.</msg>
<msg time="2025-05-08T19:11:19.784976" level="INFO">Process completed.</msg>
<msg time="2025-05-08T19:11:19.785374" level="INFO">${result3} = &lt;result object with rc 0&gt;</msg>
<var>${result3}</var>
<arg>osascript</arg>
<arg>${SCRIPTS_DIR}/cliclick_focus_send.applescript</arg>
<arg>${custom_message}</arg>
<arg>stderr=STDOUT</arg>
<doc>Runs a process and waits for it to complete.</doc>
<status status="PASS" start="2025-05-08T19:11:15.765144" elapsed="4.020278"/>
</kw>
<kw name="Run Keyword And Return Status" owner="BuiltIn">
<kw name="Should Be Empty" owner="BuiltIn">
<msg time="2025-05-08T19:11:19.787323" level="INFO">Length is 0.</msg>
<arg>${result3.stderr}</arg>
<doc>Verifies that the given item is empty.</doc>
<status status="PASS" start="2025-05-08T19:11:19.786517" elapsed="0.000877"/>
</kw>
<msg time="2025-05-08T19:11:19.787510" level="INFO">${send_success} = True</msg>
<var>${send_success}</var>
<arg>Should Be Empty</arg>
<arg>${result3.stderr}</arg>
<doc>Runs the given keyword with given arguments and returns the status as a Boolean value.</doc>
<status status="PASS" start="2025-05-08T19:11:19.786077" elapsed="0.001464"/>
</kw>
<kw name="记录日志">
<kw name="Get Current Date" owner="DateTime">
<msg time="2025-05-08T19:11:19.793886" level="INFO">${timestamp} = 2025-05-08 19:11:19</msg>
<var>${timestamp}</var>
<arg>result_format=%Y-%m-%d %H:%M:%S</arg>
<doc>Returns current local or UTC time with an optional increment.</doc>
<status status="PASS" start="2025-05-08T19:11:19.793568" elapsed="0.000356"/>
</kw>
<kw name="Catenate" owner="BuiltIn">
<msg time="2025-05-08T19:11:19.794313" level="INFO">${log_entry} = [2025-05-08 19:11:19] cliclick专用脚本执行结果: === 脚本开始执行时间: 19:11:15 ===
目标应用: 企业微信 (进程名: 企业微信)
=== 脚本执行统计 ===
目标应用: 企业微信
开始时间: 19:11:15
结束时间: 19:11:19
总执行时间: 0分 4秒 (共4秒)
==================</msg>
<var>${log_entry}</var>
<arg>SEPARATOR=\n</arg>
<arg>[${timestamp}] ${message}</arg>
<doc>Catenates the given items together and returns the resulted string.</doc>
<status status="PASS" start="2025-05-08T19:11:19.794050" elapsed="0.000301"/>
</kw>
<kw name="Append To File" owner="OperatingSystem">
<msg time="2025-05-08T19:11:19.794982" level="INFO" html="true">Appended to file '&lt;a href="file:///Users/zzy/hope/rpa/wechat_applescript_log.txt"&gt;/Users/zzy/hope/rpa/wechat_applescript_log.txt&lt;/a&gt;'.</msg>
<arg>${LOG_FILE}</arg>
<arg>${log_entry}\n</arg>
<doc>Appends the given content to the specified file.</doc>
<status status="PASS" start="2025-05-08T19:11:19.794471" elapsed="0.000583"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>${log_entry}</arg>
<doc>Logs the given message to the console.</doc>
<status status="PASS" start="2025-05-08T19:11:19.795182" elapsed="0.000227"/>
</kw>
<arg>cliclick专用脚本执行结果: ${result3.stdout}</arg>
<status status="PASS" start="2025-05-08T19:11:19.787833" elapsed="0.007661"/>
</kw>
<if>
<branch type="IF" condition="${send_success}">
<kw name="记录日志">
<kw name="Get Current Date" owner="DateTime">
<msg time="2025-05-08T19:11:19.796349" level="INFO">${timestamp} = 2025-05-08 19:11:19</msg>
<var>${timestamp}</var>
<arg>result_format=%Y-%m-%d %H:%M:%S</arg>
<doc>Returns current local or UTC time with an optional increment.</doc>
<status status="PASS" start="2025-05-08T19:11:19.796137" elapsed="0.000247"/>
</kw>
<kw name="Catenate" owner="BuiltIn">
<msg time="2025-05-08T19:11:19.796730" level="INFO">${log_entry} = [2025-05-08 19:11:19] 使用增强型cliclick获取焦点机制后通过AppleScript完成消息发送</msg>
<var>${log_entry}</var>
<arg>SEPARATOR=\n</arg>
<arg>[${timestamp}] ${message}</arg>
<doc>Catenates the given items together and returns the resulted string.</doc>
<status status="PASS" start="2025-05-08T19:11:19.796501" elapsed="0.000264"/>
</kw>
<kw name="Append To File" owner="OperatingSystem">
<msg time="2025-05-08T19:11:19.797236" level="INFO" html="true">Appended to file '&lt;a href="file:///Users/zzy/hope/rpa/wechat_applescript_log.txt"&gt;/Users/zzy/hope/rpa/wechat_applescript_log.txt&lt;/a&gt;'.</msg>
<arg>${LOG_FILE}</arg>
<arg>${log_entry}\n</arg>
<doc>Appends the given content to the specified file.</doc>
<status status="PASS" start="2025-05-08T19:11:19.796887" elapsed="0.000418"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>${log_entry}</arg>
<doc>Logs the given message to the console.</doc>
<status status="PASS" start="2025-05-08T19:11:19.797427" elapsed="0.000183"/>
</kw>
<arg>使用增强型cliclick获取焦点机制后通过AppleScript完成消息发送</arg>
<status status="PASS" start="2025-05-08T19:11:19.795842" elapsed="0.001912"/>
</kw>
<return>
<value>${True}</value>
<status status="PASS" start="2025-05-08T19:11:19.797823" elapsed="0.000090"/>
</return>
<status status="PASS" start="2025-05-08T19:11:19.795626" elapsed="0.002343"/>
</branch>
<branch type="ELSE">
<kw name="记录日志">
<arg>警告: 增强型cliclick脚本执行出现错误: ${result3.stderr}</arg>
<status status="NOT RUN" start="2025-05-08T19:11:19.798166" elapsed="0.000030"/>
</kw>
<kw name="记录日志">
<arg>尝试使用纯AppleScript方案作为备选</arg>
<status status="NOT RUN" start="2025-05-08T19:11:19.798334" elapsed="0.000028"/>
</kw>
<status status="NOT RUN" start="2025-05-08T19:11:19.798008" elapsed="0.000391"/>
</branch>
<status status="PASS" start="2025-05-08T19:11:19.795580" elapsed="0.002850"/>
</if>
<status status="PASS" start="2025-05-08T19:11:15.759670" elapsed="4.038816"/>
</branch>
<branch type="ELSE">
<kw name="记录日志">
<arg>未找到cliclick工具，使用纯AppleScript方案</arg>
<status status="NOT RUN" start="2025-05-08T19:11:19.798653" elapsed="0.000027"/>
</kw>
<status status="NOT RUN" start="2025-05-08T19:11:19.798520" elapsed="0.000199"/>
</branch>
<status status="PASS" start="2025-05-08T19:11:15.759603" elapsed="4.039145"/>
</if>
<kw name="记录日志">
<arg>尝试使用纯AppleScript方案发送消息</arg>
<status status="NOT RUN" start="2025-05-08T19:11:19.798882" elapsed="0.000028"/>
</kw>
<kw name="Run Process" owner="Process">
<var>${result4}</var>
<arg>osascript</arg>
<arg>${SCRIPTS_DIR}/send_message.applescript</arg>
<arg>${custom_message}</arg>
<arg>stderr=STDOUT</arg>
<doc>Runs a process and waits for it to complete.</doc>
<status status="NOT RUN" start="2025-05-08T19:11:19.799028" elapsed="0.000025"/>
</kw>
<kw name="Run Keyword And Return Status" owner="BuiltIn">
<var>${send_success}</var>
<arg>Should Be Empty</arg>
<arg>${result4.stderr}</arg>
<doc>Runs the given keyword with given arguments and returns the status as a Boolean value.</doc>
<status status="NOT RUN" start="2025-05-08T19:11:19.799179" elapsed="0.000025"/>
</kw>
<if>
<branch type="IF" condition="${send_success}">
<kw name="记录日志">
<arg>纯AppleScript消息发送脚本执行结果: ${result4.stdout}</arg>
<status status="NOT RUN" start="2025-05-08T19:11:19.799446" elapsed="0.000026"/>
</kw>
<kw name="记录日志">
<arg>消息发送完成</arg>
<status status="NOT RUN" start="2025-05-08T19:11:19.799603" elapsed="0.000026"/>
</kw>
<return>
<value>${True}</value>
<status status="NOT RUN" start="2025-05-08T19:11:19.799675" elapsed="0.000020"/>
</return>
<status status="NOT RUN" start="2025-05-08T19:11:19.799291" elapsed="0.000443"/>
</branch>
<branch type="ELSE">
<kw name="记录日志">
<arg>错误: 所有消息发送方法都失败: ${result4.stderr}</arg>
<status status="NOT RUN" start="2025-05-08T19:11:19.799886" elapsed="0.000026"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>\n错误: 无法发送消息，请检查微信窗口状态\n</arg>
<doc>Logs the given message to the console.</doc>
<status status="NOT RUN" start="2025-05-08T19:11:19.800015" elapsed="0.000025"/>
</kw>
<kw name="记录日志">
<arg>提示: 如果消息能发送但内容不显示，可能是焦点问题，尝试以下解决方法:</arg>
<status status="NOT RUN" start="2025-05-08T19:11:19.800169" elapsed="0.000025"/>
</kw>
<kw name="记录日志">
<arg>1. 确保微信窗口处于前台活动状态</arg>
<status status="NOT RUN" start="2025-05-08T19:11:19.800314" elapsed="0.000025"/>
</kw>
<kw name="记录日志">
<arg>2. 检查屏幕分辨率与脚本中的点击坐标匹配</arg>
<status status="NOT RUN" start="2025-05-08T19:11:19.800459" elapsed="0.000025"/>
</kw>
<kw name="记录日志">
<arg>3. 尝试使用较慢的执行速度 (使用 --variable SLOW:True 参数运行)</arg>
<status status="NOT RUN" start="2025-05-08T19:11:19.800602" elapsed="0.000024"/>
</kw>
<kw name="记录日志">
<arg>4. 手动编辑cliclick_focus_send.applescript，调整点击坐标</arg>
<status status="NOT RUN" start="2025-05-08T19:11:19.800742" elapsed="0.000024"/>
</kw>
<return>
<value>${False}</value>
<status status="NOT RUN" start="2025-05-08T19:11:19.800810" elapsed="0.000020"/>
</return>
<status status="NOT RUN" start="2025-05-08T19:11:19.799763" elapsed="0.001101"/>
</branch>
<status status="NOT RUN" start="2025-05-08T19:11:19.799268" elapsed="0.001621"/>
</if>
<arg>${CONTACT}</arg>
<arg>${MESSAGE}</arg>
<status status="PASS" start="2025-05-08T19:11:08.818911" elapsed="10.982114"/>
</kw>
<arg>${scripts_ok}</arg>
<arg>执行基于AppleScript的微信自动化</arg>
<arg>${CONTACT}</arg>
<arg>${MESSAGE}</arg>
<arg>ELSE</arg>
<arg>Log To Console</arg>
<arg>\n无法执行自动化：预创建的脚本文件缺失或无执行权限\n</arg>
<doc>Runs the given keyword with the given arguments, if ``condition`` is true.</doc>
<status status="PASS" start="2025-05-08T19:11:08.818169" elapsed="10.982921"/>
</kw>
<kw name="记录完成信息">
<kw name="Get Current Date" owner="DateTime">
<msg time="2025-05-08T19:11:19.801814" level="INFO">${timestamp} = 2025-05-08 19:11:19</msg>
<var>${timestamp}</var>
<arg>result_format=%Y-%m-%d %H:%M:%S</arg>
<doc>Returns current local or UTC time with an optional increment.</doc>
<status status="PASS" start="2025-05-08T19:11:19.801592" elapsed="0.000255"/>
</kw>
<kw name="记录日志">
<kw name="Get Current Date" owner="DateTime">
<msg time="2025-05-08T19:11:19.802614" level="INFO">${timestamp} = 2025-05-08 19:11:19</msg>
<var>${timestamp}</var>
<arg>result_format=%Y-%m-%d %H:%M:%S</arg>
<doc>Returns current local or UTC time with an optional increment.</doc>
<status status="PASS" start="2025-05-08T19:11:19.802398" elapsed="0.000250"/>
</kw>
<kw name="Catenate" owner="BuiltIn">
<msg time="2025-05-08T19:11:19.803076" level="INFO">${log_entry} = [2025-05-08 19:11:19] 自动化流程完成。结束时间: 2025-05-08 19:11:19</msg>
<var>${log_entry}</var>
<arg>SEPARATOR=\n</arg>
<arg>[${timestamp}] ${message}</arg>
<doc>Catenates the given items together and returns the resulted string.</doc>
<status status="PASS" start="2025-05-08T19:11:19.802825" elapsed="0.000288"/>
</kw>
<kw name="Append To File" owner="OperatingSystem">
<msg time="2025-05-08T19:11:19.803659" level="INFO" html="true">Appended to file '&lt;a href="file:///Users/zzy/hope/rpa/wechat_applescript_log.txt"&gt;/Users/zzy/hope/rpa/wechat_applescript_log.txt&lt;/a&gt;'.</msg>
<arg>${LOG_FILE}</arg>
<arg>${log_entry}\n</arg>
<doc>Appends the given content to the specified file.</doc>
<status status="PASS" start="2025-05-08T19:11:19.803234" elapsed="0.000549"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>${log_entry}</arg>
<doc>Logs the given message to the console.</doc>
<status status="PASS" start="2025-05-08T19:11:19.803919" elapsed="0.000203"/>
</kw>
<arg>自动化流程完成。结束时间: ${timestamp}</arg>
<status status="PASS" start="2025-05-08T19:11:19.801998" elapsed="0.002242"/>
</kw>
<kw name="记录日志">
<kw name="Get Current Date" owner="DateTime">
<msg time="2025-05-08T19:11:19.805070" level="INFO">${timestamp} = 2025-05-08 19:11:19</msg>
<var>${timestamp}</var>
<arg>result_format=%Y-%m-%d %H:%M:%S</arg>
<doc>Returns current local or UTC time with an optional increment.</doc>
<status status="PASS" start="2025-05-08T19:11:19.804838" elapsed="0.000266"/>
</kw>
<kw name="Catenate" owner="BuiltIn">
<msg time="2025-05-08T19:11:19.805460" level="INFO">${log_entry} = [2025-05-08 19:11:19] --------------------------------------------------</msg>
<var>${log_entry}</var>
<arg>SEPARATOR=\n</arg>
<arg>[${timestamp}] ${message}</arg>
<doc>Catenates the given items together and returns the resulted string.</doc>
<status status="PASS" start="2025-05-08T19:11:19.805225" elapsed="0.000267"/>
</kw>
<kw name="Append To File" owner="OperatingSystem">
<msg time="2025-05-08T19:11:19.806036" level="INFO" html="true">Appended to file '&lt;a href="file:///Users/zzy/hope/rpa/wechat_applescript_log.txt"&gt;/Users/zzy/hope/rpa/wechat_applescript_log.txt&lt;/a&gt;'.</msg>
<arg>${LOG_FILE}</arg>
<arg>${log_entry}\n</arg>
<doc>Appends the given content to the specified file.</doc>
<status status="PASS" start="2025-05-08T19:11:19.805605" elapsed="0.000729"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>${log_entry}</arg>
<doc>Logs the given message to the console.</doc>
<status status="PASS" start="2025-05-08T19:11:19.806477" elapsed="0.000194"/>
</kw>
<arg>--------------------------------------------------</arg>
<status status="PASS" start="2025-05-08T19:11:19.804478" elapsed="0.002271"/>
</kw>
<kw name="Normalize Path" owner="OperatingSystem">
<msg time="2025-05-08T19:11:19.807043" level="INFO">${log_path} = /Users/zzy/hope/rpa/wechat_applescript_log.txt</msg>
<var>${log_path}</var>
<arg>${LOG_FILE}</arg>
<doc>Normalizes the given path.</doc>
<status status="PASS" start="2025-05-08T19:11:19.806860" elapsed="0.000215"/>
</kw>
<kw name="Log" owner="BuiltIn">
<msg time="2025-05-08T19:11:19.807353" level="INFO">日志文件已保存至: /Users/zzy/hope/rpa/wechat_applescript_log.txt</msg>
<arg>日志文件已保存至: ${log_path}</arg>
<doc>Logs the given message with the given level.</doc>
<status status="PASS" start="2025-05-08T19:11:19.807206" elapsed="0.000205"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>\n日志文件已保存至: ${log_path}</arg>
<doc>Logs the given message to the console.</doc>
<status status="PASS" start="2025-05-08T19:11:19.807527" elapsed="0.000189"/>
</kw>
<status status="PASS" start="2025-05-08T19:11:19.801331" elapsed="0.006462"/>
</kw>
<status status="PASS" start="2025-05-08T19:11:08.720377" elapsed="11.087579"/>
</test>
<doc>微信完整自动化流程 (AppleScript版本)
自动搜索联系人并发送消息</doc>
<status status="PASS" start="2025-05-08T19:11:08.660025" elapsed="11.148562"/>
</suite>
<statistics>
<total>
<stat pass="1" fail="0" skip="0">All Tasks</stat>
</total>
<tag>
</tag>
<suite>
<stat name="Wechat Applescript Workflow" id="s1" pass="1" fail="0" skip="0">Wechat Applescript Workflow</stat>
</suite>
</statistics>
<errors>
</errors>
</robot>
