<?xml version="1.0" encoding="UTF-8"?>
<robot generator="Robot 7.2.2 (Python 3.13.2 on darwin)" generated="2025-05-08T17:30:06.429399" rpa="true" schemaversion="5">
<suite id="s1" name="Wechat Applescript Workflow" source="/Users/zzy/hope/rpa/wechat_applescript_workflow.robot">
<test id="s1-t1" name="完整微信AppleScript自动化工作流" line="18">
<kw name="创建日志文件">
<kw name="Get Current Date" owner="DateTime">
<msg time="2025-05-08T17:30:06.490415" level="INFO">${timestamp} = 2025-05-08 17:30:06</msg>
<var>${timestamp}</var>
<arg>result_format=%Y-%m-%d %H:%M:%S</arg>
<doc>Returns current local or UTC time with an optional increment.</doc>
<status status="PASS" start="2025-05-08T17:30:06.490103" elapsed="0.000358"/>
</kw>
<kw name="Create File" owner="OperatingSystem">
<msg time="2025-05-08T17:30:06.491041" level="INFO" html="true">Created file '&lt;a href="file:///Users/zzy/hope/rpa/wechat_applescript_log.txt"&gt;/Users/zzy/hope/rpa/wechat_applescript_log.txt&lt;/a&gt;'.</msg>
<arg>${LOG_FILE}</arg>
<doc>Creates a file with the given content and encoding.</doc>
<status status="PASS" start="2025-05-08T17:30:06.490618" elapsed="0.000501"/>
</kw>
<status status="PASS" start="2025-05-08T17:30:06.489299" elapsed="0.001909"/>
</kw>
<kw name="检查并安装依赖">
<kw name="记录日志">
<kw name="Get Current Date" owner="DateTime">
<msg time="2025-05-08T17:30:06.492497" level="INFO">${timestamp} = 2025-05-08 17:30:06</msg>
<var>${timestamp}</var>
<arg>result_format=%Y-%m-%d %H:%M:%S</arg>
<doc>Returns current local or UTC time with an optional increment.</doc>
<status status="PASS" start="2025-05-08T17:30:06.492265" elapsed="0.000273"/>
</kw>
<kw name="Catenate" owner="BuiltIn">
<msg time="2025-05-08T17:30:06.493218" level="INFO">${log_entry} = [2025-05-08 17:30:06] 检查自动化依赖工具</msg>
<var>${log_entry}</var>
<arg>SEPARATOR=\n</arg>
<arg>[${timestamp}] ${message}</arg>
<doc>Catenates the given items together and returns the resulted string.</doc>
<status status="PASS" start="2025-05-08T17:30:06.492658" elapsed="0.000610"/>
</kw>
<kw name="Append To File" owner="OperatingSystem">
<msg time="2025-05-08T17:30:06.493919" level="INFO" html="true">Appended to file '&lt;a href="file:///Users/zzy/hope/rpa/wechat_applescript_log.txt"&gt;/Users/zzy/hope/rpa/wechat_applescript_log.txt&lt;/a&gt;'.</msg>
<arg>${LOG_FILE}</arg>
<arg>${log_entry}\n</arg>
<doc>Appends the given content to the specified file.</doc>
<status status="PASS" start="2025-05-08T17:30:06.493403" elapsed="0.000601"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>${log_entry}</arg>
<doc>Logs the given message to the console.</doc>
<status status="PASS" start="2025-05-08T17:30:06.494138" elapsed="0.000225"/>
</kw>
<arg>检查自动化依赖工具</arg>
<status status="PASS" start="2025-05-08T17:30:06.491996" elapsed="0.002461"/>
</kw>
<kw name="Run Process" owner="Process">
<msg time="2025-05-08T17:30:06.494802" level="INFO">Starting process:
which cliclick</msg>
<msg time="2025-05-08T17:30:06.500121" level="INFO">Waiting for process to complete.</msg>
<msg time="2025-05-08T17:30:06.508569" level="INFO">Process completed.</msg>
<msg time="2025-05-08T17:30:06.508948" level="INFO">${cliclick_installed} = &lt;result object with rc 0&gt;</msg>
<var>${cliclick_installed}</var>
<arg>which cliclick</arg>
<arg>shell=True</arg>
<arg>stderr=STDOUT</arg>
<doc>Runs a process and waits for it to complete.</doc>
<status status="PASS" start="2025-05-08T17:30:06.494580" elapsed="0.014421"/>
</kw>
<kw name="Run Keyword And Return Status" owner="BuiltIn">
<kw name="Should Not Be Empty" owner="BuiltIn">
<msg time="2025-05-08T17:30:06.510706" level="INFO">Length is 23.</msg>
<arg>${cliclick_installed.stdout}</arg>
<doc>Verifies that the given item is not empty.</doc>
<status status="PASS" start="2025-05-08T17:30:06.509941" elapsed="0.000838"/>
</kw>
<msg time="2025-05-08T17:30:06.510898" level="INFO">${has_cliclick} = True</msg>
<var>${has_cliclick}</var>
<arg>Should Not Be Empty</arg>
<arg>${cliclick_installed.stdout}</arg>
<doc>Runs the given keyword with given arguments and returns the status as a Boolean value.</doc>
<status status="PASS" start="2025-05-08T17:30:06.509464" elapsed="0.001466"/>
</kw>
<if>
<branch type="IF" condition="not ${has_cliclick}">
<kw name="记录日志">
<arg>cliclick未安装，推荐使用Homebrew安装此工具以提高鼠标操作的可靠性</arg>
<status status="NOT RUN" start="2025-05-08T17:30:06.511553" elapsed="0.000035"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>\n推荐安装cliclick工具以提高脚本可靠性: brew install cliclick\n</arg>
<doc>Logs the given message to the console.</doc>
<status status="NOT RUN" start="2025-05-08T17:30:06.511729" elapsed="0.000026"/>
</kw>
<status status="NOT RUN" start="2025-05-08T17:30:06.511131" elapsed="0.000664"/>
</branch>
<branch type="ELSE">
<kw name="记录日志">
<kw name="Get Current Date" owner="DateTime">
<msg time="2025-05-08T17:30:06.512698" level="INFO">${timestamp} = 2025-05-08 17:30:06</msg>
<var>${timestamp}</var>
<arg>result_format=%Y-%m-%d %H:%M:%S</arg>
<doc>Returns current local or UTC time with an optional increment.</doc>
<status status="PASS" start="2025-05-08T17:30:06.512396" elapsed="0.000340"/>
</kw>
<kw name="Catenate" owner="BuiltIn">
<msg time="2025-05-08T17:30:06.513171" level="INFO">${log_entry} = [2025-05-08 17:30:06] 已安装cliclick工具，可用于备选鼠标操作方案</msg>
<var>${log_entry}</var>
<arg>SEPARATOR=\n</arg>
<arg>[${timestamp}] ${message}</arg>
<doc>Catenates the given items together and returns the resulted string.</doc>
<status status="PASS" start="2025-05-08T17:30:06.512872" elapsed="0.000338"/>
</kw>
<kw name="Append To File" owner="OperatingSystem">
<msg time="2025-05-08T17:30:06.513833" level="INFO" html="true">Appended to file '&lt;a href="file:///Users/zzy/hope/rpa/wechat_applescript_log.txt"&gt;/Users/zzy/hope/rpa/wechat_applescript_log.txt&lt;/a&gt;'.</msg>
<arg>${LOG_FILE}</arg>
<arg>${log_entry}\n</arg>
<doc>Appends the given content to the specified file.</doc>
<status status="PASS" start="2025-05-08T17:30:06.513341" elapsed="0.000568"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>${log_entry}</arg>
<doc>Logs the given message to the console.</doc>
<status status="PASS" start="2025-05-08T17:30:06.514055" elapsed="0.000238"/>
</kw>
<arg>已安装cliclick工具，可用于备选鼠标操作方案</arg>
<status status="PASS" start="2025-05-08T17:30:06.512001" elapsed="0.002377"/>
</kw>
<status status="PASS" start="2025-05-08T17:30:06.511845" elapsed="0.002574"/>
</branch>
<status status="PASS" start="2025-05-08T17:30:06.511060" elapsed="0.003397"/>
</if>
<kw name="Run Keyword And Return Status" owner="BuiltIn">
<kw name="File Should Exist" owner="OperatingSystem">
<msg time="2025-05-08T17:30:06.515025" level="INFO" html="true">File '&lt;a href="file:///Users/zzy/hope/rpa/scripts/wechat/activate_wechat.applescript"&gt;/Users/zzy/hope/rpa/scripts/wechat/activate_wechat.applescript&lt;/a&gt;' exists.</msg>
<arg>${SCRIPTS_DIR}/activate_wechat.applescript</arg>
<doc>Fails unless the given ``path`` points to an existing file.</doc>
<status status="PASS" start="2025-05-08T17:30:06.514800" elapsed="0.000298"/>
</kw>
<msg time="2025-05-08T17:30:06.515198" level="INFO">${activate_script_exists} = True</msg>
<var>${activate_script_exists}</var>
<arg>File Should Exist</arg>
<arg>${SCRIPTS_DIR}/activate_wechat.applescript</arg>
<doc>Runs the given keyword with given arguments and returns the status as a Boolean value.</doc>
<status status="PASS" start="2025-05-08T17:30:06.514605" elapsed="0.000624"/>
</kw>
<kw name="Run Keyword And Return Status" owner="BuiltIn">
<kw name="File Should Exist" owner="OperatingSystem">
<msg time="2025-05-08T17:30:06.515854" level="INFO" html="true">File '&lt;a href="file:///Users/zzy/hope/rpa/scripts/wechat/search_contact.applescript"&gt;/Users/zzy/hope/rpa/scripts/wechat/search_contact.applescript&lt;/a&gt;' exists.</msg>
<arg>${SCRIPTS_DIR}/search_contact.applescript</arg>
<doc>Fails unless the given ``path`` points to an existing file.</doc>
<status status="PASS" start="2025-05-08T17:30:06.515637" elapsed="0.000304"/>
</kw>
<msg time="2025-05-08T17:30:06.516221" level="INFO">${search_script_exists} = True</msg>
<var>${search_script_exists}</var>
<arg>File Should Exist</arg>
<arg>${SCRIPTS_DIR}/search_contact.applescript</arg>
<doc>Runs the given keyword with given arguments and returns the status as a Boolean value.</doc>
<status status="PASS" start="2025-05-08T17:30:06.515446" elapsed="0.000830"/>
</kw>
<kw name="Run Keyword And Return Status" owner="BuiltIn">
<kw name="File Should Exist" owner="OperatingSystem">
<msg time="2025-05-08T17:30:06.516879" level="INFO" html="true">File '&lt;a href="file:///Users/zzy/hope/rpa/scripts/wechat/send_message.applescript"&gt;/Users/zzy/hope/rpa/scripts/wechat/send_message.applescript&lt;/a&gt;' exists.</msg>
<arg>${SCRIPTS_DIR}/send_message.applescript</arg>
<doc>Fails unless the given ``path`` points to an existing file.</doc>
<status status="PASS" start="2025-05-08T17:30:06.516650" elapsed="0.000313"/>
</kw>
<msg time="2025-05-08T17:30:06.517073" level="INFO">${send_script_exists} = True</msg>
<var>${send_script_exists}</var>
<arg>File Should Exist</arg>
<arg>${SCRIPTS_DIR}/send_message.applescript</arg>
<doc>Runs the given keyword with given arguments and returns the status as a Boolean value.</doc>
<status status="PASS" start="2025-05-08T17:30:06.516445" elapsed="0.000660"/>
</kw>
<kw name="Run Keyword And Return Status" owner="BuiltIn">
<kw name="File Should Exist" owner="OperatingSystem">
<msg time="2025-05-08T17:30:06.517895" level="INFO" html="true">File '&lt;a href="file:///Users/zzy/hope/rpa/scripts/wechat/cliclick_focus_send.applescript"&gt;/Users/zzy/hope/rpa/scripts/wechat/cliclick_focus_send.applescript&lt;/a&gt;' exists.</msg>
<arg>${SCRIPTS_DIR}/cliclick_focus_send.applescript</arg>
<doc>Fails unless the given ``path`` points to an existing file.</doc>
<status status="PASS" start="2025-05-08T17:30:06.517535" elapsed="0.000471"/>
</kw>
<msg time="2025-05-08T17:30:06.518136" level="INFO">${cliclick_script_exists} = True</msg>
<var>${cliclick_script_exists}</var>
<arg>File Should Exist</arg>
<arg>${SCRIPTS_DIR}/cliclick_focus_send.applescript</arg>
<doc>Runs the given keyword with given arguments and returns the status as a Boolean value.</doc>
<status status="PASS" start="2025-05-08T17:30:06.517323" elapsed="0.000848"/>
</kw>
<kw name="Evaluate" owner="BuiltIn">
<msg time="2025-05-08T17:30:06.518861" level="INFO">${all_scripts_exist} = True</msg>
<var>${all_scripts_exist}</var>
<arg>${activate_script_exists} and ${search_script_exists} and ${send_script_exists} and ${cliclick_script_exists}</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<status status="PASS" start="2025-05-08T17:30:06.518349" elapsed="0.000556"/>
</kw>
<kw name="Set Variable" owner="BuiltIn">
<msg time="2025-05-08T17:30:06.519276" level="INFO">${scripts_executable} = True</msg>
<var>${scripts_executable}</var>
<arg>${True}</arg>
<doc>Returns the given values which can then be assigned to a variables.</doc>
<status status="PASS" start="2025-05-08T17:30:06.519075" elapsed="0.000235"/>
</kw>
<if>
<branch type="IF" condition="${all_scripts_exist}">
<kw name="Run Process" owner="Process">
<msg time="2025-05-08T17:30:06.520005" level="INFO">Starting process:
test -x /Users/zzy/hope/rpa/scripts/wechat/activate_wechat.applescript &amp;&amp; echo "OK" || echo "NotExecutable"</msg>
<msg time="2025-05-08T17:30:06.525369" level="INFO">Waiting for process to complete.</msg>
<msg time="2025-05-08T17:30:06.531987" level="INFO">Process completed.</msg>
<msg time="2025-05-08T17:30:06.532347" level="INFO">${activate_perm} = &lt;result object with rc 0&gt;</msg>
<var>${activate_perm}</var>
<arg>test -x ${SCRIPTS_DIR}/activate_wechat.applescript &amp;&amp; echo "OK" || echo "NotExecutable"</arg>
<arg>shell=True</arg>
<doc>Runs a process and waits for it to complete.</doc>
<status status="PASS" start="2025-05-08T17:30:06.519639" elapsed="0.012753"/>
</kw>
<kw name="Run Process" owner="Process">
<msg time="2025-05-08T17:30:06.533769" level="INFO">Starting process:
test -x /Users/zzy/hope/rpa/scripts/wechat/search_contact.applescript &amp;&amp; echo "OK" || echo "NotExecutable"</msg>
<msg time="2025-05-08T17:30:06.539440" level="INFO">Waiting for process to complete.</msg>
<msg time="2025-05-08T17:30:06.546850" level="INFO">Process completed.</msg>
<msg time="2025-05-08T17:30:06.547208" level="INFO">${search_perm} = &lt;result object with rc 0&gt;</msg>
<var>${search_perm}</var>
<arg>test -x ${SCRIPTS_DIR}/search_contact.applescript &amp;&amp; echo "OK" || echo "NotExecutable"</arg>
<arg>shell=True</arg>
<doc>Runs a process and waits for it to complete.</doc>
<status status="PASS" start="2025-05-08T17:30:06.532862" elapsed="0.014393"/>
</kw>
<kw name="Run Process" owner="Process">
<msg time="2025-05-08T17:30:06.548162" level="INFO">Starting process:
test -x /Users/zzy/hope/rpa/scripts/wechat/send_message.applescript &amp;&amp; echo "OK" || echo "NotExecutable"</msg>
<msg time="2025-05-08T17:30:06.553639" level="INFO">Waiting for process to complete.</msg>
<msg time="2025-05-08T17:30:06.560526" level="INFO">Process completed.</msg>
<msg time="2025-05-08T17:30:06.560878" level="INFO">${send_perm} = &lt;result object with rc 0&gt;</msg>
<var>${send_perm}</var>
<arg>test -x ${SCRIPTS_DIR}/send_message.applescript &amp;&amp; echo "OK" || echo "NotExecutable"</arg>
<arg>shell=True</arg>
<doc>Runs a process and waits for it to complete.</doc>
<status status="PASS" start="2025-05-08T17:30:06.547730" elapsed="0.013195"/>
</kw>
<kw name="Run Process" owner="Process">
<msg time="2025-05-08T17:30:06.562449" level="INFO">Starting process:
test -x /Users/zzy/hope/rpa/scripts/wechat/cliclick_focus_send.applescript &amp;&amp; echo "OK" || echo "NotExecutable"</msg>
<msg time="2025-05-08T17:30:06.567550" level="INFO">Waiting for process to complete.</msg>
<msg time="2025-05-08T17:30:06.574220" level="INFO">Process completed.</msg>
<msg time="2025-05-08T17:30:06.574591" level="INFO">${cliclick_perm} = &lt;result object with rc 0&gt;</msg>
<var>${cliclick_perm}</var>
<arg>test -x ${SCRIPTS_DIR}/cliclick_focus_send.applescript &amp;&amp; echo "OK" || echo "NotExecutable"</arg>
<arg>shell=True</arg>
<doc>Runs a process and waits for it to complete.</doc>
<status status="PASS" start="2025-05-08T17:30:06.561380" elapsed="0.013260"/>
</kw>
<kw name="Evaluate" owner="BuiltIn">
<msg time="2025-05-08T17:30:06.577948" level="INFO">${scripts_executable} = True</msg>
<var>${scripts_executable}</var>
<arg>"${activate_perm.stdout}" == "OK" and "${search_perm.stdout}" == "OK" and "${send_perm.stdout}" == "OK" and "${cliclick_perm.stdout}" == "OK"</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<status status="PASS" start="2025-05-08T17:30:06.575101" elapsed="0.002888"/>
</kw>
<if>
<branch type="IF" condition="not ${scripts_executable}">
<kw name="记录日志">
<arg>警告: 某些AppleScript文件没有执行权限，尝试添加执行权限</arg>
<status status="NOT RUN" start="2025-05-08T17:30:06.578537" elapsed="0.000039"/>
</kw>
<kw name="Run Process" owner="Process">
<arg>chmod +x ${SCRIPTS_DIR}/*.applescript</arg>
<arg>shell=True</arg>
<doc>Runs a process and waits for it to complete.</doc>
<status status="NOT RUN" start="2025-05-08T17:30:06.578718" elapsed="0.000028"/>
</kw>
<kw name="Set Variable" owner="BuiltIn">
<var>${scripts_executable}</var>
<arg>${True}</arg>
<doc>Returns the given values which can then be assigned to a variables.</doc>
<status status="NOT RUN" start="2025-05-08T17:30:06.578869" elapsed="0.000026"/>
</kw>
<kw name="记录日志">
<arg>已添加执行权限至所有脚本文件</arg>
<status status="NOT RUN" start="2025-05-08T17:30:06.579043" elapsed="0.000031"/>
</kw>
<status status="NOT RUN" start="2025-05-08T17:30:06.578168" elapsed="0.000947"/>
</branch>
<status status="PASS" start="2025-05-08T17:30:06.578108" elapsed="0.001049"/>
</if>
<status status="PASS" start="2025-05-08T17:30:06.519443" elapsed="0.059754"/>
</branch>
<status status="PASS" start="2025-05-08T17:30:06.519392" elapsed="0.059836"/>
</if>
<kw name="Evaluate" owner="BuiltIn">
<msg time="2025-05-08T17:30:06.579624" level="INFO">${scripts_ok} = True</msg>
<var>${scripts_ok}</var>
<arg>${all_scripts_exist} and ${scripts_executable}</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<status status="PASS" start="2025-05-08T17:30:06.579339" elapsed="0.000418"/>
</kw>
<if>
<branch type="IF" condition="not ${scripts_ok}">
<kw name="记录日志">
<arg>错误: 预创建的AppleScript文件不完整或没有执行权限</arg>
<status status="NOT RUN" start="2025-05-08T17:30:06.580085" elapsed="0.000029"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>\n错误: 预创建的AppleScript文件不完整或没有执行权限，请确保所有脚本文件已正确创建在 ${SCRIPTS_DIR} 目录下\n</arg>
<doc>Logs the given message to the console.</doc>
<status status="NOT RUN" start="2025-05-08T17:30:06.580241" elapsed="0.000026"/>
</kw>
<status status="NOT RUN" start="2025-05-08T17:30:06.579853" elapsed="0.000458"/>
</branch>
<branch type="ELSE">
<kw name="记录日志">
<kw name="Get Current Date" owner="DateTime">
<msg time="2025-05-08T17:30:06.581142" level="INFO">${timestamp} = 2025-05-08 17:30:06</msg>
<var>${timestamp}</var>
<arg>result_format=%Y-%m-%d %H:%M:%S</arg>
<doc>Returns current local or UTC time with an optional increment.</doc>
<status status="PASS" start="2025-05-08T17:30:06.580843" elapsed="0.000336"/>
</kw>
<kw name="Catenate" owner="BuiltIn">
<msg time="2025-05-08T17:30:06.581568" level="INFO">${log_entry} = [2025-05-08 17:30:06] 验证完成: 所有预创建的AppleScript文件都已存在且有执行权限</msg>
<var>${log_entry}</var>
<arg>SEPARATOR=\n</arg>
<arg>[${timestamp}] ${message}</arg>
<doc>Catenates the given items together and returns the resulted string.</doc>
<status status="PASS" start="2025-05-08T17:30:06.581313" elapsed="0.000290"/>
</kw>
<kw name="Append To File" owner="OperatingSystem">
<msg time="2025-05-08T17:30:06.582211" level="INFO" html="true">Appended to file '&lt;a href="file:///Users/zzy/hope/rpa/wechat_applescript_log.txt"&gt;/Users/zzy/hope/rpa/wechat_applescript_log.txt&lt;/a&gt;'.</msg>
<arg>${LOG_FILE}</arg>
<arg>${log_entry}\n</arg>
<doc>Appends the given content to the specified file.</doc>
<status status="PASS" start="2025-05-08T17:30:06.581729" elapsed="0.000556"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>${log_entry}</arg>
<doc>Logs the given message to the console.</doc>
<status status="PASS" start="2025-05-08T17:30:06.582452" elapsed="0.000264"/>
</kw>
<arg>验证完成: 所有预创建的AppleScript文件都已存在且有执行权限</arg>
<status status="PASS" start="2025-05-08T17:30:06.580485" elapsed="0.002320"/>
</kw>
<status status="PASS" start="2025-05-08T17:30:06.580344" elapsed="0.002501"/>
</branch>
<status status="PASS" start="2025-05-08T17:30:06.579829" elapsed="0.003049"/>
</if>
<return>
<value>${scripts_ok}</value>
<status status="PASS" start="2025-05-08T17:30:06.582950" elapsed="0.000102"/>
</return>
<msg time="2025-05-08T17:30:06.583233" level="INFO">${scripts_ok} = True</msg>
<var>${scripts_ok}</var>
<status status="PASS" start="2025-05-08T17:30:06.491696" elapsed="0.091570"/>
</kw>
<kw name="Run Keyword If" owner="BuiltIn">
<kw name="执行基于AppleScript的微信自动化">
<kw name="记录日志">
<kw name="Get Current Date" owner="DateTime">
<msg time="2025-05-08T17:30:06.585195" level="INFO">${timestamp} = 2025-05-08 17:30:06</msg>
<var>${timestamp}</var>
<arg>result_format=%Y-%m-%d %H:%M:%S</arg>
<doc>Returns current local or UTC time with an optional increment.</doc>
<status status="PASS" start="2025-05-08T17:30:06.584952" elapsed="0.000282"/>
</kw>
<kw name="Catenate" owner="BuiltIn">
<msg time="2025-05-08T17:30:06.585595" level="INFO">${log_entry} = [2025-05-08 17:30:06] 步骤1: 使用AppleScript激活微信窗口</msg>
<var>${log_entry}</var>
<arg>SEPARATOR=\n</arg>
<arg>[${timestamp}] ${message}</arg>
<doc>Catenates the given items together and returns the resulted string.</doc>
<status status="PASS" start="2025-05-08T17:30:06.585356" elapsed="0.000274"/>
</kw>
<kw name="Append To File" owner="OperatingSystem">
<msg time="2025-05-08T17:30:06.586163" level="INFO" html="true">Appended to file '&lt;a href="file:///Users/zzy/hope/rpa/wechat_applescript_log.txt"&gt;/Users/zzy/hope/rpa/wechat_applescript_log.txt&lt;/a&gt;'.</msg>
<arg>${LOG_FILE}</arg>
<arg>${log_entry}\n</arg>
<doc>Appends the given content to the specified file.</doc>
<status status="PASS" start="2025-05-08T17:30:06.585748" elapsed="0.000491"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>${log_entry}</arg>
<doc>Logs the given message to the console.</doc>
<status status="PASS" start="2025-05-08T17:30:06.586365" elapsed="0.000195"/>
</kw>
<arg>步骤1: 使用AppleScript激活微信窗口</arg>
<status status="PASS" start="2025-05-08T17:30:06.584675" elapsed="0.001964"/>
</kw>
<kw name="记录日志">
<kw name="Get Current Date" owner="DateTime">
<msg time="2025-05-08T17:30:06.587325" level="INFO">${timestamp} = 2025-05-08 17:30:06</msg>
<var>${timestamp}</var>
<arg>result_format=%Y-%m-%d %H:%M:%S</arg>
<doc>Returns current local or UTC time with an optional increment.</doc>
<status status="PASS" start="2025-05-08T17:30:06.587105" elapsed="0.000257"/>
</kw>
<kw name="Catenate" owner="BuiltIn">
<msg time="2025-05-08T17:30:06.587721" level="INFO">${log_entry} = [2025-05-08 17:30:06] 联系人: "文件传输助手"</msg>
<var>${log_entry}</var>
<arg>SEPARATOR=\n</arg>
<arg>[${timestamp}] ${message}</arg>
<doc>Catenates the given items together and returns the resulted string.</doc>
<status status="PASS" start="2025-05-08T17:30:06.587487" elapsed="0.000269"/>
</kw>
<kw name="Append To File" owner="OperatingSystem">
<msg time="2025-05-08T17:30:06.588226" level="INFO" html="true">Appended to file '&lt;a href="file:///Users/zzy/hope/rpa/wechat_applescript_log.txt"&gt;/Users/zzy/hope/rpa/wechat_applescript_log.txt&lt;/a&gt;'.</msg>
<arg>${LOG_FILE}</arg>
<arg>${log_entry}\n</arg>
<doc>Appends the given content to the specified file.</doc>
<status status="PASS" start="2025-05-08T17:30:06.587874" elapsed="0.000434"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>${log_entry}</arg>
<doc>Logs the given message to the console.</doc>
<status status="PASS" start="2025-05-08T17:30:06.588434" elapsed="0.000191"/>
</kw>
<arg>联系人: "${target_contact}"</arg>
<status status="PASS" start="2025-05-08T17:30:06.586789" elapsed="0.001921"/>
</kw>
<kw name="记录日志">
<kw name="Get Current Date" owner="DateTime">
<msg time="2025-05-08T17:30:06.589423" level="INFO">${timestamp} = 2025-05-08 17:30:06</msg>
<var>${timestamp}</var>
<arg>result_format=%Y-%m-%d %H:%M:%S</arg>
<doc>Returns current local or UTC time with an optional increment.</doc>
<status status="PASS" start="2025-05-08T17:30:06.589200" elapsed="0.000264"/>
</kw>
<kw name="Catenate" owner="BuiltIn">
<msg time="2025-05-08T17:30:06.589821" level="INFO">${log_entry} = [2025-05-08 17:30:06] 将发送的消息内容: "你好，这是测试消息245"</msg>
<var>${log_entry}</var>
<arg>SEPARATOR=\n</arg>
<arg>[${timestamp}] ${message}</arg>
<doc>Catenates the given items together and returns the resulted string.</doc>
<status status="PASS" start="2025-05-08T17:30:06.589586" elapsed="0.000276"/>
</kw>
<kw name="Append To File" owner="OperatingSystem">
<msg time="2025-05-08T17:30:06.590378" level="INFO" html="true">Appended to file '&lt;a href="file:///Users/zzy/hope/rpa/wechat_applescript_log.txt"&gt;/Users/zzy/hope/rpa/wechat_applescript_log.txt&lt;/a&gt;'.</msg>
<arg>${LOG_FILE}</arg>
<arg>${log_entry}\n</arg>
<doc>Appends the given content to the specified file.</doc>
<status status="PASS" start="2025-05-08T17:30:06.589984" elapsed="0.000472"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>${log_entry}</arg>
<doc>Logs the given message to the console.</doc>
<status status="PASS" start="2025-05-08T17:30:06.590590" elapsed="0.000193"/>
</kw>
<arg>将发送的消息内容: "${custom_message}"</arg>
<status status="PASS" start="2025-05-08T17:30:06.588869" elapsed="0.002002"/>
</kw>
<kw name="Run Process" owner="Process">
<msg time="2025-05-08T17:30:06.591302" level="INFO">Starting process:
osascript /Users/zzy/hope/rpa/scripts/wechat/activate_wechat.applescript</msg>
<msg time="2025-05-08T17:30:06.597991" level="INFO">Waiting for process to complete.</msg>
<msg time="2025-05-08T17:30:06.858070" level="INFO">Process completed.</msg>
<msg time="2025-05-08T17:30:06.858900" level="INFO">${result1} = &lt;result object with rc 0&gt;</msg>
<var>${result1}</var>
<arg>osascript</arg>
<arg>${SCRIPTS_DIR}/activate_wechat.applescript</arg>
<arg>stderr=STDOUT</arg>
<doc>Runs a process and waits for it to complete.</doc>
<status status="PASS" start="2025-05-08T17:30:06.590997" elapsed="0.268018"/>
</kw>
<kw name="Run Keyword And Return Status" owner="BuiltIn">
<kw name="Should Be Empty" owner="BuiltIn">
<msg time="2025-05-08T17:30:06.861517" level="INFO">Length is 0.</msg>
<arg>${result1.stderr}</arg>
<doc>Verifies that the given item is empty.</doc>
<status status="PASS" start="2025-05-08T17:30:06.860341" elapsed="0.001296"/>
</kw>
<msg time="2025-05-08T17:30:06.861824" level="INFO">${wechat_activated} = True</msg>
<var>${wechat_activated}</var>
<arg>Should Be Empty</arg>
<arg>${result1.stderr}</arg>
<doc>Runs the given keyword with given arguments and returns the status as a Boolean value.</doc>
<status status="PASS" start="2025-05-08T17:30:06.859782" elapsed="0.002142"/>
</kw>
<if>
<branch type="IF" condition="not ${wechat_activated}">
<kw name="记录日志">
<arg>错误: 无法激活微信窗口: ${result1.stderr}</arg>
<status status="NOT RUN" start="2025-05-08T17:30:06.863036" elapsed="0.000051"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>\n错误: 无法激活微信窗口，请确认微信已安装并且可以手动启动\n</arg>
<doc>Logs the given message to the console.</doc>
<status status="NOT RUN" start="2025-05-08T17:30:06.863299" elapsed="0.000039"/>
</kw>
<return>
<value>${False}</value>
<status status="NOT RUN" start="2025-05-08T17:30:06.863436" elapsed="0.000046"/>
</return>
<status status="NOT RUN" start="2025-05-08T17:30:06.862259" elapsed="0.001286"/>
</branch>
<status status="PASS" start="2025-05-08T17:30:06.862190" elapsed="0.001402"/>
</if>
<kw name="记录日志">
<kw name="Get Current Date" owner="DateTime">
<msg time="2025-05-08T17:30:06.865294" level="INFO">${timestamp} = 2025-05-08 17:30:06</msg>
<var>${timestamp}</var>
<arg>result_format=%Y-%m-%d %H:%M:%S</arg>
<doc>Returns current local or UTC time with an optional increment.</doc>
<status status="PASS" start="2025-05-08T17:30:06.864887" elapsed="0.000456"/>
</kw>
<kw name="Catenate" owner="BuiltIn">
<msg time="2025-05-08T17:30:06.865884" level="INFO">${log_entry} = [2025-05-08 17:30:06] AppleScript激活微信窗口结果: </msg>
<var>${log_entry}</var>
<arg>SEPARATOR=\n</arg>
<arg>[${timestamp}] ${message}</arg>
<doc>Catenates the given items together and returns the resulted string.</doc>
<status status="PASS" start="2025-05-08T17:30:06.865531" elapsed="0.000404"/>
</kw>
<kw name="Append To File" owner="OperatingSystem">
<msg time="2025-05-08T17:30:06.866795" level="INFO" html="true">Appended to file '&lt;a href="file:///Users/zzy/hope/rpa/wechat_applescript_log.txt"&gt;/Users/zzy/hope/rpa/wechat_applescript_log.txt&lt;/a&gt;'.</msg>
<arg>${LOG_FILE}</arg>
<arg>${log_entry}\n</arg>
<doc>Appends the given content to the specified file.</doc>
<status status="PASS" start="2025-05-08T17:30:06.866104" elapsed="0.000810"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>${log_entry}</arg>
<doc>Logs the given message to the console.</doc>
<status status="PASS" start="2025-05-08T17:30:06.867109" elapsed="0.000303"/>
</kw>
<arg>AppleScript激活微信窗口结果: ${result1.stdout}</arg>
<status status="PASS" start="2025-05-08T17:30:06.863801" elapsed="0.003734"/>
</kw>
<kw name="Sleep" owner="BuiltIn">
<msg time="2025-05-08T17:30:07.868072" level="INFO">Slept 1 second.</msg>
<arg>1s</arg>
<doc>Pauses the test executed for the given time.</doc>
<status status="PASS" start="2025-05-08T17:30:06.867718" elapsed="1.000471"/>
</kw>
<kw name="记录日志">
<kw name="Get Current Date" owner="DateTime">
<msg time="2025-05-08T17:30:07.869210" level="INFO">${timestamp} = 2025-05-08 17:30:07</msg>
<var>${timestamp}</var>
<arg>result_format=%Y-%m-%d %H:%M:%S</arg>
<doc>Returns current local or UTC time with an optional increment.</doc>
<status status="PASS" start="2025-05-08T17:30:07.868832" elapsed="0.000437"/>
</kw>
<kw name="Catenate" owner="BuiltIn">
<msg time="2025-05-08T17:30:07.869736" level="INFO">${log_entry} = [2025-05-08 17:30:07] 步骤2: 等待窗口激活完成</msg>
<var>${log_entry}</var>
<arg>SEPARATOR=\n</arg>
<arg>[${timestamp}] ${message}</arg>
<doc>Catenates the given items together and returns the resulted string.</doc>
<status status="PASS" start="2025-05-08T17:30:07.869402" elapsed="0.000374"/>
</kw>
<kw name="Append To File" owner="OperatingSystem">
<msg time="2025-05-08T17:30:07.870339" level="INFO" html="true">Appended to file '&lt;a href="file:///Users/zzy/hope/rpa/wechat_applescript_log.txt"&gt;/Users/zzy/hope/rpa/wechat_applescript_log.txt&lt;/a&gt;'.</msg>
<arg>${LOG_FILE}</arg>
<arg>${log_entry}\n</arg>
<doc>Appends the given content to the specified file.</doc>
<status status="PASS" start="2025-05-08T17:30:07.869902" elapsed="0.000509"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>${log_entry}</arg>
<doc>Logs the given message to the console.</doc>
<status status="PASS" start="2025-05-08T17:30:07.870539" elapsed="0.000198"/>
</kw>
<arg>步骤2: 等待窗口激活完成</arg>
<status status="PASS" start="2025-05-08T17:30:07.868410" elapsed="0.002407"/>
</kw>
<kw name="记录日志">
<kw name="Get Current Date" owner="DateTime">
<msg time="2025-05-08T17:30:07.871555" level="INFO">${timestamp} = 2025-05-08 17:30:07</msg>
<var>${timestamp}</var>
<arg>result_format=%Y-%m-%d %H:%M:%S</arg>
<doc>Returns current local or UTC time with an optional increment.</doc>
<status status="PASS" start="2025-05-08T17:30:07.871328" elapsed="0.000262"/>
</kw>
<kw name="Catenate" owner="BuiltIn">
<msg time="2025-05-08T17:30:07.871954" level="INFO">${log_entry} = [2025-05-08 17:30:07] 步骤3: 使用预创建脚本搜索联系人 "文件传输助手"</msg>
<var>${log_entry}</var>
<arg>SEPARATOR=\n</arg>
<arg>[${timestamp}] ${message}</arg>
<doc>Catenates the given items together and returns the resulted string.</doc>
<status status="PASS" start="2025-05-08T17:30:07.871716" elapsed="0.000278"/>
</kw>
<kw name="Append To File" owner="OperatingSystem">
<msg time="2025-05-08T17:30:07.872468" level="INFO" html="true">Appended to file '&lt;a href="file:///Users/zzy/hope/rpa/wechat_applescript_log.txt"&gt;/Users/zzy/hope/rpa/wechat_applescript_log.txt&lt;/a&gt;'.</msg>
<arg>${LOG_FILE}</arg>
<arg>${log_entry}\n</arg>
<doc>Appends the given content to the specified file.</doc>
<status status="PASS" start="2025-05-08T17:30:07.872110" elapsed="0.000435"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>${log_entry}</arg>
<doc>Logs the given message to the console.</doc>
<status status="PASS" start="2025-05-08T17:30:07.872669" elapsed="0.000190"/>
</kw>
<arg>步骤3: 使用预创建脚本搜索联系人 "${target_contact}"</arg>
<status status="PASS" start="2025-05-08T17:30:07.870985" elapsed="0.001954"/>
</kw>
<kw name="Run Process" owner="Process">
<msg time="2025-05-08T17:30:07.873395" level="INFO">Starting process:
osascript /Users/zzy/hope/rpa/scripts/wechat/search_contact.applescript 文件传输助手</msg>
<msg time="2025-05-08T17:30:07.879791" level="INFO">Waiting for process to complete.</msg>
<msg time="2025-05-08T17:30:13.443690" level="INFO">Process completed.</msg>
<msg time="2025-05-08T17:30:13.444120" level="INFO">${result2} = &lt;result object with rc 0&gt;</msg>
<var>${result2}</var>
<arg>osascript</arg>
<arg>${SCRIPTS_DIR}/search_contact.applescript</arg>
<arg>${target_contact}</arg>
<arg>stderr=STDOUT</arg>
<doc>Runs a process and waits for it to complete.</doc>
<status status="PASS" start="2025-05-08T17:30:07.873065" elapsed="5.571112"/>
</kw>
<kw name="Run Keyword And Return Status" owner="BuiltIn">
<kw name="Should Be Empty" owner="BuiltIn">
<msg time="2025-05-08T17:30:13.446325" level="INFO">Length is 0.</msg>
<arg>${result2.stderr}</arg>
<doc>Verifies that the given item is empty.</doc>
<status status="PASS" start="2025-05-08T17:30:13.445445" elapsed="0.000957"/>
</kw>
<msg time="2025-05-08T17:30:13.446680" level="INFO">${contact_found} = True</msg>
<var>${contact_found}</var>
<arg>Should Be Empty</arg>
<arg>${result2.stderr}</arg>
<doc>Runs the given keyword with given arguments and returns the status as a Boolean value.</doc>
<status status="PASS" start="2025-05-08T17:30:13.444732" elapsed="0.001985"/>
</kw>
<if>
<branch type="IF" condition="not ${contact_found}">
<kw name="记录日志">
<arg>错误: 搜索联系人失败: ${result2.stderr}</arg>
<status status="NOT RUN" start="2025-05-08T17:30:13.447341" elapsed="0.000040"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>\n错误: 无法搜索或找到联系人 "${target_contact}"\n</arg>
<doc>Logs the given message to the console.</doc>
<status status="NOT RUN" start="2025-05-08T17:30:13.447531" elapsed="0.000031"/>
</kw>
<return>
<value>${False}</value>
<status status="NOT RUN" start="2025-05-08T17:30:13.447659" elapsed="0.000033"/>
</return>
<status status="NOT RUN" start="2025-05-08T17:30:13.446905" elapsed="0.000832"/>
</branch>
<status status="PASS" start="2025-05-08T17:30:13.446847" elapsed="0.000923"/>
</if>
<kw name="记录日志">
<kw name="Get Current Date" owner="DateTime">
<msg time="2025-05-08T17:30:13.449149" level="INFO">${timestamp} = 2025-05-08 17:30:13</msg>
<var>${timestamp}</var>
<arg>result_format=%Y-%m-%d %H:%M:%S</arg>
<doc>Returns current local or UTC time with an optional increment.</doc>
<status status="PASS" start="2025-05-08T17:30:13.448736" elapsed="0.000454"/>
</kw>
<kw name="Catenate" owner="BuiltIn">
<msg time="2025-05-08T17:30:13.449679" level="INFO">${log_entry} = [2025-05-08 17:30:13] 搜索联系人脚本执行结果: </msg>
<var>${log_entry}</var>
<arg>SEPARATOR=\n</arg>
<arg>[${timestamp}] ${message}</arg>
<doc>Catenates the given items together and returns the resulted string.</doc>
<status status="PASS" start="2025-05-08T17:30:13.449392" elapsed="0.000326"/>
</kw>
<kw name="Append To File" owner="OperatingSystem">
<msg time="2025-05-08T17:30:13.450436" level="INFO" html="true">Appended to file '&lt;a href="file:///Users/zzy/hope/rpa/wechat_applescript_log.txt"&gt;/Users/zzy/hope/rpa/wechat_applescript_log.txt&lt;/a&gt;'.</msg>
<arg>${LOG_FILE}</arg>
<arg>${log_entry}\n</arg>
<doc>Appends the given content to the specified file.</doc>
<status status="PASS" start="2025-05-08T17:30:13.449865" elapsed="0.000659"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>${log_entry}</arg>
<doc>Logs the given message to the console.</doc>
<status status="PASS" start="2025-05-08T17:30:13.450734" elapsed="0.000270"/>
</kw>
<arg>搜索联系人脚本执行结果: ${result2.stdout}</arg>
<status status="PASS" start="2025-05-08T17:30:13.447926" elapsed="0.003180"/>
</kw>
<kw name="Sleep" owner="BuiltIn">
<msg time="2025-05-08T17:30:16.452194" level="INFO">Slept 3 seconds.</msg>
<arg>3s</arg>
<doc>Pauses the test executed for the given time.</doc>
<status status="PASS" start="2025-05-08T17:30:13.451239" elapsed="3.001082"/>
</kw>
<kw name="记录日志">
<kw name="Get Current Date" owner="DateTime">
<msg time="2025-05-08T17:30:16.453111" level="INFO">${timestamp} = 2025-05-08 17:30:16</msg>
<var>${timestamp}</var>
<arg>result_format=%Y-%m-%d %H:%M:%S</arg>
<doc>Returns current local or UTC time with an optional increment.</doc>
<status status="PASS" start="2025-05-08T17:30:16.452872" elapsed="0.000274"/>
</kw>
<kw name="Catenate" owner="BuiltIn">
<msg time="2025-05-08T17:30:16.453495" level="INFO">${log_entry} = [2025-05-08 17:30:16] 步骤4: 聊天窗口已加载，准备输入消息</msg>
<var>${log_entry}</var>
<arg>SEPARATOR=\n</arg>
<arg>[${timestamp}] ${message}</arg>
<doc>Catenates the given items together and returns the resulted string.</doc>
<status status="PASS" start="2025-05-08T17:30:16.453266" elapsed="0.000264"/>
</kw>
<kw name="Append To File" owner="OperatingSystem">
<msg time="2025-05-08T17:30:16.454072" level="INFO" html="true">Appended to file '&lt;a href="file:///Users/zzy/hope/rpa/wechat_applescript_log.txt"&gt;/Users/zzy/hope/rpa/wechat_applescript_log.txt&lt;/a&gt;'.</msg>
<arg>${LOG_FILE}</arg>
<arg>${log_entry}\n</arg>
<doc>Appends the given content to the specified file.</doc>
<status status="PASS" start="2025-05-08T17:30:16.453653" elapsed="0.000495"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>${log_entry}</arg>
<doc>Logs the given message to the console.</doc>
<status status="PASS" start="2025-05-08T17:30:16.454274" elapsed="0.000258"/>
</kw>
<arg>步骤4: 聊天窗口已加载，准备输入消息</arg>
<status status="PASS" start="2025-05-08T17:30:16.452532" elapsed="0.002091"/>
</kw>
<kw name="记录日志">
<kw name="Get Current Date" owner="DateTime">
<msg time="2025-05-08T17:30:16.455418" level="INFO">${timestamp} = 2025-05-08 17:30:16</msg>
<var>${timestamp}</var>
<arg>result_format=%Y-%m-%d %H:%M:%S</arg>
<doc>Returns current local or UTC time with an optional increment.</doc>
<status status="PASS" start="2025-05-08T17:30:16.455148" elapsed="0.000313"/>
</kw>
<kw name="Catenate" owner="BuiltIn">
<msg time="2025-05-08T17:30:16.455816" level="INFO">${log_entry} = [2025-05-08 17:30:16] 检查是否可以使用cliclick工具</msg>
<var>${log_entry}</var>
<arg>SEPARATOR=\n</arg>
<arg>[${timestamp}] ${message}</arg>
<doc>Catenates the given items together and returns the resulted string.</doc>
<status status="PASS" start="2025-05-08T17:30:16.455584" elapsed="0.000269"/>
</kw>
<kw name="Append To File" owner="OperatingSystem">
<msg time="2025-05-08T17:30:16.456345" level="INFO" html="true">Appended to file '&lt;a href="file:///Users/zzy/hope/rpa/wechat_applescript_log.txt"&gt;/Users/zzy/hope/rpa/wechat_applescript_log.txt&lt;/a&gt;'.</msg>
<arg>${LOG_FILE}</arg>
<arg>${log_entry}\n</arg>
<doc>Appends the given content to the specified file.</doc>
<status status="PASS" start="2025-05-08T17:30:16.455971" elapsed="0.000450"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>${log_entry}</arg>
<doc>Logs the given message to the console.</doc>
<status status="PASS" start="2025-05-08T17:30:16.456554" elapsed="0.000187"/>
</kw>
<arg>检查是否可以使用cliclick工具</arg>
<status status="PASS" start="2025-05-08T17:30:16.454856" elapsed="0.001965"/>
</kw>
<kw name="Run Process" owner="Process">
<msg time="2025-05-08T17:30:16.457147" level="INFO">Starting process:
which cliclick</msg>
<msg time="2025-05-08T17:30:16.462592" level="INFO">Waiting for process to complete.</msg>
<msg time="2025-05-08T17:30:16.471899" level="INFO">Process completed.</msg>
<msg time="2025-05-08T17:30:16.472273" level="INFO">${cliclick_check} = &lt;result object with rc 0&gt;</msg>
<var>${cliclick_check}</var>
<arg>which cliclick</arg>
<arg>shell=true</arg>
<doc>Runs a process and waits for it to complete.</doc>
<status status="PASS" start="2025-05-08T17:30:16.456946" elapsed="0.015376"/>
</kw>
<kw name="Run Keyword And Return Status" owner="BuiltIn">
<kw name="Should Not Be Empty" owner="BuiltIn">
<msg time="2025-05-08T17:30:16.473869" level="INFO">Length is 23.</msg>
<arg>${cliclick_check.stdout}</arg>
<doc>Verifies that the given item is not empty.</doc>
<status status="PASS" start="2025-05-08T17:30:16.473151" elapsed="0.000784"/>
</kw>
<msg time="2025-05-08T17:30:16.474036" level="INFO">${has_cliclick} = True</msg>
<var>${has_cliclick}</var>
<arg>Should Not Be Empty</arg>
<arg>${cliclick_check.stdout}</arg>
<doc>Runs the given keyword with given arguments and returns the status as a Boolean value.</doc>
<status status="PASS" start="2025-05-08T17:30:16.472795" elapsed="0.001272"/>
</kw>
<kw name="Set Variable" owner="BuiltIn">
<msg time="2025-05-08T17:30:16.474396" level="INFO">${send_success} = False</msg>
<var>${send_success}</var>
<arg>${False}</arg>
<doc>Returns the given values which can then be assigned to a variables.</doc>
<status status="PASS" start="2025-05-08T17:30:16.474209" elapsed="0.000218"/>
</kw>
<if>
<branch type="IF" condition="${has_cliclick}">
<kw name="记录日志">
<kw name="Get Current Date" owner="DateTime">
<msg time="2025-05-08T17:30:16.475548" level="INFO">${timestamp} = 2025-05-08 17:30:16</msg>
<var>${timestamp}</var>
<arg>result_format=%Y-%m-%d %H:%M:%S</arg>
<doc>Returns current local or UTC time with an optional increment.</doc>
<status status="PASS" start="2025-05-08T17:30:16.475260" elapsed="0.000420"/>
</kw>
<kw name="Catenate" owner="BuiltIn">
<msg time="2025-05-08T17:30:16.476191" level="INFO">${log_entry} = [2025-05-08 17:30:16] 找到cliclick工具，使用增强型cliclick专用脚本发送消息 (使用多种获取焦点方法)</msg>
<var>${log_entry}</var>
<arg>SEPARATOR=\n</arg>
<arg>[${timestamp}] ${message}</arg>
<doc>Catenates the given items together and returns the resulted string.</doc>
<status status="PASS" start="2025-05-08T17:30:16.475813" elapsed="0.000423"/>
</kw>
<kw name="Append To File" owner="OperatingSystem">
<msg time="2025-05-08T17:30:16.476891" level="INFO" html="true">Appended to file '&lt;a href="file:///Users/zzy/hope/rpa/wechat_applescript_log.txt"&gt;/Users/zzy/hope/rpa/wechat_applescript_log.txt&lt;/a&gt;'.</msg>
<arg>${LOG_FILE}</arg>
<arg>${log_entry}\n</arg>
<doc>Appends the given content to the specified file.</doc>
<status status="PASS" start="2025-05-08T17:30:16.476382" elapsed="0.000620"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>${log_entry}</arg>
<doc>Logs the given message to the console.</doc>
<status status="PASS" start="2025-05-08T17:30:16.477189" elapsed="0.000363"/>
</kw>
<arg>找到cliclick工具，使用增强型cliclick专用脚本发送消息 (使用多种获取焦点方法)</arg>
<status status="PASS" start="2025-05-08T17:30:16.474899" elapsed="0.002819"/>
</kw>
<kw name="记录日志">
<kw name="Get Current Date" owner="DateTime">
<msg time="2025-05-08T17:30:16.478483" level="INFO">${timestamp} = 2025-05-08 17:30:16</msg>
<var>${timestamp}</var>
<arg>result_format=%Y-%m-%d %H:%M:%S</arg>
<doc>Returns current local or UTC time with an optional increment.</doc>
<status status="PASS" start="2025-05-08T17:30:16.478241" elapsed="0.000278"/>
</kw>
<kw name="Catenate" owner="BuiltIn">
<msg time="2025-05-08T17:30:16.478875" level="INFO">${log_entry} = [2025-05-08 17:30:16] 执行增强型焦点获取脚本 (使用多种点击方法和位置，模拟更真实的用户行为)</msg>
<var>${log_entry}</var>
<arg>SEPARATOR=\n</arg>
<arg>[${timestamp}] ${message}</arg>
<doc>Catenates the given items together and returns the resulted string.</doc>
<status status="PASS" start="2025-05-08T17:30:16.478640" elapsed="0.000270"/>
</kw>
<kw name="Append To File" owner="OperatingSystem">
<msg time="2025-05-08T17:30:16.479410" level="INFO" html="true">Appended to file '&lt;a href="file:///Users/zzy/hope/rpa/wechat_applescript_log.txt"&gt;/Users/zzy/hope/rpa/wechat_applescript_log.txt&lt;/a&gt;'.</msg>
<arg>${LOG_FILE}</arg>
<arg>${log_entry}\n</arg>
<doc>Appends the given content to the specified file.</doc>
<status status="PASS" start="2025-05-08T17:30:16.479028" elapsed="0.000454"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>${log_entry}</arg>
<doc>Logs the given message to the console.</doc>
<status status="PASS" start="2025-05-08T17:30:16.479607" elapsed="0.000187"/>
</kw>
<arg>执行增强型焦点获取脚本 (使用多种点击方法和位置，模拟更真实的用户行为)</arg>
<status status="PASS" start="2025-05-08T17:30:16.477926" elapsed="0.001944"/>
</kw>
<kw name="Run Process" owner="Process">
<msg time="2025-05-08T17:30:16.480304" level="INFO">Starting process:
osascript /Users/zzy/hope/rpa/scripts/wechat/cliclick_focus_send.applescript 你好，这是测试消息245</msg>
<msg time="2025-05-08T17:30:16.486447" level="INFO">Waiting for process to complete.</msg>
<msg time="2025-05-08T17:30:28.743403" level="INFO">Process completed.</msg>
<msg time="2025-05-08T17:30:28.743782" level="INFO">${result3} = &lt;result object with rc 0&gt;</msg>
<var>${result3}</var>
<arg>osascript</arg>
<arg>${SCRIPTS_DIR}/cliclick_focus_send.applescript</arg>
<arg>${custom_message}</arg>
<arg>stderr=STDOUT</arg>
<doc>Runs a process and waits for it to complete.</doc>
<status status="PASS" start="2025-05-08T17:30:16.479996" elapsed="12.263835"/>
</kw>
<kw name="Run Keyword And Return Status" owner="BuiltIn">
<kw name="Should Be Empty" owner="BuiltIn">
<msg time="2025-05-08T17:30:28.745694" level="INFO">Length is 0.</msg>
<arg>${result3.stderr}</arg>
<doc>Verifies that the given item is empty.</doc>
<status status="PASS" start="2025-05-08T17:30:28.744869" elapsed="0.000905"/>
</kw>
<msg time="2025-05-08T17:30:28.745884" level="INFO">${send_success} = True</msg>
<var>${send_success}</var>
<arg>Should Be Empty</arg>
<arg>${result3.stderr}</arg>
<doc>Runs the given keyword with given arguments and returns the status as a Boolean value.</doc>
<status status="PASS" start="2025-05-08T17:30:28.744396" elapsed="0.001519"/>
</kw>
<kw name="记录日志">
<kw name="Get Current Date" owner="DateTime">
<msg time="2025-05-08T17:30:28.752718" level="INFO">${timestamp} = 2025-05-08 17:30:28</msg>
<var>${timestamp}</var>
<arg>result_format=%Y-%m-%d %H:%M:%S</arg>
<doc>Returns current local or UTC time with an optional increment.</doc>
<status status="PASS" start="2025-05-08T17:30:28.752385" elapsed="0.000385"/>
</kw>
<kw name="Catenate" owner="BuiltIn">
<msg time="2025-05-08T17:30:28.753260" level="INFO">${log_entry} = [2025-05-08 17:30:28] cliclick专用脚本执行结果: </msg>
<var>${log_entry}</var>
<arg>SEPARATOR=\n</arg>
<arg>[${timestamp}] ${message}</arg>
<doc>Catenates the given items together and returns the resulted string.</doc>
<status status="PASS" start="2025-05-08T17:30:28.752925" elapsed="0.000381"/>
</kw>
<kw name="Append To File" owner="OperatingSystem">
<msg time="2025-05-08T17:30:28.753949" level="INFO" html="true">Appended to file '&lt;a href="file:///Users/zzy/hope/rpa/wechat_applescript_log.txt"&gt;/Users/zzy/hope/rpa/wechat_applescript_log.txt&lt;/a&gt;'.</msg>
<arg>${LOG_FILE}</arg>
<arg>${log_entry}\n</arg>
<doc>Appends the given content to the specified file.</doc>
<status status="PASS" start="2025-05-08T17:30:28.753435" elapsed="0.000629"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>${log_entry}</arg>
<doc>Logs the given message to the console.</doc>
<status status="PASS" start="2025-05-08T17:30:28.754213" elapsed="0.000242"/>
</kw>
<arg>cliclick专用脚本执行结果: ${result3.stdout}</arg>
<status status="PASS" start="2025-05-08T17:30:28.746216" elapsed="0.008331"/>
</kw>
<if>
<branch type="IF" condition="${send_success}">
<kw name="记录日志">
<kw name="Get Current Date" owner="DateTime">
<msg time="2025-05-08T17:30:28.755460" level="INFO">${timestamp} = 2025-05-08 17:30:28</msg>
<var>${timestamp}</var>
<arg>result_format=%Y-%m-%d %H:%M:%S</arg>
<doc>Returns current local or UTC time with an optional increment.</doc>
<status status="PASS" start="2025-05-08T17:30:28.755227" elapsed="0.000267"/>
</kw>
<kw name="Catenate" owner="BuiltIn">
<msg time="2025-05-08T17:30:28.755842" level="INFO">${log_entry} = [2025-05-08 17:30:28] 使用增强型cliclick获取焦点机制后通过AppleScript完成消息发送</msg>
<var>${log_entry}</var>
<arg>SEPARATOR=\n</arg>
<arg>[${timestamp}] ${message}</arg>
<doc>Catenates the given items together and returns the resulted string.</doc>
<status status="PASS" start="2025-05-08T17:30:28.755613" elapsed="0.000263"/>
</kw>
<kw name="Append To File" owner="OperatingSystem">
<msg time="2025-05-08T17:30:28.756388" level="INFO" html="true">Appended to file '&lt;a href="file:///Users/zzy/hope/rpa/wechat_applescript_log.txt"&gt;/Users/zzy/hope/rpa/wechat_applescript_log.txt&lt;/a&gt;'.</msg>
<arg>${LOG_FILE}</arg>
<arg>${log_entry}\n</arg>
<doc>Appends the given content to the specified file.</doc>
<status status="PASS" start="2025-05-08T17:30:28.755993" elapsed="0.000466"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>${log_entry}</arg>
<doc>Logs the given message to the console.</doc>
<status status="PASS" start="2025-05-08T17:30:28.756582" elapsed="0.000190"/>
</kw>
<arg>使用增强型cliclick获取焦点机制后通过AppleScript完成消息发送</arg>
<status status="PASS" start="2025-05-08T17:30:28.754935" elapsed="0.001910"/>
</kw>
<return>
<value>${True}</value>
<status status="PASS" start="2025-05-08T17:30:28.756914" elapsed="0.000106"/>
</return>
<status status="PASS" start="2025-05-08T17:30:28.754690" elapsed="0.002466"/>
</branch>
<branch type="ELSE">
<kw name="记录日志">
<arg>警告: 增强型cliclick脚本执行出现错误: ${result3.stderr}</arg>
<status status="NOT RUN" start="2025-05-08T17:30:28.757407" elapsed="0.000033"/>
</kw>
<kw name="记录日志">
<arg>尝试使用纯AppleScript方案作为备选</arg>
<status status="NOT RUN" start="2025-05-08T17:30:28.757581" elapsed="0.000028"/>
</kw>
<status status="NOT RUN" start="2025-05-08T17:30:28.757202" elapsed="0.000445"/>
</branch>
<status status="PASS" start="2025-05-08T17:30:28.754638" elapsed="0.003041"/>
</if>
<status status="PASS" start="2025-05-08T17:30:16.474584" elapsed="12.283147"/>
</branch>
<branch type="ELSE">
<kw name="记录日志">
<arg>未找到cliclick工具，使用纯AppleScript方案</arg>
<status status="NOT RUN" start="2025-05-08T17:30:28.757899" elapsed="0.000027"/>
</kw>
<status status="NOT RUN" start="2025-05-08T17:30:28.757765" elapsed="0.000207"/>
</branch>
<status status="PASS" start="2025-05-08T17:30:16.474532" elapsed="12.283469"/>
</if>
<kw name="记录日志">
<arg>尝试使用纯AppleScript方案发送消息</arg>
<status status="NOT RUN" start="2025-05-08T17:30:28.758135" elapsed="0.000027"/>
</kw>
<kw name="Run Process" owner="Process">
<var>${result4}</var>
<arg>osascript</arg>
<arg>${SCRIPTS_DIR}/send_message.applescript</arg>
<arg>${custom_message}</arg>
<arg>stderr=STDOUT</arg>
<doc>Runs a process and waits for it to complete.</doc>
<status status="NOT RUN" start="2025-05-08T17:30:28.758288" elapsed="0.000025"/>
</kw>
<kw name="Run Keyword And Return Status" owner="BuiltIn">
<var>${send_success}</var>
<arg>Should Be Empty</arg>
<arg>${result4.stderr}</arg>
<doc>Runs the given keyword with given arguments and returns the status as a Boolean value.</doc>
<status status="NOT RUN" start="2025-05-08T17:30:28.758437" elapsed="0.000027"/>
</kw>
<if>
<branch type="IF" condition="${send_success}">
<kw name="记录日志">
<arg>纯AppleScript消息发送脚本执行结果: ${result4.stdout}</arg>
<status status="NOT RUN" start="2025-05-08T17:30:28.758730" elapsed="0.000029"/>
</kw>
<kw name="记录日志">
<arg>消息发送完成</arg>
<status status="NOT RUN" start="2025-05-08T17:30:28.758897" elapsed="0.000029"/>
</kw>
<return>
<value>${True}</value>
<status status="NOT RUN" start="2025-05-08T17:30:28.758992" elapsed="0.000023"/>
</return>
<status status="NOT RUN" start="2025-05-08T17:30:28.758582" elapsed="0.000485"/>
</branch>
<branch type="ELSE">
<kw name="记录日志">
<arg>错误: 所有消息发送方法都失败: ${result4.stderr}</arg>
<status status="NOT RUN" start="2025-05-08T17:30:28.759230" elapsed="0.000026"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>\n错误: 无法发送消息，请检查微信窗口状态\n</arg>
<doc>Logs the given message to the console.</doc>
<status status="NOT RUN" start="2025-05-08T17:30:28.759372" elapsed="0.000026"/>
</kw>
<kw name="记录日志">
<arg>提示: 如果消息能发送但内容不显示，可能是焦点问题，尝试以下解决方法:</arg>
<status status="NOT RUN" start="2025-05-08T17:30:28.759528" elapsed="0.000026"/>
</kw>
<kw name="记录日志">
<arg>1. 确保微信窗口处于前台活动状态</arg>
<status status="NOT RUN" start="2025-05-08T17:30:28.759676" elapsed="0.000026"/>
</kw>
<kw name="记录日志">
<arg>2. 检查屏幕分辨率与脚本中的点击坐标匹配</arg>
<status status="NOT RUN" start="2025-05-08T17:30:28.759822" elapsed="0.000026"/>
</kw>
<kw name="记录日志">
<arg>3. 尝试使用较慢的执行速度 (使用 --variable SLOW:True 参数运行)</arg>
<status status="NOT RUN" start="2025-05-08T17:30:28.759965" elapsed="0.000025"/>
</kw>
<kw name="记录日志">
<arg>4. 手动编辑cliclick_focus_send.applescript，调整点击坐标</arg>
<status status="NOT RUN" start="2025-05-08T17:30:28.760107" elapsed="0.000025"/>
</kw>
<return>
<value>${False}</value>
<status status="NOT RUN" start="2025-05-08T17:30:28.760183" elapsed="0.000022"/>
</return>
<status status="NOT RUN" start="2025-05-08T17:30:28.759100" elapsed="0.001139"/>
</branch>
<status status="NOT RUN" start="2025-05-08T17:30:28.758558" elapsed="0.001707"/>
</if>
<arg>${CONTACT}</arg>
<arg>${MESSAGE}</arg>
<status status="PASS" start="2025-05-08T17:30:06.584271" elapsed="22.176146"/>
</kw>
<arg>${scripts_ok}</arg>
<arg>执行基于AppleScript的微信自动化</arg>
<arg>${CONTACT}</arg>
<arg>${MESSAGE}</arg>
<arg>ELSE</arg>
<arg>Log To Console</arg>
<arg>\n无法执行自动化：预创建的脚本文件缺失或无执行权限\n</arg>
<doc>Runs the given keyword with the given arguments, if ``condition`` is true.</doc>
<status status="PASS" start="2025-05-08T17:30:06.583510" elapsed="22.176979"/>
</kw>
<kw name="记录完成信息">
<kw name="Get Current Date" owner="DateTime">
<msg time="2025-05-08T17:30:28.761532" level="INFO">${timestamp} = 2025-05-08 17:30:28</msg>
<var>${timestamp}</var>
<arg>result_format=%Y-%m-%d %H:%M:%S</arg>
<doc>Returns current local or UTC time with an optional increment.</doc>
<status status="PASS" start="2025-05-08T17:30:28.761280" elapsed="0.000290"/>
</kw>
<kw name="记录日志">
<kw name="Get Current Date" owner="DateTime">
<msg time="2025-05-08T17:30:28.762409" level="INFO">${timestamp} = 2025-05-08 17:30:28</msg>
<var>${timestamp}</var>
<arg>result_format=%Y-%m-%d %H:%M:%S</arg>
<doc>Returns current local or UTC time with an optional increment.</doc>
<status status="PASS" start="2025-05-08T17:30:28.762067" elapsed="0.000398"/>
</kw>
<kw name="Catenate" owner="BuiltIn">
<msg time="2025-05-08T17:30:28.762931" level="INFO">${log_entry} = [2025-05-08 17:30:28] 自动化流程完成。结束时间: 2025-05-08 17:30:28</msg>
<var>${log_entry}</var>
<arg>SEPARATOR=\n</arg>
<arg>[${timestamp}] ${message}</arg>
<doc>Catenates the given items together and returns the resulted string.</doc>
<status status="PASS" start="2025-05-08T17:30:28.762671" elapsed="0.000298"/>
</kw>
<kw name="Append To File" owner="OperatingSystem">
<msg time="2025-05-08T17:30:28.763780" level="INFO" html="true">Appended to file '&lt;a href="file:///Users/zzy/hope/rpa/wechat_applescript_log.txt"&gt;/Users/zzy/hope/rpa/wechat_applescript_log.txt&lt;/a&gt;'.</msg>
<arg>${LOG_FILE}</arg>
<arg>${log_entry}\n</arg>
<doc>Appends the given content to the specified file.</doc>
<status status="PASS" start="2025-05-08T17:30:28.763096" elapsed="0.000785"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>${log_entry}</arg>
<doc>Logs the given message to the console.</doc>
<status status="PASS" start="2025-05-08T17:30:28.764122" elapsed="0.000321"/>
</kw>
<arg>自动化流程完成。结束时间: ${timestamp}</arg>
<status status="PASS" start="2025-05-08T17:30:28.761738" elapsed="0.002833"/>
</kw>
<kw name="记录日志">
<kw name="Get Current Date" owner="DateTime">
<msg time="2025-05-08T17:30:28.765505" level="INFO">${timestamp} = 2025-05-08 17:30:28</msg>
<var>${timestamp}</var>
<arg>result_format=%Y-%m-%d %H:%M:%S</arg>
<doc>Returns current local or UTC time with an optional increment.</doc>
<status status="PASS" start="2025-05-08T17:30:28.765245" elapsed="0.000299"/>
</kw>
<kw name="Catenate" owner="BuiltIn">
<msg time="2025-05-08T17:30:28.766066" level="INFO">${log_entry} = [2025-05-08 17:30:28] --------------------------------------------------</msg>
<var>${log_entry}</var>
<arg>SEPARATOR=\n</arg>
<arg>[${timestamp}] ${message}</arg>
<doc>Catenates the given items together and returns the resulted string.</doc>
<status status="PASS" start="2025-05-08T17:30:28.765674" elapsed="0.000658"/>
</kw>
<kw name="Append To File" owner="OperatingSystem">
<msg time="2025-05-08T17:30:28.767293" level="INFO" html="true">Appended to file '&lt;a href="file:///Users/zzy/hope/rpa/wechat_applescript_log.txt"&gt;/Users/zzy/hope/rpa/wechat_applescript_log.txt&lt;/a&gt;'.</msg>
<arg>${LOG_FILE}</arg>
<arg>${log_entry}\n</arg>
<doc>Appends the given content to the specified file.</doc>
<status status="PASS" start="2025-05-08T17:30:28.766582" elapsed="0.000877"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>${log_entry}</arg>
<doc>Logs the given message to the console.</doc>
<status status="PASS" start="2025-05-08T17:30:28.767759" elapsed="0.000369"/>
</kw>
<arg>--------------------------------------------------</arg>
<status status="PASS" start="2025-05-08T17:30:28.764808" elapsed="0.003637"/>
</kw>
<kw name="Normalize Path" owner="OperatingSystem">
<msg time="2025-05-08T17:30:28.768912" level="INFO">${log_path} = /Users/zzy/hope/rpa/wechat_applescript_log.txt</msg>
<var>${log_path}</var>
<arg>${LOG_FILE}</arg>
<doc>Normalizes the given path.</doc>
<status status="PASS" start="2025-05-08T17:30:28.768626" elapsed="0.000335"/>
</kw>
<kw name="Log" owner="BuiltIn">
<msg time="2025-05-08T17:30:28.769286" level="INFO">日志文件已保存至: /Users/zzy/hope/rpa/wechat_applescript_log.txt</msg>
<arg>日志文件已保存至: ${log_path}</arg>
<doc>Logs the given message with the given level.</doc>
<status status="PASS" start="2025-05-08T17:30:28.769110" elapsed="0.000237"/>
</kw>
<kw name="Log To Console" owner="BuiltIn">
<arg>\n日志文件已保存至: ${log_path}</arg>
<doc>Logs the given message to the console.</doc>
<status status="PASS" start="2025-05-08T17:30:28.769557" elapsed="0.000269"/>
</kw>
<status status="PASS" start="2025-05-08T17:30:28.760861" elapsed="0.009061"/>
</kw>
<status status="PASS" start="2025-05-08T17:30:06.488081" elapsed="22.282030"/>
</test>
<doc>微信完整自动化流程 (AppleScript版本)
自动搜索联系人并发送消息</doc>
<status status="PASS" start="2025-05-08T17:30:06.430975" elapsed="22.339812"/>
</suite>
<statistics>
<total>
<stat pass="1" fail="0" skip="0">All Tasks</stat>
</total>
<tag>
</tag>
<suite>
<stat name="Wechat Applescript Workflow" id="s1" pass="1" fail="0" skip="0">Wechat Applescript Workflow</stat>
</suite>
</statistics>
<errors>
</errors>
</robot>
