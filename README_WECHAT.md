# 微信自动发送消息工具

这个工具可以帮助您自动化向微信发送消息的流程。您可以指定联系人和消息内容，脚本会自动搜索联系人并发送消息。

## 功能特点

- 自动激活微信窗口
- 自动搜索并选择联系人
- 自动定位到输入框
- 输入自定义文本内容（支持中文、emoji和特殊字符）
- 自动发送消息
- 详细的日志记录
- 支持通过命令行参数自定义联系人和消息内容
- 使用剪贴板方法解决输入法问题

## 使用方法

有三种方式可以使用这个工具：

### 方法1：使用Shell脚本（推荐）

```bash
# 使用默认联系人和消息
./send_wechat_message.sh

# 指定联系人，使用默认消息
./send_wechat_message.sh "张三"

# 指定联系人和消息内容
./send_wechat_message.sh "张三" "你好，这是自动发送的消息"

# 使用默认联系人，自定义消息内容
./send_wechat_message.sh "" "只想发送这条消息"

# 查看帮助
./send_wechat_message.sh --help
```

### 方法2：使用Python脚本

```bash
# 使用默认联系人和消息
python send_wechat.py

# 指定联系人，使用默认消息
python send_wechat.py "张三"

# 指定联系人和消息内容
python send_wechat.py "张三" "你好，这是自动发送的消息"

# 使用标志形式指定参数
python send_wechat.py -c "张三" -m "使用标志指定参数"

# 查看帮助
python send_wechat.py --help
```

### 方法3：直接使用Robot Framework命令

```bash
# 使用默认联系人和消息
python -m robot wechat_applescript_workflow.robot

# 指定联系人和消息内容
python -m robot --variable CONTACT:"张三" --variable MESSAGE:"你好，这是测试消息" wechat_applescript_workflow.robot
```

## 工作原理

本工具的工作流程：

1. **激活微信窗口**：自动将微信窗口置于前台
2. **搜索联系人**：使用Command+F快捷键打开微信的搜索功能
3. **输入联系人名称**：通过剪贴板将联系人名称粘贴到搜索框
4. **选择联系人**：按回车键选择搜索到的第一个联系人
5. **输入消息**：通过剪贴板方法将消息内容粘贴到输入框
6. **发送消息**：按回车键发送消息

整个过程使用剪贴板方法避开输入法问题，确保中文和特殊字符都能正确输入。

## 注意事项

1. 使用前请确保微信已经打开
2. 联系人名称需要与微信中的名称完全匹配
3. 如果有多个同名联系人，会选择搜索结果中的第一个
4. 脚本运行时，请勿移动鼠标或使用键盘，以免干扰自动化流程
5. 运行过程会在几秒钟内自动完成
6. 执行结果和详细日志将保存在 `wechat_applescript_log.txt` 文件中

## 常见问题

- **问题**：如果消息中包含引号怎么办？
  **解答**：使用转义符，例如：`./send_wechat_message.sh "张三" "他说\"你好\""` 或用单引号包裹参数

- **问题**：是否支持发送表情符号？
  **解答**：支持，可以直接在消息中包含表情符号，例如：`./send_wechat_message.sh "张三" "👋 你好"`

- **问题**：如何发送多行消息？
  **解答**：可以在消息中使用 `\n` 来表示换行，例如：`./send_wechat_message.sh "张三" "第一行\n第二行"`

- **问题**：联系人名称包含特殊字符怎么办？
  **解答**：只要在命令行中正确引用（使用引号包裹），脚本可以处理包含特殊字符的联系人名称

- **问题**：找不到指定的联系人怎么办？
  **解答**：检查联系人名称是否与微信中显示的完全一致，包括空格和特殊字符

## 排查问题

如果消息没有正确发送，请检查：

1. 查看 `wechat_applescript_log.txt` 日志文件了解详细执行情况
2. 确认微信窗口是否处于激活状态
3. 确认联系人名称是否正确（与微信中显示的完全一致）
4. 检查 AppleScript 权限设置（系统偏好设置 > 安全性与隐私 > 隐私 > 辅助功能）
5. 可能需要授予Terminal（终端）或您使用的IDE对剪贴板的访问权限 